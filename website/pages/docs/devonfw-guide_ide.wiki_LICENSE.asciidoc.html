<!DOCTYPE html><html lang="en"><head><style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote::before{display:none}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{word-spacing:0;line-height:1.6}
.quoteblock.abstract blockquote::before,.quoteblock.abstract p::before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style><style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
<meta http-equiv="Content-Type" content="text/html; charset=">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Updated at 2022-03-30 01:25:05 UTC">

<!-- ******** SOCIAL MEDIA META ********** -->

<meta name="title" property="og:title" content="devonfw website">
<meta property="og:type" content="website">
<meta name="image" property="og:image" content="https://devonfw.com/images/devonfwwebsite.png">
<meta name="description" property="og:description" content="devonfw is the standard open source software development platform; Serving the full Software Delivery Life Cycle.">
<meta property="og:url" content="https://devonfw.com/index.html">

<meta name="twitter:title" content="devonfw website">
<meta name="twitter:description" content="devonfw is the standard open source software development platform; Serving the full Software Delivery Life Cycle.">
<meta name="twitter:image" content="https://devonfw.com/images/devonfwwebsite.png">
<meta name="twitter:card" content="summary_large_image">

<!-- ************************************* -->


<title>devonfw guide</title>
<!-- devonfw website stylesheet -->
<link rel="stylesheet" type="text/css" href="/devonfw.css">
<!-- Lunr -->
<script src="/website/assets/scripts/lunr.min.js"></script>
<!-- JQuery -->
<script src="/website/assets/scripts/jquery.min.js"></script>
<link rel="stylesheet" href="/website/assets/styles/font-awesome.min.css">
<link rel="stylesheet" href="/website/assets/styles/googlecode.min.css">
<script src="/website/assets/scripts/highlight.min.js"></script>
<script src="/website/assets/scripts/common.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
<link rel="stylesheet" href="/website/assets/styles/bootstrap.min.css">

<script src="/website/assets/scripts/anchor.min.js"></script>

<script src="/website/components/header/search-engine/bundle.js"></script>

<script src="/website/shared/rightmenu.js"></script>

<!-- ************** Google analytics ************ -->
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

gtag('consent', 'default', {
  'analytics_storage': 'denied'
});
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-151636804-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151636804-1');
</script>
<script>
  function consentGranted() {
    gtag('consent', 'update', {
      'analytics_storage': 'granted'
    });
  }
</script>

<!-- ******************************************** -->


</head>
<body id="devonfw-guide_master.asciidoc" class="book toc2 toc-left">
<div id="website-navbar" class="website-navbar">
<button id="menu-button" class="menu-button">
  <img src="/images/menu-button.svg" width="32px" height="32px" alt="">
</button>

<ul>
<li>
<p><span class="image"><a class="image" href="/website/pages/welcome/welcome.html"><img alt="logo" src="/images/Logo_devonfw.svg"></a></span></p>
</li>
<li>
<p><a href="https://www.katacoda.com/devonfw">Tutorials</a></p>
</li>
<li>
<p><a href="/website/pages/solutions/index.html">Solutions</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master.html" class="active">Docs</a></p>
</li>
</ul>

<form class="form-inline">
  <div class="search-bar">
    <input id="search-field" type="search" class="form-control mr-sm-2" placeholder="Search by keyword(s)..." aria-label="Search" style="height: auto;" autocomplete="off">
    <div class="sb-res-pos px-4">
      <div id="click-outside" class="click-outside z-50 hidden"></div>
      <div class="col rounded px-0 border z-100 bg-white hidden search-bar-results" id="search-results-box">
      </div>
    </div>
  </div>
</form>
<a class="navbar-github text-white" href="https://github.com/devonfw/">
  <img src="/images/github-mark.png" width="auto" height="auto" alt="">
</a></div>
<div id="sidebar" class="wiki-sidebar"></div>

<div id="header">
<h1>devonfw guide</h1>
<div class="details">
<span id="author" class="author">Updated at 2022-03-30 01:32:07 UTC</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root"><a href="master.html">devonfw guide</a></span></p><ul class="sectlevel0">
<li><a href="devonfw-guide_getting-started.wiki_getting-started.asciidoc.html">Getting Started</a>
</li>
<li><a href="devonfw-guide_ide.wiki_devonfw-ide.asciidoc.html">devonfw-ide</a>
<ul class="sectlevel1">
<li><a href="devonfw-guide_ide.wiki_devonfw-ide-introduction.asciidoc.html">Introduction</a>
</li>
<li><a href="devonfw-guide_ide.wiki_devonfw-ide-usage.asciidoc.html">Usage</a>
</li>
<li><a href="devonfw-guide_ide.wiki_devonfw-ide-advanced.asciidoc.html">Advanced Features</a>
</li>
<li><a href="devonfw-guide_ide.wiki_devonfw-ide-support.asciidoc.html">Support</a>
<ul class="sectlevel2">
<li><a href="devonfw-guide_ide.wiki_migration-from-devonfw-3.0.0-or-lower.asciidoc.html">Migration from oasp4j-ide</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html"><span class="toc-current">License</span></a>
<ul class="sectlevel3">
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_ide.wiki_license.asciidoc_apache-software-license---version-2.0">Apache Software License - Version 2.0</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_ide.wiki_license.asciidoc_eclipse-public-license---version-1.0">Eclipse Public License - Version 1.0</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_ide.wiki_license.asciidoc_eclipse-public-license---version-2.0">Eclipse Public License - Version 2.0</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_ide.wiki_license.asciidoc_mit-license">MIT License</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_ide.wiki_license.asciidoc_artistic-license---version-2.0">Artistic License - Version 2.0</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_ide.wiki_license.asciidoc_creative-commons-license---attribution-noderivatives-4.0-international">Creative Commons License - Attribution-NoDerivatives 4.0 International</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_ide.wiki_license.asciidoc_gnu-lesser-general-public-license---version-2.1">GNU LESSER GENERAL PUBLIC LICENSE - Version 2.1</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_ide.wiki_license.asciidoc_gnu-lesser-general-public-license---version-3">GNU LESSER GENERAL PUBLIC LICENSE - Version 3</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_ide.wiki_license.asciidoc_gnu-general-public-license---version-2">GNU GENERAL PUBLIC LICENSE - Version 2</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_ide.wiki_license.asciidoc_classpath-exception-to-the-gpl">"CLASSPATH" EXCEPTION TO THE GPL</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_ide.wiki_license.asciidoc_do-what-the-fuck-you-want-to-public-license---version-2">DO WHAT THE FUCK YOU WANT TO PUBLIC LICENSE - Version 2</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_ide.wiki_license.asciidoc_license-of-node.js">License of Node.js</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_ide.wiki_license.asciidoc_microsoft-software-license-terms">MICROSOFT SOFTWARE LICENSE TERMS</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_ide.wiki_license.asciidoc_mozilla-public-license-2.0">Mozilla Public License 2.0</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-configuration-mapping.asciidoc_naming-conventions-for-configuration-properties">Naming conventions for configuration properties</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-configuration-mapping.asciidoc_mapping-advanced-configuration">Mapping advanced configuration</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-configuration-mapping.asciidoc_generate-configuration-metadata">Generate configuration metadata</a>
</li>
<li><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus.asciidoc">Quarkus</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="devonfw-guide_devon4ng.wiki_master-devon4ng.asciidoc.html">Angular</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc.html">.net</a>
</li>
<li><a href="devonfw-guide_devon4node.wiki_master-devon4node.asciidoc.html">NodeJS</a>
</li>
<li><a href="devonfw-guide_general_db_master-database.asciidoc.html">Choosing your Database</a>
</li>
<li><a href="devonfw-guide_general_master-contributing.asciidoc.html">Contributing</a>
</li>
<li><a href="devonfw-guide_general_master-release-notes.asciidoc.html">Release Notes</a>
</li>
</ul>
</div>
</div><div id="content">
<div class="sect2">
<h3 id="devonfw-guide_ide.wiki_LICENSE.asciidoc">License</h3>
<div class="paragraph">
<p>The product <code>devonfw-ide</code> is licensed under the following terms.</p>
</div>
<div class="paragraph">
<p>Binaries of this product have been made available to you by <a href="https://devonfw.com">devonfw</a> under the <a href="https://github.com/devonfw/ide/blob/master/LICENSE">Apache Public License 2.0</a>.</p>
</div>
<div class="paragraph">
<p>The documentation of this product is licensed under the terms of the <a href="http://creativecommons.org/licenses/by-nd/4.0/">Creative Commons License (Attribution-No Derivatives 4.0 International)</a>.</p>
</div>
<div class="paragraph">
<p>All of the source code to this product is available under licenses which are both free and open source.</p>
</div>
<div class="paragraph">
<p>More specifically, most of the source code is available under the Apache Public License 2.0. The remainder of the software which is not under the Apache license is available under one of a variety of other free and open source licenses. Those that require reproduction of the license text in the distribution are given below. (Note: your copy of this product may not contain code covered by one or more of the licenses listed here, depending on the exact product and version you choose.)</p>
</div>
<div class="paragraph">
<p>The following table shows the components that may be used. The column <code>inclusion</code> indicates the way the component is included:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>directly included</code> means the component is directly contained in the download package of <code>devonfw-ide</code> we provide</p>
</li>
<li>
<p><code>default setup</code> means the component is not initially included but will be downloaded during the <a href="devonfw-guide_ide.wiki_setup.asciidoc.html"><code>setup</code></a> by default</p>
</li>
<li>
<p><code>optional</code> means the component is neither initially included nor downloaded by default, but only gets downloaded and installed if explicitly triggered by you when invoking additional commands or if explicitly configured by your project.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 27. Third party components</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Component</strong></th>
<th class="tableblock halign-left valign-top"><strong>Inclusion</strong></th>
<th class="tableblock halign-left valign-top"><strong>License</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/ide">devonfw-ide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directly included</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/ide/blob/master/LICENSE">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/eclipse-ee4j/jsonp">JSON-P</a> API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directly included</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/eclipse-ee4j/jsonp/blob/master/LICENSE.md">EPL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/eclipse-ee4j/jsonp">JSON-P</a> Implementation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directly included</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/eclipse-ee4j/jsonp/blob/master/LICENSE.md">EPL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://openjdk.java.net/">OpenJDK</a> / <a href="https://adoptopenjdk.net/">AdoptOpenJDK</a> (Java)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Setup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://openjdk.java.net/legal/gplv2+ce.html">GPLv2</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://maven.apache.org/">Maven</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Setup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://code.visualstudio.com/">VS Code</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/Microsoft/vscode/blob/master/LICENSE.txt">MIT</a> (<a href="https://code.visualstudio.com/License/">Terms</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/extension-pack-vscode">extension-pack-vscode</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/extension-pack-vscode/blob/master/LICENSE">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.eclipse.org/">Eclipse</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.eclipse.org/legal/epl-2.0/">EPL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/cobigen">CobiGen</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/cobigen/blob/master/LICENSE.txt">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://marketplace.eclipse.org/content/tm-terminal">TM Terminal</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.eclipse.org/legal/epl-2.0/">EPL 2.0</a> (see <a href="https://marketplace.eclipse.org/content/tm-terminal">here</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/iloveeclipse/anyedittools/">AnyEdit</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/iloveeclipse/anyedittools/blob/master/LICENSE.md">EPL 1.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://checkstyle.org/eclipse-cs/">EclipseCS</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/checkstyle/eclipse-cs/blob/master/LICENSE">LGPL 2.1</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://marketplace.eclipse.org/content/spotbugs-eclipse-plugin">SpotBugs Eclipse plugin</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spotbugs/spotbugs/blob/master/LICENSE">LGPL 2.1</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.eclemma.org/">EclEmma</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.eclemma.org/license.html">EPL 1.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://basti1302.github.io/startexplorer/">StartExplorer</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.wtfpl.net/txt/copying/">WTFPL 2</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://myregexp.com/eclipsePlugin.html">regex tester</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.gnu.org/licenses/gpl-2.0.html">GPL 2.0</a> (see <a href="https://sourceforge.net/projects/regex-util/">here</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/m-m-m/eclipse-templatevariables/">eclipse-templatevariables</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/m-m-m/eclipse-templatevariables/blob/master/LICENSE.txt">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://nodejs.org/">Node.js</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Setup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://raw.githubusercontent.com/nodejs/node/master/LICENSE">License</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.npmjs.com/">NPM</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Setup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/npm/cli/blob/latest/LICENSE">Artistic License 2.0</a> (<a href="https://www.npmjs.com/policies/terms">Terms</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cli.angular.io/">Angular CLI</a> (ng)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cli.angular.io/license.html">MIT</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://groovy-lang.org/">Groovy</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/apache/groovy/blob/master/LICENSE">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://ant.apache.org/">Apache Ant</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/apache/ant/blob/master/LICENSE">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://gradle.org/">Gradle</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/gradle/gradle/blob/master/LICENSE">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://jenkins.io/">Jenkins</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/jenkinsci/jenkins/blob/master/LICENSE.txt">MIT</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.sonarsource.com/plans-and-pricing/community/">SonarQube (Community Edition)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/SonarSource/sonarqube/blob/master/LICENSE.txt">LGPL 3.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.sonarlint.org/eclipse/">SonarLint</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/SonarSource/sonarlint-eclipse/blob/master/LICENSE.txt">LGPL 3+</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/cicdgen">cicdgen</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/cicdgen/blob/develop/LICENSE.txt">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/devon4j">devon4j</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/devon4j/blob/develop/LICENSE">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/devon4ng">devon4ng</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/devon4ng/blob/master/LICENSE.txt">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/devon4node">devon4node</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/devon4node/blob/develop/LICENSE.txt">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.jetbrains.com/opensource/idea/">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.jasypt.org/">jasypt</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.jasypt.org/license.html">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.docker.com/">docker</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.docker.com/engine/#licensing">ASL 2.0</a> and <a href="https://www.docker.com/legal/docker-software-end-user-license-agreement">EULA</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://kubernetes.io/">kubernetes</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/kubernetes/kubernetes/blob/master/LICENSE">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://helm.sh/">helm</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/devonfw/ide/blob/master/LICENSE">ASL 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://terraform.io/">terraform</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/hashicorp/terraform/blob/main/LICENSE">Mozilla Public License 2.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.graalvm.org/">GraalVM</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/oracle/graal/blob/master/LICENSE">GPLv2</a> (with the “Classpath” Exception)</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="devonfw-guide_ide.wiki_license.asciidoc_apache-software-license---version-2.0">Apache Software License - Version 2.0</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>                                 Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

   1. Definitions.

      "License" shall mean the terms and conditions for use, reproduction,
      and distribution as defined by Sections 1 through 9 of this document.

      "Licensor" shall mean the copyright owner or entity authorized by
      the copyright owner that is granting the License.

      "Legal Entity" shall mean the union of the acting entity and all
      other entities that control, are controlled by, or are under common
      control with that entity. For the purposes of this definition,
      "control" means (i) the power, direct or indirect, to cause the
      direction or management of such entity, whether by contract or
      otherwise, or (ii) ownership of fifty percent (50%) or more of the
      outstanding shares, or (iii) beneficial ownership of such entity.

      "You" (or "Your") shall mean an individual or Legal Entity
      exercising permissions granted by this License.

      "Source" form shall mean the preferred form for making modifications,
      including but not limited to software source code, documentation
      source, and configuration files.

      "Object" form shall mean any form resulting from mechanical
      transformation or translation of a Source form, including but
      not limited to compiled object code, generated documentation,
      and conversions to other media types.

      "Work" shall mean the work of authorship, whether in Source or
      Object form, made available under the License, as indicated by a
      copyright notice that is included in or attached to the work
      (an example is provided in the Appendix below).

      "Derivative Works" shall mean any work, whether in Source or Object
      form, that is based on (or derived from) the Work and for which the
      editorial revisions, annotations, elaborations, or other modifications
      represent, as a whole, an original work of authorship. For the purposes
      of this License, Derivative Works shall not include works that remain
      separable from, or merely link (or bind by name) to the interfaces of,
      the Work and Derivative Works thereof.

      "Contribution" shall mean any work of authorship, including
      the original version of the Work and any modifications or additions
      to that Work or Derivative Works thereof, that is intentionally
      submitted to Licensor for inclusion in the Work by the copyright owner
      or by an individual or Legal Entity authorized to submit on behalf of
      the copyright owner. For the purposes of this definition, "submitted"
      means any form of electronic, verbal, or written communication sent
      to the Licensor or its representatives, including but not limited to
      communication on electronic mailing lists, source code control systems,
      and issue tracking systems that are managed by, or on behalf of, the
      Licensor for the purpose of discussing and improving the Work, but
      excluding communication that is conspicuously marked or otherwise
      designated in writing by the copyright owner as "Not a Contribution."

      "Contributor" shall mean Licensor and any individual or Legal Entity
      on behalf of whom a Contribution has been received by Licensor and
      subsequently incorporated within the Work.

   2. Grant of Copyright License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      copyright license to reproduce, prepare Derivative Works of,
      publicly display, publicly perform, sublicense, and distribute the
      Work and such Derivative Works in Source or Object form.

   3. Grant of Patent License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      (except as stated in this section) patent license to make, have made,
      use, offer to sell, sell, import, and otherwise transfer the Work,
      where such license applies only to those patent claims licensable
      by such Contributor that are necessarily infringed by their
      Contribution(s) alone or by combination of their Contribution(s)
      with the Work to which such Contribution(s) was submitted. If You
      institute patent litigation against any entity (including a
      cross-claim or counterclaim in a lawsuit) alleging that the Work
      or a Contribution incorporated within the Work constitutes direct
      or contributory patent infringement, then any patent licenses
      granted to You under this License for that Work shall terminate
      as of the date such litigation is filed.

   4. Redistribution. You may reproduce and distribute copies of the
      Work or Derivative Works thereof in any medium, with or without
      modifications, and in Source or Object form, provided that You
      meet the following conditions:

      (a) You must give any other recipients of the Work or
          Derivative Works a copy of this License; and

      (b) You must cause any modified files to carry prominent notices
          stating that You changed the files; and

      (c) You must retain, in the Source form of any Derivative Works
          that You distribute, all copyright, patent, trademark, and
          attribution notices from the Source form of the Work,
          excluding those notices that do not pertain to any part of
          the Derivative Works; and

      (d) If the Work includes a "NOTICE" text file as part of its
          distribution, then any Derivative Works that You distribute must
          include a readable copy of the attribution notices contained
          within such NOTICE file, excluding those notices that do not
          pertain to any part of the Derivative Works, in at least one
          of the following places: within a NOTICE text file distributed
          as part of the Derivative Works; within the Source form or
          documentation, if provided along with the Derivative Works; or,
          within a display generated by the Derivative Works, if and
          wherever such third-party notices normally appear. The contents
          of the NOTICE file are for informational purposes only and
          do not modify the License. You may add Your own attribution
          notices within Derivative Works that You distribute, alongside
          or as an addendum to the NOTICE text from the Work, provided
          that such additional attribution notices cannot be construed
          as modifying the License.

      You may add Your own copyright statement to Your modifications and
      may provide additional or different license terms and conditions
      for use, reproduction, or distribution of Your modifications, or
      for any such Derivative Works as a whole, provided Your use,
      reproduction, and distribution of the Work otherwise complies with
      the conditions stated in this License.

   5. Submission of Contributions. Unless You explicitly state otherwise,
      any Contribution intentionally submitted for inclusion in the Work
      by You to the Licensor shall be under the terms and conditions of
      this License, without any additional terms or conditions.
      Notwithstanding the above, nothing herein shall supersede or modify
      the terms of any separate license agreement you may have executed
      with Licensor regarding such Contributions.

   6. Trademarks. This License does not grant permission to use the trade
      names, trademarks, service marks, or product names of the Licensor,
      except as required for reasonable and customary use in describing the
      origin of the Work and reproducing the content of the NOTICE file.

   7. Disclaimer of Warranty. Unless required by applicable law or
      agreed to in writing, Licensor provides the Work (and each
      Contributor provides its Contributions) on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
      implied, including, without limitation, any warranties or conditions
      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
      PARTICULAR PURPOSE. You are solely responsible for determining the
      appropriateness of using or redistributing the Work and assume any
      risks associated with Your exercise of permissions under this License.

   8. Limitation of Liability. In no event and under no legal theory,
      whether in tort (including negligence), contract, or otherwise,
      unless required by applicable law (such as deliberate and grossly
      negligent acts) or agreed to in writing, shall any Contributor be
      liable to You for damages, including any direct, indirect, special,
      incidental, or consequential damages of any character arising as a
      result of this License or out of the use or inability to use the
      Work (including but not limited to damages for loss of goodwill,
      work stoppage, computer failure or malfunction, or any and all
      other commercial damages or losses), even if such Contributor
      has been advised of the possibility of such damages.

   9. Accepting Warranty or Additional Liability. While redistributing
      the Work or Derivative Works thereof, You may choose to offer,
      and charge a fee for, acceptance of support, warranty, indemnity,
      or other liability obligations and/or rights consistent with this
      License. However, in accepting such obligations, You may act only
      on Your own behalf and on Your sole responsibility, not on behalf
      of any other Contributor, and only if You agree to indemnify,
      defend, and hold each Contributor harmless for any liability
      incurred by, or claims asserted against, such Contributor by reason
      of your accepting any such warranty or additional liability.

   END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

      To apply the Apache License to your work, attach the following
      boilerplate notice, with the fields enclosed by brackets "[]"
      replaced with your own identifying information. (Don't include
      the brackets!)  The text should be enclosed in the appropriate
      comment syntax for the file format. We also recommend that a
      file or class name and description of purpose be included on the
      same "printed page" as the copyright notice for easier
      identification within third-party archives.

   Copyright [yyyy] [name of copyright owner]

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_ide.wiki_license.asciidoc_eclipse-public-license---version-1.0">Eclipse Public License - Version 1.0</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>THE ACCOMPANYING PROGRAM IS PROVIDED UNDER THE TERMS OF THIS ECLIPSE PUBLIC LICENSE ("AGREEMENT"). ANY USE, REPRODUCTION OR DISTRIBUTION OF THE PROGRAM CONSTITUTES RECIPIENT'S ACCEPTANCE OF THIS AGREEMENT.

1. DEFINITIONS

"Contribution" means:

a) in the case of the initial Contributor, the initial code and documentation distributed under this Agreement, and

b) in the case of each subsequent Contributor:

i) changes to the Program, and

ii) additions to the Program;

where such changes and/or additions to the Program originate from and are distributed by that particular Contributor. A Contribution 'originates' from a Contributor if it was added to the Program by such Contributor itself or anyone acting on such Contributor's behalf. Contributions do not include additions to the Program which: (i) are separate modules of software distributed in conjunction with the Program under their own license agreement, and (ii) are not derivative works of the Program.

"Contributor" means any person or entity that distributes the Program.

"Licensed Patents" mean patent claims licensable by a Contributor which are necessarily infringed by the use or sale of its Contribution alone or when combined with the Program.

"Program" means the Contributions distributed in accordance with this Agreement.

"Recipient" means anyone who receives the Program under this Agreement, including all Contributors.

2. GRANT OF RIGHTS

a) Subject to the terms of this Agreement, each Contributor hereby grants Recipient a non-exclusive, worldwide, royalty-free copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, distribute and sublicense the Contribution of such Contributor, if any, and such derivative works, in source code and object code form.

b) Subject to the terms of this Agreement, each Contributor hereby grants Recipient a non-exclusive, worldwide, royalty-free patent license under Licensed Patents to make, use, sell, offer to sell, import and otherwise transfer the Contribution of such Contributor, if any, in source code and object code form. This patent license shall apply to the combination of the Contribution and the Program if, at the time the Contribution is added by the Contributor, such addition of the Contribution causes such combination to be covered by the Licensed Patents. The patent license shall not apply to any other combinations which include the Contribution. No hardware per se is licensed hereunder.

c) Recipient understands that although each Contributor grants the licenses to its Contributions set forth herein, no assurances are provided by any Contributor that the Program does not infringe the patent or other intellectual property rights of any other entity. Each Contributor disclaims any liability to Recipient for claims brought by any other entity based on infringement of intellectual property rights or otherwise. As a condition to exercising the rights and licenses granted hereunder, each Recipient hereby assumes sole responsibility to secure any other intellectual property rights needed, if any. For example, if a third party patent license is required to allow Recipient to distribute the Program, it is Recipient's responsibility to acquire that license before distributing the Program.

d) Each Contributor represents that to its knowledge it has sufficient copyright rights in its Contribution, if any, to grant the copyright license set forth in this Agreement.

3. REQUIREMENTS

A Contributor may choose to distribute the Program in object code form under its own license agreement, provided that:

a) it complies with the terms and conditions of this Agreement; and

b) its license agreement:

i) effectively disclaims on behalf of all Contributors all warranties and conditions, express and implied, including warranties or conditions of title and non-infringement, and implied warranties or conditions of merchantability and fitness for a particular purpose;

ii) effectively excludes on behalf of all Contributors all liability for damages, including direct, indirect, special, incidental and consequential damages, such as lost profits;

iii) states that any provisions which differ from this Agreement are offered by that Contributor alone and not by any other party; and

iv) states that source code for the Program is available from such Contributor, and informs licensees how to obtain it in a reasonable manner on or through a medium customarily used for software exchange.

When the Program is made available in source code form:

a) it must be made available under this Agreement; and

b) a copy of this Agreement must be included with each copy of the Program.

Contributors may not remove or alter any copyright notices contained within the Program.

Each Contributor must identify itself as the originator of its Contribution, if any, in a manner that reasonably allows subsequent Recipients to identify the originator of the Contribution.

4. COMMERCIAL DISTRIBUTION

Commercial distributors of software may accept certain responsibilities with respect to end users, business partners and the like. While this license is intended to facilitate the commercial use of the Program, the Contributor who includes the Program in a commercial product offering should do so in a manner which does not create potential liability for other Contributors. Therefore, if a Contributor includes the Program in a commercial product offering, such Contributor ("Commercial Contributor") hereby agrees to defend and indemnify every other Contributor ("Indemnified Contributor") against any losses, damages and costs (collectively "Losses") arising from claims, lawsuits and other legal actions brought by a third party against the Indemnified Contributor to the extent caused by the acts or omissions of such Commercial Contributor in connection with its distribution of the Program in a commercial product offering. The obligations in this section do not apply to any claims or Losses relating to any actual or alleged intellectual property infringement. In order to qualify, an Indemnified Contributor must: a) promptly notify the Commercial Contributor in writing of such claim, and b) allow the Commercial Contributor to control, and cooperate with the Commercial Contributor in, the defense and any related settlement negotiations. The Indemnified Contributor may participate in any such claim at its own expense.

For example, a Contributor might include the Program in a commercial product offering, Product X. That Contributor is then a Commercial Contributor. If that Commercial Contributor then makes performance claims, or offers warranties related to Product X, those performance claims and warranties are such Commercial Contributor's responsibility alone. Under this section, the Commercial Contributor would have to defend claims against the other Contributors related to those performance claims and warranties, and if a court requires any other Contributor to pay any damages as a result, the Commercial Contributor must pay those damages.

5. NO WARRANTY

EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, THE PROGRAM IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED INCLUDING, WITHOUT LIMITATION, ANY WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. Each Recipient is solely responsible for determining the appropriateness of using and distributing the Program and assumes all risks associated with its exercise of rights under this Agreement , including but not limited to the risks and costs of program errors, compliance with applicable laws, damage to or loss of data, programs or equipment, and unavailability or interruption of operations.

6. DISCLAIMER OF LIABILITY

EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, NEITHER RECIPIENT NOR ANY CONTRIBUTORS SHALL HAVE ANY LIABILITY FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING WITHOUT LIMITATION LOST PROFITS), HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OR DISTRIBUTION OF THE PROGRAM OR THE EXERCISE OF ANY RIGHTS GRANTED HEREUNDER, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

7. GENERAL

If any provision of this Agreement is invalid or unenforceable under applicable law, it shall not affect the validity or enforceability of the remainder of the terms of this Agreement, and without further action by the parties hereto, such provision shall be reformed to the minimum extent necessary to make such provision valid and enforceable.

If Recipient institutes patent litigation against any entity (including a cross-claim or counterclaim in a lawsuit) alleging that the Program itself (excluding combinations of the Program with other software or hardware) infringes such Recipient's patent(s), then such Recipient's rights granted under Section 2(b) shall terminate as of the date such litigation is filed.

All Recipient's rights under this Agreement shall terminate if it fails to comply with any of the material terms or conditions of this Agreement and does not cure such failure in a reasonable period of time after becoming aware of such noncompliance. If all Recipient's rights under this Agreement terminate, Recipient agrees to cease use and distribution of the Program as soon as reasonably practicable. However, Recipient's obligations under this Agreement and any licenses granted by Recipient relating to the Program shall continue and survive.

Everyone is permitted to copy and distribute copies of this Agreement, but in order to avoid inconsistency the Agreement is copyrighted and may only be modified in the following manner. The Agreement Steward reserves the right to publish new versions (including revisions) of this Agreement from time to time. No one other than the Agreement Steward has the right to modify this Agreement. The Eclipse Foundation is the initial Agreement Steward. The Eclipse Foundation may assign the responsibility to serve as the Agreement Steward to a suitable separate entity. Each new version of the Agreement will be given a distinguishing version number. The Program (including Contributions) may always be distributed subject to the version of the Agreement under which it was received. In addition, after a new version of the Agreement is published, Contributor may elect to distribute the Program (including its Contributions) under the new version. Except as expressly stated in Sections 2(a) and 2(b) above, Recipient receives no rights or licenses to the intellectual property of any Contributor under this Agreement, whether expressly, by implication, estoppel or otherwise. All rights in the Program not expressly granted under this Agreement are reserved.

This Agreement is governed by the laws of the State of New York and the intellectual property laws of the United States of America. No party to this Agreement will bring a legal action under this Agreement more than one year after the cause of action arose. Each party waives its rights to a jury trial in any resulting litigation.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_ide.wiki_license.asciidoc_eclipse-public-license---version-2.0">Eclipse Public License - Version 2.0</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>THE ACCOMPANYING PROGRAM IS PROVIDED UNDER THE TERMS OF THIS ECLIPSE PUBLIC LICENSE (“AGREEMENT”). ANY USE, REPRODUCTION OR DISTRIBUTION OF THE PROGRAM CONSTITUTES RECIPIENT'S ACCEPTANCE OF THIS AGREEMENT.
1. DEFINITIONS

“Contribution” means:

    a) in the case of the initial Contributor, the initial content Distributed under this Agreement, and
    b) in the case of each subsequent Contributor:
        i) changes to the Program, and
        ii) additions to the Program;
    where such changes and/or additions to the Program originate from and are Distributed by that particular Contributor. A Contribution “originates” from a Contributor if it was added to the Program by such Contributor itself or anyone acting on such Contributor's behalf. Contributions do not include changes or additions to the Program that are not Modified Works.

“Contributor” means any person or entity that Distributes the Program.

“Licensed Patents” mean patent claims licensable by a Contributor which are necessarily infringed by the use or sale of its Contribution alone or when combined with the Program.

“Program” means the Contributions Distributed in accordance with this Agreement.

“Recipient” means anyone who receives the Program under this Agreement or any Secondary License (as applicable), including Contributors.

“Derivative Works” shall mean any work, whether in Source Code or other form, that is based on (or derived from) the Program and for which the editorial revisions, annotations, elaborations, or other modifications represent, as a whole, an original work of authorship.

“Modified Works” shall mean any work in Source Code or other form that results from an addition to, deletion from, or modification of the contents of the Program, including, for purposes of clarity any new file in Source Code form that contains any contents of the Program. Modified Works shall not include works that contain only declarations, interfaces, types, classes, structures, or files of the Program solely in each case in order to link to, bind by name, or subclass the Program or Modified Works thereof.

“Distribute” means the acts of a) distributing or b) making available in any manner that enables the transfer of a copy.

“Source Code” means the form of a Program preferred for making modifications, including but not limited to software source code, documentation source, and configuration files.

“Secondary License” means either the GNU General Public License, Version 2.0, or any later versions of that license, including any exceptions or additional permissions as identified by the initial Contributor.
2. GRANT OF RIGHTS

    a) Subject to the terms of this Agreement, each Contributor hereby grants Recipient a non-exclusive, worldwide, royalty-free copyright license to reproduce, prepare Derivative Works of, publicly display, publicly perform, Distribute and sublicense the Contribution of such Contributor, if any, and such Derivative Works.
    b) Subject to the terms of this Agreement, each Contributor hereby grants Recipient a non-exclusive, worldwide, royalty-free patent license under Licensed Patents to make, use, sell, offer to sell, import and otherwise transfer the Contribution of such Contributor, if any, in Source Code or other form. This patent license shall apply to the combination of the Contribution and the Program if, at the time the Contribution is added by the Contributor, such addition of the Contribution causes such combination to be covered by the Licensed Patents. The patent license shall not apply to any other combinations which include the Contribution. No hardware per se is licensed hereunder.
    c) Recipient understands that although each Contributor grants the licenses to its Contributions set forth herein, no assurances are provided by any Contributor that the Program does not infringe the patent or other intellectual property rights of any other entity. Each Contributor disclaims any liability to Recipient for claims brought by any other entity based on infringement of intellectual property rights or otherwise. As a condition to exercising the rights and licenses granted hereunder, each Recipient hereby assumes sole responsibility to secure any other intellectual property rights needed, if any. For example, if a third party patent license is required to allow Recipient to Distribute the Program, it is Recipient's responsibility to acquire that license before distributing the Program.
    d) Each Contributor represents that to its knowledge it has sufficient copyright rights in its Contribution, if any, to grant the copyright license set forth in this Agreement.
    e) Notwithstanding the terms of any Secondary License, no Contributor makes additional grants to any Recipient (other than those set forth in this Agreement) as a result of such Recipient's receipt of the Program under the terms of a Secondary License (if permitted under the terms of Section 3).

3. REQUIREMENTS

3.1 If a Contributor Distributes the Program in any form, then:

    a) the Program must also be made available as Source Code, in accordance with section 3.2, and the Contributor must accompany the Program with a statement that the Source Code for the Program is available under this Agreement, and informs Recipients how to obtain it in a reasonable manner on or through a medium customarily used for software exchange; and
    b) the Contributor may Distribute the Program under a license different than this Agreement, provided that such license:
        i) effectively disclaims on behalf of all other Contributors all warranties and conditions, express and implied, including warranties or conditions of title and non-infringement, and implied warranties or conditions of merchantability and fitness for a particular purpose;
        ii) effectively excludes on behalf of all other Contributors all liability for damages, including direct, indirect, special, incidental and consequential damages, such as lost profits;
        iii) does not attempt to limit or alter the recipients' rights in the Source Code under section 3.2; and
        iv) requires any subsequent distribution of the Program by any party to be under a license that satisfies the requirements of this section 3.

3.2 When the Program is Distributed as Source Code:

    a) it must be made available under this Agreement, or if the Program (i) is combined with other material in a separate file or files made available under a Secondary License, and (ii) the initial Contributor attached to the Source Code the notice described in Exhibit A of this Agreement, then the Program may be made available under the terms of such Secondary Licenses, and
    b) a copy of this Agreement must be included with each copy of the Program.

3.3 Contributors may not remove or alter any copyright, patent, trademark, attribution notices, disclaimers of warranty, or limitations of liability (‘notices’) contained within the Program from any copy of the Program which they Distribute, provided that Contributors may add their own appropriate notices.
4. COMMERCIAL DISTRIBUTION

Commercial distributors of software may accept certain responsibilities with respect to end users, business partners and the like. While this license is intended to facilitate the commercial use of the Program, the Contributor who includes the Program in a commercial product offering should do so in a manner which does not create potential liability for other Contributors. Therefore, if a Contributor includes the Program in a commercial product offering, such Contributor (“Commercial Contributor”) hereby agrees to defend and indemnify every other Contributor (“Indemnified Contributor”) against any losses, damages and costs (collectively “Losses”) arising from claims, lawsuits and other legal actions brought by a third party against the Indemnified Contributor to the extent caused by the acts or omissions of such Commercial Contributor in connection with its distribution of the Program in a commercial product offering. The obligations in this section do not apply to any claims or Losses relating to any actual or alleged intellectual property infringement. In order to qualify, an Indemnified Contributor must: a) promptly notify the Commercial Contributor in writing of such claim, and b) allow the Commercial Contributor to control, and cooperate with the Commercial Contributor in, the defense and any related settlement negotiations. The Indemnified Contributor may participate in any such claim at its own expense.

For example, a Contributor might include the Program in a commercial product offering, Product X. That Contributor is then a Commercial Contributor. If that Commercial Contributor then makes performance claims, or offers warranties related to Product X, those performance claims and warranties are such Commercial Contributor's responsibility alone. Under this section, the Commercial Contributor would have to defend claims against the other Contributors related to those performance claims and warranties, and if a court requires any other Contributor to pay any damages as a result, the Commercial Contributor must pay those damages.
5. NO WARRANTY

EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, AND TO THE EXTENT PERMITTED BY APPLICABLE LAW, THE PROGRAM IS PROVIDED ON AN “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED INCLUDING, WITHOUT LIMITATION, ANY WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. Each Recipient is solely responsible for determining the appropriateness of using and distributing the Program and assumes all risks associated with its exercise of rights under this Agreement, including but not limited to the risks and costs of program errors, compliance with applicable laws, damage to or loss of data, programs or equipment, and unavailability or interruption of operations.
6. DISCLAIMER OF LIABILITY

EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, AND TO THE EXTENT PERMITTED BY APPLICABLE LAW, NEITHER RECIPIENT NOR ANY CONTRIBUTORS SHALL HAVE ANY LIABILITY FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING WITHOUT LIMITATION LOST PROFITS), HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OR DISTRIBUTION OF THE PROGRAM OR THE EXERCISE OF ANY RIGHTS GRANTED HEREUNDER, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
7. GENERAL

If any provision of this Agreement is invalid or unenforceable under applicable law, it shall not affect the validity or enforceability of the remainder of the terms of this Agreement, and without further action by the parties hereto, such provision shall be reformed to the minimum extent necessary to make such provision valid and enforceable.

If Recipient institutes patent litigation against any entity (including a cross-claim or counterclaim in a lawsuit) alleging that the Program itself (excluding combinations of the Program with other software or hardware) infringes such Recipient's patent(s), then such Recipient's rights granted under Section 2(b) shall terminate as of the date such litigation is filed.

All Recipient's rights under this Agreement shall terminate if it fails to comply with any of the material terms or conditions of this Agreement and does not cure such failure in a reasonable period of time after becoming aware of such noncompliance. If all Recipient's rights under this Agreement terminate, Recipient agrees to cease use and distribution of the Program as soon as reasonably practicable. However, Recipient's obligations under this Agreement and any licenses granted by Recipient relating to the Program shall continue and survive.

Everyone is permitted to copy and distribute copies of this Agreement, but in order to avoid inconsistency the Agreement is copyrighted and may only be modified in the following manner. The Agreement Steward reserves the right to publish new versions (including revisions) of this Agreement from time to time. No one other than the Agreement Steward has the right to modify this Agreement. The Eclipse Foundation is the initial Agreement Steward. The Eclipse Foundation may assign the responsibility to serve as the Agreement Steward to a suitable separate entity. Each new version of the Agreement will be given a distinguishing version number. The Program (including Contributions) may always be Distributed subject to the version of the Agreement under which it was received. In addition, after a new version of the Agreement is published, Contributor may elect to Distribute the Program (including its Contributions) under the new version.

Except as expressly stated in Sections 2(a) and 2(b) above, Recipient receives no rights or licenses to the intellectual property of any Contributor under this Agreement, whether expressly, by implication, estoppel or otherwise. All rights in the Program not expressly granted under this Agreement are reserved. Nothing in this Agreement is intended to be enforceable by any entity that is not a Contributor or Recipient. No third-party beneficiary rights are created under this Agreement.
Exhibit A – Form of Secondary Licenses Notice

“This Source Code may also be made available under the following Secondary Licenses when the conditions for such availability set forth in the Eclipse Public License, v. 2.0 are satisfied: {name license(s), version(s), and exceptions or additional permissions here}.”

    Simply including a copy of this Agreement, including this Exhibit A is not sufficient to license the Source Code under Secondary Licenses.

    If it is not possible or desirable to put the notice in a particular file, then You may include the notice in a location (such as a LICENSE file in a relevant directory) where a recipient would be likely to look for such a notice.

    You may add additional accurate notices of copyright ownership.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_ide.wiki_license.asciidoc_mit-license">MIT License</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Copyright &lt;YEAR&gt; &lt;COPYRIGHT HOLDER&gt;

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_ide.wiki_license.asciidoc_artistic-license---version-2.0">Artistic License - Version 2.0</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Copyright (c) 2000-2006, The Perl Foundation.

Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed.
Preamble

This license establishes the terms under which a given free software Package may be copied, modified, distributed, and/or redistributed. The intent is that the Copyright Holder maintains some artistic control over the development of that Package while still keeping the Package available as open source and free software.

You are always permitted to make arrangements wholly outside of this license directly with the Copyright Holder of a given Package. If the terms of this license do not permit the full use that you propose to make of the Package, you should contact the Copyright Holder and seek a different licensing arrangement.
Definitions

"Copyright Holder" means the individual(s) or organization(s) named in the copyright notice for the entire Package.

"Contributor" means any party that has contributed code or other material to the Package, in accordance with the Copyright Holder's procedures.

"You" and "your" means any person who would like to copy, distribute, or modify the Package.

"Package" means the collection of files distributed by the Copyright Holder, and derivatives of that collection and/or of those files. A given Package may consist of either the Standard Version, or a Modified Version.

"Distribute" means providing a copy of the Package or making it accessible to anyone else, or in the case of a company or organization, to others outside of your company or organization.

"Distributor Fee" means any fee that you charge for Distributing this Package or providing support for this Package to another party. It does not mean licensing fees.

"Standard Version" refers to the Package if it has not been modified, or has been modified only in ways explicitly requested by the Copyright Holder.

"Modified Version" means the Package, if it has been changed, and such changes were not explicitly requested by the Copyright Holder.

"Original License" means this Artistic License as Distributed with the Standard Version of the Package, in its current version or as it may be modified by The Perl Foundation in the future.

"Source" form means the source code, documentation source, and configuration files for the Package.

"Compiled" form means the compiled bytecode, object code, binary, or any other form resulting from mechanical transformation or translation of the Source form.
Permission for Use and Modification Without Distribution

(1) You are permitted to use the Standard Version and create and use Modified Versions for any purpose without restriction, provided that you do not Distribute the Modified Version.
Permissions for Redistribution of the Standard Version

(2) You may Distribute verbatim copies of the Source form of the Standard Version of this Package in any medium without restriction, either gratis or for a Distributor Fee, provided that you duplicate all of the original copyright notices and associated disclaimers. At your discretion, such verbatim copies may or may not include a Compiled form of the Package.

(3) You may apply any bug fixes, portability changes, and other modifications made available from the Copyright Holder. The resulting Package will still be considered the Standard Version, and as such will be subject to the Original License.
Distribution of Modified Versions of the Package as Source

(4) You may Distribute your Modified Version as Source (either gratis or for a Distributor Fee, and with or without a Compiled form of the Modified Version) provided that you clearly document how it differs from the Standard Version, including, but not limited to, documenting any non-standard features, executables, or modules, and provided that you do at least ONE of the following:

(a) make the Modified Version available to the Copyright Holder of the Standard Version, under the Original License, so that the Copyright Holder may include your modifications in the Standard Version.
(b) ensure that installation of your Modified Version does not prevent the user installing or running the Standard Version. In addition, the Modified Version must bear a name that is different from the name of the Standard Version.
(c) allow anyone who receives a copy of the Modified Version to make the Source form of the Modified Version available to others under
(i) the Original License or
(ii) a license that permits the licensee to freely copy, modify and redistribute the Modified Version using the same licensing terms that apply to the copy that the licensee received, and requires that the Source form of the Modified Version, and of any works derived from it, be made freely available in that license fees are prohibited but Distributor Fees are allowed.
Distribution of Compiled Forms of the Standard Version or Modified Versions without the Source

(5) You may Distribute Compiled forms of the Standard Version without the Source, provided that you include complete instructions on how to get the Source of the Standard Version. Such instructions must be valid at the time of your distribution. If these instructions, at any time while you are carrying out such distribution, become invalid, you must provide new instructions on demand or cease further distribution. If you provide valid instructions or cease distribution within thirty days after you become aware that the instructions are invalid, then you do not forfeit any of your rights under this license.

(6) You may Distribute a Modified Version in Compiled form without the Source, provided that you comply with Section 4 with respect to the Source of the Modified Version.
Aggregating or Linking the Package

(7) You may aggregate the Package (either the Standard Version or Modified Version) with other packages and Distribute the resulting aggregation provided that you do not charge a licensing fee for the Package. Distributor Fees are permitted, and licensing fees for other components in the aggregation are permitted. The terms of this license apply to the use and Distribution of the Standard or Modified Versions as included in the aggregation.

(8) You are permitted to link Modified and Standard Versions with other works, to embed the Package in a larger work of your own, or to build stand-alone binary or bytecode versions of applications that include the Package, and Distribute the result without restriction, provided the result does not expose a direct interface to the Package.
Items That are Not Considered Part of a Modified Version

(9) Works (including, but not limited to, modules and scripts) that merely extend or make use of the Package, do not, by themselves, cause the Package to be a Modified Version. In addition, such works are not considered parts of the Package itself, and are not subject to the terms of this license.
General Provisions

(10) Any use, modification, and distribution of the Standard or Modified Versions is governed by this Artistic License. By using, modifying or distributing the Package, you accept this license. Do not use, modify, or distribute the Package, if you do not accept this license.

(11) If your Modified Version has been derived from a Modified Version made by someone other than you, you are nevertheless required to ensure that your Modified Version complies with the requirements of this license.

(12) This license does not grant you the right to use any trademark, service mark, tradename, or logo of the Copyright Holder.

(13) This license includes the non-exclusive, worldwide, free-of-charge patent license to make, have made, use, offer to sell, sell, import and otherwise transfer the Package with respect to any patent claims licensable by the Copyright Holder that are necessarily infringed by the Package. If you institute patent litigation (including a cross-claim or counterclaim) against any party alleging that the Package constitutes direct or contributory patent infringement, then this Artistic License to you shall terminate on the date that such litigation is filed.

(14) Disclaimer of Warranty: THE PACKAGE IS PROVIDED BY THE COPYRIGHT HOLDER AND CONTRIBUTORS "AS IS' AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES. THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR NON-INFRINGEMENT ARE DISCLAIMED TO THE EXTENT PERMITTED BY YOUR LOCAL LAW. UNLESS REQUIRED BY LAW, NO COPYRIGHT HOLDER OR CONTRIBUTOR WILL BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES ARISING IN ANY WAY OUT OF THE USE OF THE PACKAGE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_ide.wiki_license.asciidoc_creative-commons-license---attribution-noderivatives-4.0-international">Creative Commons License - Attribution-NoDerivatives 4.0 International</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>By exercising the Licensed Rights (defined below), You accept and agree to be bound by the terms and conditions of this Creative Commons Attribution-NoDerivatives 4.0 International Public License ("Public License"). To the extent this Public License may be interpreted as a contract, You are granted the Licensed Rights in consideration of Your acceptance of these terms and conditions, and the Licensor grants You such rights in consideration of benefits the Licensor receives from making the Licensed Material available under these terms and conditions.

Section 1 – Definitions.

    Adapted Material means material subject to Copyright and Similar Rights that is derived from or based upon the Licensed Material and in which the Licensed Material is translated, altered, arranged, transformed, or otherwise modified in a manner requiring permission under the Copyright and Similar Rights held by the Licensor. For purposes of this Public License, where the Licensed Material is a musical work, performance, or sound recording, Adapted Material is always produced where the Licensed Material is synched in timed relation with a moving image.
    Copyright and Similar Rights means copyright and/or similar rights closely related to copyright including, without limitation, performance, broadcast, sound recording, and Sui Generis Database Rights, without regard to how the rights are labeled or categorized. For purposes of this Public License, the rights specified in Section 2(b)(1)-(2) are not Copyright and Similar Rights.
    Effective Technological Measures means those measures that, in the absence of proper authority, may not be circumvented under laws fulfilling obligations under Article 11 of the WIPO Copyright Treaty adopted on December 20, 1996, and/or similar international agreements.
    Exceptions and Limitations means fair use, fair dealing, and/or any other exception or limitation to Copyright and Similar Rights that applies to Your use of the Licensed Material.
    Licensed Material means the artistic or literary work, database, or other material to which the Licensor applied this Public License.
    Licensed Rights means the rights granted to You subject to the terms and conditions of this Public License, which are limited to all Copyright and Similar Rights that apply to Your use of the Licensed Material and that the Licensor has authority to license.
    Licensor means the individual(s) or entity(ies) granting rights under this Public License.
    Share means to provide material to the public by any means or process that requires permission under the Licensed Rights, such as reproduction, public display, public performance, distribution, dissemination, communication, or importation, and to make material available to the public including in ways that members of the public may access the material from a place and at a time individually chosen by them.
    Sui Generis Database Rights means rights other than copyright resulting from Directive 96/9/EC of the European Parliament and of the Council of 11 March 1996 on the legal protection of databases, as amended and/or succeeded, as well as other essentially equivalent rights anywhere in the world.
    You means the individual or entity exercising the Licensed Rights under this Public License. Your has a corresponding meaning.

Section 2 – Scope.

    License grant.
        Subject to the terms and conditions of this Public License, the Licensor hereby grants You a worldwide, royalty-free, non-sublicensable, non-exclusive, irrevocable license to exercise the Licensed Rights in the Licensed Material to:
            reproduce and Share the Licensed Material, in whole or in part; and
            produce and reproduce, but not Share, Adapted Material.
        Exceptions and Limitations. For the avoidance of doubt, where Exceptions and Limitations apply to Your use, this Public License does not apply, and You do not need to comply with its terms and conditions.
        Term. The term of this Public License is specified in Section 6(a).
        Media and formats; technical modifications allowed. The Licensor authorizes You to exercise the Licensed Rights in all media and formats whether now known or hereafter created, and to make technical modifications necessary to do so. The Licensor waives and/or agrees not to assert any right or authority to forbid You from making technical modifications necessary to exercise the Licensed Rights, including technical modifications necessary to circumvent Effective Technological Measures. For purposes of this Public License, simply making modifications authorized by this Section 2(a)(4) never produces Adapted Material.
        Downstream recipients.
            Offer from the Licensor – Licensed Material. Every recipient of the Licensed Material automatically receives an offer from the Licensor to exercise the Licensed Rights under the terms and conditions of this Public License.
            No downstream restrictions. You may not offer or impose any additional or different terms or conditions on, or apply any Effective Technological Measures to, the Licensed Material if doing so restricts exercise of the Licensed Rights by any recipient of the Licensed Material.
        No endorsement. Nothing in this Public License constitutes or may be construed as permission to assert or imply that You are, or that Your use of the Licensed Material is, connected with, or sponsored, endorsed, or granted official status by, the Licensor or others designated to receive attribution as provided in Section 3(a)(1)(A)(i).

    Other rights.
        Moral rights, such as the right of integrity, are not licensed under this Public License, nor are publicity, privacy, and/or other similar personality rights; however, to the extent possible, the Licensor waives and/or agrees not to assert any such rights held by the Licensor to the limited extent necessary to allow You to exercise the Licensed Rights, but not otherwise.
        Patent and trademark rights are not licensed under this Public License.
        To the extent possible, the Licensor waives any right to collect royalties from You for the exercise of the Licensed Rights, whether directly or through a collecting society under any voluntary or waivable statutory or compulsory licensing scheme. In all other cases the Licensor expressly reserves any right to collect such royalties.

Section 3 – License Conditions.

Your exercise of the Licensed Rights is expressly made subject to the following conditions.

    Attribution.

        If You Share the Licensed Material, You must:
            retain the following if it is supplied by the Licensor with the Licensed Material:
                identification of the creator(s) of the Licensed Material and any others designated to receive attribution, in any reasonable manner requested by the Licensor (including by pseudonym if designated);
                a copyright notice;
                a notice that refers to this Public License;
                a notice that refers to the disclaimer of warranties;
                a URI or hyperlink to the Licensed Material to the extent reasonably practicable;
            indicate if You modified the Licensed Material and retain an indication of any previous modifications; and
            indicate the Licensed Material is licensed under this Public License, and include the text of, or the URI or hyperlink to, this Public License.
        For the avoidance of doubt, You do not have permission under this Public License to Share Adapted Material.
        You may satisfy the conditions in Section 3(a)(1) in any reasonable manner based on the medium, means, and context in which You Share the Licensed Material. For example, it may be reasonable to satisfy the conditions by providing a URI or hyperlink to a resource that includes the required information.
        If requested by the Licensor, You must remove any of the information required by Section 3(a)(1)(A) to the extent reasonably practicable.

Section 4 – Sui Generis Database Rights.

Where the Licensed Rights include Sui Generis Database Rights that apply to Your use of the Licensed Material:

    for the avoidance of doubt, Section 2(a)(1) grants You the right to extract, reuse, reproduce, and Share all or a substantial portion of the contents of the database, provided You do not Share Adapted Material;
    if You include all or a substantial portion of the database contents in a database in which You have Sui Generis Database Rights, then the database in which You have Sui Generis Database Rights (but not its individual contents) is Adapted Material; and
    You must comply with the conditions in Section 3(a) if You Share all or a substantial portion of the contents of the database.

For the avoidance of doubt, this Section 4 supplements and does not replace Your obligations under this Public License where the Licensed Rights include other Copyright and Similar Rights.

Section 5 – Disclaimer of Warranties and Limitation of Liability.

    Unless otherwise separately undertaken by the Licensor, to the extent possible, the Licensor offers the Licensed Material as-is and as-available, and makes no representations or warranties of any kind concerning the Licensed Material, whether express, implied, statutory, or other. This includes, without limitation, warranties of title, merchantability, fitness for a particular purpose, non-infringement, absence of latent or other defects, accuracy, or the presence or absence of errors, whether or not known or discoverable. Where disclaimers of warranties are not allowed in full or in part, this disclaimer may not apply to You.
    To the extent possible, in no event will the Licensor be liable to You on any legal theory (including, without limitation, negligence) or otherwise for any direct, special, indirect, incidental, consequential, punitive, exemplary, or other losses, costs, expenses, or damages arising out of this Public License or use of the Licensed Material, even if the Licensor has been advised of the possibility of such losses, costs, expenses, or damages. Where a limitation of liability is not allowed in full or in part, this limitation may not apply to You.

    The disclaimer of warranties and limitation of liability provided above shall be interpreted in a manner that, to the extent possible, most closely approximates an absolute disclaimer and waiver of all liability.

Section 6 – Term and Termination.

    This Public License applies for the term of the Copyright and Similar Rights licensed here. However, if You fail to comply with this Public License, then Your rights under this Public License terminate automatically.

    Where Your right to use the Licensed Material has terminated under Section 6(a), it reinstates:
        automatically as of the date the violation is cured, provided it is cured within 30 days of Your discovery of the violation; or
        upon express reinstatement by the Licensor.
    For the avoidance of doubt, this Section 6(b) does not affect any right the Licensor may have to seek remedies for Your violations of this Public License.
    For the avoidance of doubt, the Licensor may also offer the Licensed Material under separate terms or conditions or stop distributing the Licensed Material at any time; however, doing so will not terminate this Public License.
    Sections 1, 5, 6, 7, and 8 survive termination of this Public License.

Section 7 – Other Terms and Conditions.

    The Licensor shall not be bound by any additional or different terms or conditions communicated by You unless expressly agreed.
    Any arrangements, understandings, or agreements regarding the Licensed Material not stated herein are separate from and independent of the terms and conditions of this Public License.

Section 8 – Interpretation.

    For the avoidance of doubt, this Public License does not, and shall not be interpreted to, reduce, limit, restrict, or impose conditions on any use of the Licensed Material that could lawfully be made without permission under this Public License.
    To the extent possible, if any provision of this Public License is deemed unenforceable, it shall be automatically reformed to the minimum extent necessary to make it enforceable. If the provision cannot be reformed, it shall be severed from this Public License without affecting the enforceability of the remaining terms and conditions.
    No term or condition of this Public License will be waived and no failure to comply consented to unless expressly agreed to by the Licensor.
    Nothing in this Public License constitutes or may be interpreted as a limitation upon, or waiver of, any privileges and immunities that apply to the Licensor or You, including from the legal processes of any jurisdiction or authority.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_ide.wiki_license.asciidoc_gnu-lesser-general-public-license---version-2.1">GNU LESSER GENERAL PUBLIC LICENSE - Version 2.1</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code> Version 2.1, February 1999

Copyright (C) 1991, 1999 Free Software Foundation, Inc.
51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.

[This is the first released version of the Lesser GPL.  It also counts
 as the successor of the GNU Library Public License, version 2, hence
 the version number 2.1.]

Preamble

The licenses for most software are designed to take away your freedom to share and change it. By contrast, the GNU General Public Licenses are intended to guarantee your freedom to share and change free software--to make sure the software is free for all its users.

This license, the Lesser General Public License, applies to some specially designated software packages--typically libraries--of the Free Software Foundation and other authors who decide to use it. You can use it too, but we suggest you first think carefully about whether this license or the ordinary General Public License is the better strategy to use in any particular case, based on the explanations below.

When we speak of free software, we are referring to freedom of use, not price. Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for this service if you wish); that you receive source code or can get it if you want it; that you can change the software and use pieces of it in new free programs; and that you are informed that you can do these things.

To protect your rights, we need to make restrictions that forbid distributors to deny you these rights or to ask you to surrender these rights. These restrictions translate to certain responsibilities for you if you distribute copies of the library or if you modify it.

For example, if you distribute copies of the library, whether gratis or for a fee, you must give the recipients all the rights that we gave you. You must make sure that they, too, receive or can get the source code. If you link other code with the library, you must provide complete object files to the recipients, so that they can relink them with the library after making changes to the library and recompiling it. And you must show them these terms so they know their rights.

We protect your rights with a two-step method: (1) we copyright the library, and (2) we offer you this license, which gives you legal permission to copy, distribute and/or modify the library.

To protect each distributor, we want to make it very clear that there is no warranty for the free library. Also, if the library is modified by someone else and passed on, the recipients should know that what they have is not the original version, so that the original author's reputation will not be affected by problems that might be introduced by others.

Finally, software patents pose a constant threat to the existence of any free program. We wish to make sure that a company cannot effectively restrict the users of a free program by obtaining a restrictive license from a patent holder. Therefore, we insist that any patent license obtained for a version of the library must be consistent with the full freedom of use specified in this license.

Most GNU software, including some libraries, is covered by the ordinary GNU General Public License. This license, the GNU Lesser General Public License, applies to certain designated libraries, and is quite different from the ordinary General Public License. We use this license for certain libraries in order to permit linking those libraries into non-free programs.

When a program is linked with a library, whether statically or using a shared library, the combination of the two is legally speaking a combined work, a derivative of the original library. The ordinary General Public License therefore permits such linking only if the entire combination fits its criteria of freedom. The Lesser General Public License permits more lax criteria for linking other code with the library.

We call this license the "Lesser" General Public License because it does Less to protect the user's freedom than the ordinary General Public License. It also provides other free software developers Less of an advantage over competing non-free programs. These disadvantages are the reason we use the ordinary General Public License for many libraries. However, the Lesser license provides advantages in certain special circumstances.

For example, on rare occasions, there may be a special need to encourage the widest possible use of a certain library, so that it becomes a de-facto standard. To achieve this, non-free programs must be allowed to use the library. A more frequent case is that a free library does the same job as widely used non-free libraries. In this case, there is little to gain by limiting the free library to free software only, so we use the Lesser General Public License.

In other cases, permission to use a particular library in non-free programs enables a greater number of people to use a large body of free software. For example, permission to use the GNU C Library in non-free programs enables many more people to use the whole GNU operating system, as well as its variant, the GNU/Linux operating system.

Although the Lesser General Public License is Less protective of the users' freedom, it does ensure that the user of a program that is linked with the Library has the freedom and the wherewithal to run that program using a modified version of the Library.

The precise terms and conditions for copying, distribution and modification follow. Pay close attention to the difference between a "work based on the library" and a "work that uses the library". The former contains code derived from the library, whereas the latter must be combined with the library in order to run.
TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

0. This License Agreement applies to any software library or other program which contains a notice placed by the copyright holder or other authorized party saying it may be distributed under the terms of this Lesser General Public License (also called "this License"). Each licensee is addressed as "you".

A "library" means a collection of software functions and/or data prepared so as to be conveniently linked with application programs (which use some of those functions and data) to form executables.

The "Library", below, refers to any such software library or work which has been distributed under these terms. A "work based on the Library" means either the Library or any derivative work under copyright law: that is to say, a work containing the Library or a portion of it, either verbatim or with modifications and/or translated straightforwardly into another language. (Hereinafter, translation is included without limitation in the term "modification".)

"Source code" for a work means the preferred form of the work for making modifications to it. For a library, complete source code means all the source code for all modules it contains, plus any associated interface definition files, plus the scripts used to control compilation and installation of the library.

Activities other than copying, distribution and modification are not covered by this License; they are outside its scope. The act of running a program using the Library is not restricted, and output from such a program is covered only if its contents constitute a work based on the Library (independent of the use of the Library in a tool for writing it). Whether that is true depends on what the Library does and what the program that uses the Library does.

1. You may copy and distribute verbatim copies of the Library's complete source code as you receive it, in any medium, provided that you conspicuously and appropriately publish on each copy an appropriate copyright notice and disclaimer of warranty; keep intact all the notices that refer to this License and to the absence of any warranty; and distribute a copy of this License along with the Library.

You may charge a fee for the physical act of transferring a copy, and you may at your option offer warranty protection in exchange for a fee.

2. You may modify your copy or copies of the Library or any portion of it, thus forming a work based on the Library, and copy and distribute such modifications or work under the terms of Section 1 above, provided that you also meet all of these conditions:

    a) The modified work must itself be a software library.
    b) You must cause the files modified to carry prominent notices stating that you changed the files and the date of any change.
    c) You must cause the whole of the work to be licensed at no charge to all third parties under the terms of this License.
    d) If a facility in the modified Library refers to a function or a table of data to be supplied by an application program that uses the facility, other than as an argument passed when the facility is invoked, then you must make a good faith effort to ensure that, in the event an application does not supply such function or table, the facility still operates, and performs whatever part of its purpose remains meaningful.

    (For example, a function in a library to compute square roots has a purpose that is entirely well-defined independent of the application. Therefore, Subsection 2d requires that any application-supplied function or table used by this function must be optional: if the application does not supply it, the square root function must still compute square roots.)

These requirements apply to the modified work as a whole. If identifiable sections of that work are not derived from the Library, and can be reasonably considered independent and separate works in themselves, then this License, and its terms, do not apply to those sections when you distribute them as separate works. But when you distribute the same sections as part of a whole which is a work based on the Library, the distribution of the whole must be on the terms of this License, whose permissions for other licensees extend to the entire whole, and thus to each and every part regardless of who wrote it.

Thus, it is not the intent of this section to claim rights or contest your rights to work written entirely by you; rather, the intent is to exercise the right to control the distribution of derivative or collective works based on the Library.

In addition, mere aggregation of another work not based on the Library with the Library (or with a work based on the Library) on a volume of a storage or distribution medium does not bring the other work under the scope of this License.

3. You may opt to apply the terms of the ordinary GNU General Public License instead of this License to a given copy of the Library. To do this, you must alter all the notices that refer to this License, so that they refer to the ordinary GNU General Public License, version 2, instead of to this License. (If a newer version than version 2 of the ordinary GNU General Public License has appeared, then you can specify that version instead if you wish.) Do not make any other change in these notices.

Once this change is made in a given copy, it is irreversible for that copy, so the ordinary GNU General Public License applies to all subsequent copies and derivative works made from that copy.

This option is useful when you wish to copy part of the code of the Library into a program that is not a library.

4. You may copy and distribute the Library (or a portion or derivative of it, under Section 2) in object code or executable form under the terms of Sections 1 and 2 above provided that you accompany it with the complete corresponding machine-readable source code, which must be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange.

If distribution of object code is made by offering access to copy from a designated place, then offering equivalent access to copy the source code from the same place satisfies the requirement to distribute the source code, even though third parties are not compelled to copy the source along with the object code.

5. A program that contains no derivative of any portion of the Library, but is designed to work with the Library by being compiled or linked with it, is called a "work that uses the Library". Such a work, in isolation, is not a derivative work of the Library, and therefore falls outside the scope of this License.

However, linking a "work that uses the Library" with the Library creates an executable that is a derivative of the Library (because it contains portions of the Library), rather than a "work that uses the library". The executable is therefore covered by this License. Section 6 states terms for distribution of such executables.

When a "work that uses the Library" uses material from a header file that is part of the Library, the object code for the work may be a derivative work of the Library even though the source code is not. Whether this is true is especially significant if the work can be linked without the Library, or if the work is itself a library. The threshold for this to be true is not precisely defined by law.

If such an object file uses only numerical parameters, data structure layouts and accessors, and small macros and small inline functions (ten lines or less in length), then the use of the object file is unrestricted, regardless of whether it is legally a derivative work. (Executables containing this object code plus portions of the Library will still fall under Section 6.)

Otherwise, if the work is a derivative of the Library, you may distribute the object code for the work under the terms of Section 6. Any executables containing that work also fall under Section 6, whether or not they are linked directly with the Library itself.

6. As an exception to the Sections above, you may also combine or link a "work that uses the Library" with the Library to produce a work containing portions of the Library, and distribute that work under terms of your choice, provided that the terms permit modification of the work for the customer's own use and reverse engineering for debugging such modifications.

You must give prominent notice with each copy of the work that the Library is used in it and that the Library and its use are covered by this License. You must supply a copy of this License. If the work during execution displays copyright notices, you must include the copyright notice for the Library among them, as well as a reference directing the user to the copy of this License. Also, you must do one of these things:

    a) Accompany the work with the complete corresponding machine-readable source code for the Library including whatever changes were used in the work (which must be distributed under Sections 1 and 2 above); and, if the work is an executable linked with the Library, with the complete machine-readable "work that uses the Library", as object code and/or source code, so that the user can modify the Library and then relink to produce a modified executable containing the modified Library. (It is understood that the user who changes the contents of definitions files in the Library will not necessarily be able to recompile the application to use the modified definitions.)
    b) Use a suitable shared library mechanism for linking with the Library. A suitable mechanism is one that (1) uses at run time a copy of the library already present on the user's computer system, rather than copying library functions into the executable, and (2) will operate properly with a modified version of the library, if the user installs one, as long as the modified version is interface-compatible with the version that the work was made with.
    c) Accompany the work with a written offer, valid for at least three years, to give the same user the materials specified in Subsection 6a, above, for a charge no more than the cost of performing this distribution.
    d) If distribution of the work is made by offering access to copy from a designated place, offer equivalent access to copy the above specified materials from the same place.
    e) Verify that the user has already received a copy of these materials or that you have already sent this user a copy.

For an executable, the required form of the "work that uses the Library" must include any data and utility programs needed for reproducing the executable from it. However, as a special exception, the materials to be distributed need not include anything that is normally distributed (in either source or binary form) with the major components (compiler, kernel, and so on) of the operating system on which the executable runs, unless that component itself accompanies the executable.

It may happen that this requirement contradicts the license restrictions of other proprietary libraries that do not normally accompany the operating system. Such a contradiction means you cannot use both them and the Library together in an executable that you distribute.

7. You may place library facilities that are a work based on the Library side-by-side in a single library together with other library facilities not covered by this License, and distribute such a combined library, provided that the separate distribution of the work based on the Library and of the other library facilities is otherwise permitted, and provided that you do these two things:

    a) Accompany the combined library with a copy of the same work based on the Library, uncombined with any other library facilities. This must be distributed under the terms of the Sections above.
    b) Give prominent notice with the combined library of the fact that part of it is a work based on the Library, and explaining where to find the accompanying uncombined form of the same work.

8. You may not copy, modify, sublicense, link with, or distribute the Library except as expressly provided under this License. Any attempt otherwise to copy, modify, sublicense, link with, or distribute the Library is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance.

9. You are not required to accept this License, since you have not signed it. However, nothing else grants you permission to modify or distribute the Library or its derivative works. These actions are prohibited by law if you do not accept this License. Therefore, by modifying or distributing the Library (or any work based on the Library), you indicate your acceptance of this License to do so, and all its terms and conditions for copying, distributing or modifying the Library or works based on it.

10. Each time you redistribute the Library (or any work based on the Library), the recipient automatically receives a license from the original licensor to copy, distribute, link with or modify the Library subject to these terms and conditions. You may not impose any further restrictions on the recipients' exercise of the rights granted herein. You are not responsible for enforcing compliance by third parties with this License.

11. If, as a consequence of a court judgment or allegation of patent infringement or for any other reason (not limited to patent issues), conditions are imposed on you (whether by court order, agreement or otherwise) that contradict the conditions of this License, they do not excuse you from the conditions of this License. If you cannot distribute so as to satisfy simultaneously your obligations under this License and any other pertinent obligations, then as a consequence you may not distribute the Library at all. For example, if a patent license would not permit royalty-free redistribution of the Library by all those who receive copies directly or indirectly through you, then the only way you could satisfy both it and this License would be to refrain entirely from distribution of the Library.

If any portion of this section is held invalid or unenforceable under any particular circumstance, the balance of the section is intended to apply, and the section as a whole is intended to apply in other circumstances.

It is not the purpose of this section to induce you to infringe any patents or other property right claims or to contest validity of any such claims; this section has the sole purpose of protecting the integrity of the free software distribution system which is implemented by public license practices. Many people have made generous contributions to the wide range of software distributed through that system in reliance on consistent application of that system; it is up to the author/donor to decide if he or she is willing to distribute software through any other system and a licensee cannot impose that choice.

This section is intended to make thoroughly clear what is believed to be a consequence of the rest of this License.

12. If the distribution and/or use of the Library is restricted in certain countries either by patents or by copyrighted interfaces, the original copyright holder who places the Library under this License may add an explicit geographical distribution limitation excluding those countries, so that distribution is permitted only in or among countries not thus excluded. In such case, this License incorporates the limitation as if written in the body of this License.

13. The Free Software Foundation may publish revised and/or new versions of the Lesser General Public License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.

Each version is given a distinguishing version number. If the Library specifies a version number of this License which applies to it and "any later version", you have the option of following the terms and conditions either of that version or of any later version published by the Free Software Foundation. If the Library does not specify a license version number, you may choose any version ever published by the Free Software Foundation.

14. If you wish to incorporate parts of the Library into other free programs whose distribution conditions are incompatible with these, write to the author to ask for permission. For software which is copyrighted by the Free Software Foundation, write to the Free Software Foundation; we sometimes make exceptions for this. Our decision will be guided by the two goals of preserving the free status of all derivatives of our free software and of promoting the sharing and reuse of software generally.

NO WARRANTY

15. BECAUSE THE LIBRARY IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE LIBRARY, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE LIBRARY "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE LIBRARY IS WITH YOU. SHOULD THE LIBRARY PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

16. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE LIBRARY AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE LIBRARY (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE LIBRARY TO OPERATE WITH ANY OTHER SOFTWARE), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
END OF TERMS AND CONDITIONS
How to Apply These Terms to Your New Libraries

If you develop a new library, and you want it to be of the greatest possible use to the public, we recommend making it free software that everyone can redistribute and change. You can do so by permitting redistribution under these terms (or, alternatively, under the terms of the ordinary General Public License).

To apply these terms, attach the following notices to the library. It is safest to attach them to the start of each source file to most effectively convey the exclusion of warranty; and each file should have at least the "copyright" line and a pointer to where the full notice is found.

one line to give the library's name and an idea of what it does.
Copyright (C) year  name of author

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA

Also add information on how to contact you by electronic and paper mail.

You should also get your employer (if you work as a programmer) or your school, if any, to sign a "copyright disclaimer" for the library, if necessary. Here is a sample; alter the names:

Yoyodyne, Inc., hereby disclaims all copyright interest in
the library `Frob' (a library for tweaking knobs) written
by James Random Hacker.

signature of Ty Coon, 1 April 1990
Ty Coon, President of Vice</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_ide.wiki_license.asciidoc_gnu-lesser-general-public-license---version-3">GNU LESSER GENERAL PUBLIC LICENSE - Version 3</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Version 3, 29 June 2007

Copyright © 2007 Free Software Foundation, Inc. &lt;https://fsf.org/&gt;

Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed.

This version of the GNU Lesser General Public License incorporates the terms and conditions of version 3 of the GNU General Public License, supplemented by the additional permissions listed below.
0. Additional Definitions.

As used herein, “this License” refers to version 3 of the GNU Lesser General Public License, and the “GNU GPL” refers to version 3 of the GNU General Public License.

“The Library” refers to a covered work governed by this License, other than an Application or a Combined Work as defined below.

An “Application” is any work that makes use of an interface provided by the Library, but which is not otherwise based on the Library. Defining a subclass of a class defined by the Library is deemed a mode of using an interface provided by the Library.

A “Combined Work” is a work produced by combining or linking an Application with the Library. The particular version of the Library with which the Combined Work was made is also called the “Linked Version”.

The “Minimal Corresponding Source” for a Combined Work means the Corresponding Source for the Combined Work, excluding any source code for portions of the Combined Work that, considered in isolation, are based on the Application, and not on the Linked Version.

The “Corresponding Application Code” for a Combined Work means the object code and/or source code for the Application, including any data and utility programs needed for reproducing the Combined Work from the Application, but excluding the System Libraries of the Combined Work.
1. Exception to Section 3 of the GNU GPL.

You may convey a covered work under sections 3 and 4 of this License without being bound by section 3 of the GNU GPL.
2. Conveying Modified Versions.

If you modify a copy of the Library, and, in your modifications, a facility refers to a function or data to be supplied by an Application that uses the facility (other than as an argument passed when the facility is invoked), then you may convey a copy of the modified version:

    a) under this License, provided that you make a good faith effort to ensure that, in the event an Application does not supply the function or data, the facility still operates, and performs whatever part of its purpose remains meaningful, or
    b) under the GNU GPL, with none of the additional permissions of this License applicable to that copy.

3. Object Code Incorporating Material from Library Header Files.

The object code form of an Application may incorporate material from a header file that is part of the Library. You may convey such object code under terms of your choice, provided that, if the incorporated material is not limited to numerical parameters, data structure layouts and accessors, or small macros, inline functions and templates (ten or fewer lines in length), you do both of the following:

    a) Give prominent notice with each copy of the object code that the Library is used in it and that the Library and its use are covered by this License.
    b) Accompany the object code with a copy of the GNU GPL and this license document.

4. Combined Works.

You may convey a Combined Work under terms of your choice that, taken together, effectively do not restrict modification of the portions of the Library contained in the Combined Work and reverse engineering for debugging such modifications, if you also do each of the following:

    a) Give prominent notice with each copy of the Combined Work that the Library is used in it and that the Library and its use are covered by this License.
    b) Accompany the Combined Work with a copy of the GNU GPL and this license document.
    c) For a Combined Work that displays copyright notices during execution, include the copyright notice for the Library among these notices, as well as a reference directing the user to the copies of the GNU GPL and this license document.
    d) Do one of the following:
        0) Convey the Minimal Corresponding Source under the terms of this License, and the Corresponding Application Code in a form suitable for, and under terms that permit, the user to recombine or relink the Application with a modified version of the Linked Version to produce a modified Combined Work, in the manner specified by section 6 of the GNU GPL for conveying Corresponding Source.
        1) Use a suitable shared library mechanism for linking with the Library. A suitable mechanism is one that (a) uses at run time a copy of the Library already present on the user's computer system, and (b) will operate properly with a modified version of the Library that is interface-compatible with the Linked Version.
    e) Provide Installation Information, but only if you would otherwise be required to provide such information under section 6 of the GNU GPL, and only to the extent that such information is necessary to install and execute a modified version of the Combined Work produced by recombining or relinking the Application with a modified version of the Linked Version. (If you use option 4d0, the Installation Information must accompany the Minimal Corresponding Source and Corresponding Application Code. If you use option 4d1, you must provide the Installation Information in the manner specified by section 6 of the GNU GPL for conveying Corresponding Source.)

5. Combined Libraries.

You may place library facilities that are a work based on the Library side by side in a single library together with other library facilities that are not Applications and are not covered by this License, and convey such a combined library under terms of your choice, if you do both of the following:

    a) Accompany the combined library with a copy of the same work based on the Library, uncombined with any other library facilities, conveyed under the terms of this License.
    b) Give prominent notice with the combined library that part of it is a work based on the Library, and explaining where to find the accompanying uncombined form of the same work.

6. Revised Versions of the GNU Lesser General Public License.

The Free Software Foundation may publish revised and/or new versions of the GNU Lesser General Public License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.

Each version is given a distinguishing version number. If the Library as you received it specifies that a certain numbered version of the GNU Lesser General Public License “or any later version” applies to it, you have the option of following the terms and conditions either of that published version or of any later version published by the Free Software Foundation. If the Library as you received it does not specify a version number of the GNU Lesser General Public License, you may choose any version of the GNU Lesser General Public License ever published by the Free Software Foundation.

If the Library as you received it specifies that a proxy can decide whether future versions of the GNU Lesser General Public License shall apply, that proxy's public statement of acceptance of any version is permanent authorization for you to choose that version for the Library.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_ide.wiki_license.asciidoc_gnu-general-public-license---version-2">GNU GENERAL PUBLIC LICENSE - Version 2</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code> Version 2, June 1991

Copyright (C) 1989, 1991 Free Software Foundation, Inc.
51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.

Preamble

The licenses for most software are designed to take away your freedom to share and change it. By contrast, the GNU General Public License is intended to guarantee your freedom to share and change free software--to make sure the software is free for all its users. This General Public License applies to most of the Free Software Foundation's software and to any other program whose authors commit to using it. (Some other Free Software Foundation software is covered by the GNU Lesser General Public License instead.) You can apply it to your programs, too.

When we speak of free software, we are referring to freedom, not price. Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for this service if you wish), that you receive source code or can get it if you want it, that you can change the software or use pieces of it in new free programs; and that you know you can do these things.

To protect your rights, we need to make restrictions that forbid anyone to deny you these rights or to ask you to surrender the rights. These restrictions translate to certain responsibilities for you if you distribute copies of the software, or if you modify it.

For example, if you distribute copies of such a program, whether gratis or for a fee, you must give the recipients all the rights that you have. You must make sure that they, too, receive or can get the source code. And you must show them these terms so they know their rights.

We protect your rights with two steps: (1) copyright the software, and (2) offer you this license which gives you legal permission to copy, distribute and/or modify the software.

Also, for each author's protection and ours, we want to make certain that everyone understands that there is no warranty for this free software. If the software is modified by someone else and passed on, we want its recipients to know that what they have is not the original, so that any problems introduced by others will not reflect on the original authors' reputations.

Finally, any free program is threatened constantly by software patents. We wish to avoid the danger that redistributors of a free program will individually obtain patent licenses, in effect making the program proprietary. To prevent this, we have made it clear that any patent must be licensed for everyone's free use or not licensed at all.

The precise terms and conditions for copying, distribution and modification follow.
TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

0. This License applies to any program or other work which contains a notice placed by the copyright holder saying it may be distributed under the terms of this General Public License. The "Program", below, refers to any such program or work, and a "work based on the Program" means either the Program or any derivative work under copyright law: that is to say, a work containing the Program or a portion of it, either verbatim or with modifications and/or translated into another language. (Hereinafter, translation is included without limitation in the term "modification".) Each licensee is addressed as "you".

Activities other than copying, distribution and modification are not covered by this License; they are outside its scope. The act of running the Program is not restricted, and the output from the Program is covered only if its contents constitute a work based on the Program (independent of having been made by running the Program). Whether that is true depends on what the Program does.

1. You may copy and distribute verbatim copies of the Program's source code as you receive it, in any medium, provided that you conspicuously and appropriately publish on each copy an appropriate copyright notice and disclaimer of warranty; keep intact all the notices that refer to this License and to the absence of any warranty; and give any other recipients of the Program a copy of this License along with the Program.

You may charge a fee for the physical act of transferring a copy, and you may at your option offer warranty protection in exchange for a fee.

2. You may modify your copy or copies of the Program or any portion of it, thus forming a work based on the Program, and copy and distribute such modifications or work under the terms of Section 1 above, provided that you also meet all of these conditions:

    a) You must cause the modified files to carry prominent notices stating that you changed the files and the date of any change.
    b) You must cause any work that you distribute or publish, that in whole or in part contains or is derived from the Program or any part thereof, to be licensed as a whole at no charge to all third parties under the terms of this License.
    c) If the modified program normally reads commands interactively when run, you must cause it, when started running for such interactive use in the most ordinary way, to print or display an announcement including an appropriate copyright notice and a notice that there is no warranty (or else, saying that you provide a warranty) and that users may redistribute the program under these conditions, and telling the user how to view a copy of this License. (Exception: if the Program itself is interactive but does not normally print such an announcement, your work based on the Program is not required to print an announcement.)

These requirements apply to the modified work as a whole. If identifiable sections of that work are not derived from the Program, and can be reasonably considered independent and separate works in themselves, then this License, and its terms, do not apply to those sections when you distribute them as separate works. But when you distribute the same sections as part of a whole which is a work based on the Program, the distribution of the whole must be on the terms of this License, whose permissions for other licensees extend to the entire whole, and thus to each and every part regardless of who wrote it.

Thus, it is not the intent of this section to claim rights or contest your rights to work written entirely by you; rather, the intent is to exercise the right to control the distribution of derivative or collective works based on the Program.

In addition, mere aggregation of another work not based on the Program with the Program (or with a work based on the Program) on a volume of a storage or distribution medium does not bring the other work under the scope of this License.

3. You may copy and distribute the Program (or a work based on it, under Section 2) in object code or executable form under the terms of Sections 1 and 2 above provided that you also do one of the following:

    a) Accompany it with the complete corresponding machine-readable source code, which must be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange; or,
    b) Accompany it with a written offer, valid for at least three years, to give any third party, for a charge no more than your cost of physically performing source distribution, a complete machine-readable copy of the corresponding source code, to be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange; or,
    c) Accompany it with the information you received as to the offer to distribute corresponding source code. (This alternative is allowed only for noncommercial distribution and only if you received the program in object code or executable form with such an offer, in accord with Subsection b above.)

The source code for a work means the preferred form of the work for making modifications to it. For an executable work, complete source code means all the source code for all modules it contains, plus any associated interface definition files, plus the scripts used to control compilation and installation of the executable. However, as a special exception, the source code distributed need not include anything that is normally distributed (in either source or binary form) with the major components (compiler, kernel, and so on) of the operating system on which the executable runs, unless that component itself accompanies the executable.

If distribution of executable or object code is made by offering access to copy from a designated place, then offering equivalent access to copy the source code from the same place counts as distribution of the source code, even though third parties are not compelled to copy the source along with the object code.

4. You may not copy, modify, sublicense, or distribute the Program except as expressly provided under this License. Any attempt otherwise to copy, modify, sublicense or distribute the Program is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance.

5. You are not required to accept this License, since you have not signed it. However, nothing else grants you permission to modify or distribute the Program or its derivative works. These actions are prohibited by law if you do not accept this License. Therefore, by modifying or distributing the Program (or any work based on the Program), you indicate your acceptance of this License to do so, and all its terms and conditions for copying, distributing or modifying the Program or works based on it.

6. Each time you redistribute the Program (or any work based on the Program), the recipient automatically receives a license from the original licensor to copy, distribute or modify the Program subject to these terms and conditions. You may not impose any further restrictions on the recipients' exercise of the rights granted herein. You are not responsible for enforcing compliance by third parties to this License.

7. If, as a consequence of a court judgment or allegation of patent infringement or for any other reason (not limited to patent issues), conditions are imposed on you (whether by court order, agreement or otherwise) that contradict the conditions of this License, they do not excuse you from the conditions of this License. If you cannot distribute so as to satisfy simultaneously your obligations under this License and any other pertinent obligations, then as a consequence you may not distribute the Program at all. For example, if a patent license would not permit royalty-free redistribution of the Program by all those who receive copies directly or indirectly through you, then the only way you could satisfy both it and this License would be to refrain entirely from distribution of the Program.

If any portion of this section is held invalid or unenforceable under any particular circumstance, the balance of the section is intended to apply and the section as a whole is intended to apply in other circumstances.

It is not the purpose of this section to induce you to infringe any patents or other property right claims or to contest validity of any such claims; this section has the sole purpose of protecting the integrity of the free software distribution system, which is implemented by public license practices. Many people have made generous contributions to the wide range of software distributed through that system in reliance on consistent application of that system; it is up to the author/donor to decide if he or she is willing to distribute software through any other system and a licensee cannot impose that choice.

This section is intended to make thoroughly clear what is believed to be a consequence of the rest of this License.

8. If the distribution and/or use of the Program is restricted in certain countries either by patents or by copyrighted interfaces, the original copyright holder who places the Program under this License may add an explicit geographical distribution limitation excluding those countries, so that distribution is permitted only in or among countries not thus excluded. In such case, this License incorporates the limitation as if written in the body of this License.

9. The Free Software Foundation may publish revised and/or new versions of the General Public License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.

Each version is given a distinguishing version number. If the Program specifies a version number of this License which applies to it and "any later version", you have the option of following the terms and conditions either of that version or of any later version published by the Free Software Foundation. If the Program does not specify a version number of this License, you may choose any version ever published by the Free Software Foundation.

10. If you wish to incorporate parts of the Program into other free programs whose distribution conditions are different, write to the author to ask for permission. For software which is copyrighted by the Free Software Foundation, write to the Free Software Foundation; we sometimes make exceptions for this. Our decision will be guided by the two goals of preserving the free status of all derivatives of our free software and of promoting the sharing and reuse of software generally.

NO WARRANTY

11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
END OF TERMS AND CONDITIONS
How to Apply These Terms to Your New Programs

If you develop a new program, and you want it to be of the greatest possible use to the public, the best way to achieve this is to make it free software which everyone can redistribute and change under these terms.

To do so, attach the following notices to the program. It is safest to attach them to the start of each source file to most effectively convey the exclusion of warranty; and each file should have at least the "copyright" line and a pointer to where the full notice is found.

one line to give the program's name and an idea of what it does.
Copyright (C) yyyy  name of author

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.

Also add information on how to contact you by electronic and paper mail.

If the program is interactive, make it output a short notice like this when it starts in an interactive mode:

Gnomovision version 69, Copyright (C) year name of author
Gnomovision comes with ABSOLUTELY NO WARRANTY; for details
type `show w'.  This is free software, and you are welcome
to redistribute it under certain conditions; type `show c'
for details.

The hypothetical commands `show w' and `show c' should show the appropriate parts of the General Public License. Of course, the commands you use may be called something other than `show w' and `show c'; they could even be mouse-clicks or menu items--whatever suits your program.

You should also get your employer (if you work as a programmer) or your school, if any, to sign a "copyright disclaimer" for the program, if necessary. Here is a sample; alter the names:

Yoyodyne, Inc., hereby disclaims all copyright
interest in the program `Gnomovision'
(which makes passes at compilers) written
by James Hacker.

signature of Ty Coon, 1 April 1989
Ty Coon, President of Vice</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_ide.wiki_license.asciidoc_classpath-exception-to-the-gpl">"CLASSPATH" EXCEPTION TO THE GPL</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Certain source files distributed by Oracle America and/or its affiliates
are subject to the following clarification and special exception to the GPLv2,
based on the GNU Project exception for its Classpath libraries, known as the
GNU Classpath Exception, but only where Oracle has expressly included in the
particular source file's header the words "Oracle designates this particular
file as subject to the "Classpath" exception as provided by Oracle in the
LICENSE file that accompanied this code."

You should also note that Oracle includes multiple, independent programs in
this software package. Some of those programs are provided under licenses
deemed incompatible with the GPLv2 by the Free Software Foundation and others.
For example, the package includes programs licensed under the Apache License,
Version 2.0. Such programs are licensed to you under their original licenses.

Oracle facilitates your further distribution of this package by adding the
Classpath Exception to the necessary parts of its GPLv2 code, which permits you
to use that code in combination with other independent modules not licensed
under the GPLv2. However, note that this would not permit you to commingle code
under an incompatible license with Oracle's GPLv2 licensed code by, for
example, cutting and pasting such code into a file also containing Oracle's
GPLv2 licensed code and then distributing the result.

Additionally, if you were to remove the Classpath Exception from any of the
files to which it applies and distribute the result, you would likely be
required to license some or all of the other code in that distribution under
the GPLv2 as well, and since the GPLv2 is incompatible with the license terms
of some items included in the distribution by Oracle, removing the Classpath
Exception could therefore effectively compromise your ability to further
distribute the package.

Proceed with caution and we recommend that you obtain the advice of a lawyer
skilled in open source matters before removing the Classpath Exception or
making modifications to this package which may subsequently be redistributed
and/or involve the use of third party software.

CLASSPATH EXCEPTION

Linking this library statically or dynamically with other modules is making a
combined work based on this library. Thus, the terms and conditions of the GNU
General Public License version 2 cover the whole combination.

As a special exception, the copyright holders of this library give you
permission to link this library with independent modules to produce an
executable, regardless of the license terms of these independent modules, and
to copy and distribute the resulting executable under terms of your choice,
provided that you also meet, for each linked independent module, the terms and
conditions of the license of that module. An independent module is a module
which is not derived from or based on this library. If you modify this library,
you may extend this exception to your version of the library, but you are not
obligated to do so. If you do not wish to do so, delete this exception
statement from your version.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_ide.wiki_license.asciidoc_do-what-the-fuck-you-want-to-public-license---version-2">DO WHAT THE FUCK YOU WANT TO PUBLIC LICENSE - Version 2</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>            DO WHAT THE FUCK YOU WANT TO PUBLIC LICENSE
                    Version 2, December 2004

 Copyright (C) 2004 Sam Hocevar
  14 rue de Plaisance, 75014 Paris, France
 Everyone is permitted to copy and distribute verbatim or modified
 copies of this license document, and changing it is allowed as long
 as the name is changed.

            DO WHAT THE FUCK YOU WANT TO PUBLIC LICENSE
   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

  0. You just DO WHAT THE FUCK YOU WANT TO.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_ide.wiki_license.asciidoc_license-of-node.js">License of Node.js</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Node.js is licensed for use as follows:

"""
Copyright Node.js contributors. All rights reserved.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.
"""

This license applies to parts of Node.js originating from the
https://github.com/joyent/node repository:

"""
Copyright Joyent, Inc. and other Node contributors. All rights reserved.
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.
"""

The Node.js license applies to all parts of Node.js that are not externally
maintained libraries.

The externally maintained libraries used by Node.js are:

- Acorn, located at deps/acorn, is licensed as follows:
  """
    Copyright (C) 2012-2018 by various contributors (see AUTHORS)

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE.
  """

- Acorn plugins, located at deps/acorn-plugins, is licensed as follows:
  """
    Copyright (C) 2017-2018 by Adrian Heine

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE.
  """

- c-ares, located at deps/cares, is licensed as follows:
  """
    Copyright (c) 2007 - 2018, Daniel Stenberg with many contributors, see AUTHORS
    file.

    Copyright 1998 by the Massachusetts Institute of Technology.

    Permission to use, copy, modify, and distribute this software and its
    documentation for any purpose and without fee is hereby granted, provided that
    the above copyright notice appear in all copies and that both that copyright
    notice and this permission notice appear in supporting documentation, and that
    the name of M.I.T. not be used in advertising or publicity pertaining to
    distribution of the software without specific, written prior permission.
    M.I.T. makes no representations about the suitability of this software for any
    purpose.  It is provided "as is" without express or implied warranty.
  """

- ICU, located at deps/icu-small, is licensed as follows:
  """
    COPYRIGHT AND PERMISSION NOTICE (ICU 58 and later)

    Copyright © 1991-2019 Unicode, Inc. All rights reserved.
    Distributed under the Terms of Use in https://www.unicode.org/copyright.html.

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of the Unicode data files and any associated documentation
    (the "Data Files") or Unicode software and any associated documentation
    (the "Software") to deal in the Data Files or Software
    without restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, and/or sell copies of
    the Data Files or Software, and to permit persons to whom the Data Files
    or Software are furnished to do so, provided that either
    (a) this copyright and permission notice appear with all copies
    of the Data Files or Software, or
    (b) this copyright and permission notice appear in associated
    Documentation.

    THE DATA FILES AND SOFTWARE ARE PROVIDED "AS IS", WITHOUT WARRANTY OF
    ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
    WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT OF THIRD PARTY RIGHTS.
    IN NO EVENT SHALL THE COPYRIGHT HOLDER OR HOLDERS INCLUDED IN THIS
    NOTICE BE LIABLE FOR ANY CLAIM, OR ANY SPECIAL INDIRECT OR CONSEQUENTIAL
    DAMAGES, OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE,
    DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
    TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THE DATA FILES OR SOFTWARE.

    Except as contained in this notice, the name of a copyright holder
    shall not be used in advertising or otherwise to promote the sale,
    use or other dealings in these Data Files or Software without prior
    written authorization of the copyright holder.

    ---------------------

    Third-Party Software Licenses

    This section contains third-party software notices and/or additional
    terms for licensed third-party software components included within ICU
    libraries.

    1. ICU License - ICU 1.8.1 to ICU 57.1

    COPYRIGHT AND PERMISSION NOTICE

    Copyright (c) 1995-2016 International Business Machines Corporation and others
    All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, and/or sell copies of the Software, and to permit persons
    to whom the Software is furnished to do so, provided that the above
    copyright notice(s) and this permission notice appear in all copies of
    the Software and that both the above copyright notice(s) and this
    permission notice appear in supporting documentation.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
    OF THIRD PARTY RIGHTS. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR
    HOLDERS INCLUDED IN THIS NOTICE BE LIABLE FOR ANY CLAIM, OR ANY
    SPECIAL INDIRECT OR CONSEQUENTIAL DAMAGES, OR ANY DAMAGES WHATSOEVER
    RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF
    CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
    CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

    Except as contained in this notice, the name of a copyright holder
    shall not be used in advertising or otherwise to promote the sale, use
    or other dealings in this Software without prior written authorization
    of the copyright holder.

    All trademarks and registered trademarks mentioned herein are the
    property of their respective owners.

    2. Chinese/Japanese Word Break Dictionary Data (cjdict.txt)

     #     The Google Chrome software developed by Google is licensed under
     # the BSD license. Other software included in this distribution is
     # provided under other licenses, as set forth below.
     #
     #  The BSD License
     #  http://opensource.org/licenses/bsd-license.php
     #  Copyright (C) 2006-2008, Google Inc.
     #
     #  All rights reserved.
     #
     #  Redistribution and use in source and binary forms, with or without
     # modification, are permitted provided that the following conditions are met:
     #
     #  Redistributions of source code must retain the above copyright notice,
     # this list of conditions and the following disclaimer.
     #  Redistributions in binary form must reproduce the above
     # copyright notice, this list of conditions and the following
     # disclaimer in the documentation and/or other materials provided with
     # the distribution.
     #  Neither the name of  Google Inc. nor the names of its
     # contributors may be used to endorse or promote products derived from
     # this software without specific prior written permission.
     #
     #
     #  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND
     # CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
     # INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
     # MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
     # DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
     # LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
     # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
     # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
     # BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
     # LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
     # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
     # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
     #
     #
     #  The word list in cjdict.txt are generated by combining three word lists
     # listed below with further processing for compound word breaking. The
     # frequency is generated with an iterative training against Google web
     # corpora.
     #
     #  * Libtabe (Chinese)
     #    - https://sourceforge.net/project/?group_id=1519
     #    - Its license terms and conditions are shown below.
     #
     #  * IPADIC (Japanese)
     #    - http://chasen.aist-nara.ac.jp/chasen/distribution.html
     #    - Its license terms and conditions are shown below.
     #
     #  ---------COPYING.libtabe ---- BEGIN--------------------
     #
     #  /*
     #   * Copyright (c) 1999 TaBE Project.
     #   * Copyright (c) 1999 Pai-Hsiang Hsiao.
     #   * All rights reserved.
     #   *
     #   * Redistribution and use in source and binary forms, with or without
     #   * modification, are permitted provided that the following conditions
     #   * are met:
     #   *
     #   * . Redistributions of source code must retain the above copyright
     #   *   notice, this list of conditions and the following disclaimer.
     #   * . Redistributions in binary form must reproduce the above copyright
     #   *   notice, this list of conditions and the following disclaimer in
     #   *   the documentation and/or other materials provided with the
     #   *   distribution.
     #   * . Neither the name of the TaBE Project nor the names of its
     #   *   contributors may be used to endorse or promote products derived
     #   *   from this software without specific prior written permission.
     #   *
     #   * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
     #   * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
     #   * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
     #   * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
     #   * REGENTS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
     #   * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
     #   * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
     #   * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
     #   * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
     #   * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
     #   * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
     #   * OF THE POSSIBILITY OF SUCH DAMAGE.
     #   */
     #
     #  /*
     #   * Copyright (c) 1999 Computer Systems and Communication Lab,
     #   *                    Institute of Information Science, Academia
     #       *                    Sinica. All rights reserved.
     #   *
     #   * Redistribution and use in source and binary forms, with or without
     #   * modification, are permitted provided that the following conditions
     #   * are met:
     #   *
     #   * . Redistributions of source code must retain the above copyright
     #   *   notice, this list of conditions and the following disclaimer.
     #   * . Redistributions in binary form must reproduce the above copyright
     #   *   notice, this list of conditions and the following disclaimer in
     #   *   the documentation and/or other materials provided with the
     #   *   distribution.
     #   * . Neither the name of the Computer Systems and Communication Lab
     #   *   nor the names of its contributors may be used to endorse or
     #   *   promote products derived from this software without specific
     #   *   prior written permission.
     #   *
     #   * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
     #   * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
     #   * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
     #   * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
     #   * REGENTS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
     #   * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
     #   * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
     #   * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
     #   * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
     #   * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
     #   * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
     #   * OF THE POSSIBILITY OF SUCH DAMAGE.
     #   */
     #
     #  Copyright 1996 Chih-Hao Tsai @ Beckman Institute,
     #      University of Illinois
     #  c-tsai4@uiuc.edu  http://casper.beckman.uiuc.edu/~c-tsai4
     #
     #  ---------------COPYING.libtabe-----END--------------------------------
     #
     #
     #  ---------------COPYING.ipadic-----BEGIN-------------------------------
     #
     #  Copyright 2000, 2001, 2002, 2003 Nara Institute of Science
     #  and Technology.  All Rights Reserved.
     #
     #  Use, reproduction, and distribution of this software is permitted.
     #  Any copy of this software, whether in its original form or modified,
     #  must include both the above copyright notice and the following
     #  paragraphs.
     #
     #  Nara Institute of Science and Technology (NAIST),
     #  the copyright holders, disclaims all warranties with regard to this
     #  software, including all implied warranties of merchantability and
     #  fitness, in no event shall NAIST be liable for
     #  any special, indirect or consequential damages or any damages
     #  whatsoever resulting from loss of use, data or profits, whether in an
     #  action of contract, negligence or other tortuous action, arising out
     #  of or in connection with the use or performance of this software.
     #
     #  A large portion of the dictionary entries
     #  originate from ICOT Free Software.  The following conditions for ICOT
     #  Free Software applies to the current dictionary as well.
     #
     #  Each User may also freely distribute the Program, whether in its
     #  original form or modified, to any third party or parties, PROVIDED
     #  that the provisions of Section 3 ("NO WARRANTY") will ALWAYS appear
     #  on, or be attached to, the Program, which is distributed substantially
     #  in the same form as set out herein and that such intended
     #  distribution, if actually made, will neither violate or otherwise
     #  contravene any of the laws and regulations of the countries having
     #  jurisdiction over the User or the intended distribution itself.
     #
     #  NO WARRANTY
     #
     #  The program was produced on an experimental basis in the course of the
     #  research and development conducted during the project and is provided
     #  to users as so produced on an experimental basis.  Accordingly, the
     #  program is provided without any warranty whatsoever, whether express,
     #  implied, statutory or otherwise.  The term "warranty" used herein
     #  includes, but is not limited to, any warranty of the quality,
     #  performance, merchantability and fitness for a particular purpose of
     #  the program and the nonexistence of any infringement or violation of
     #  any right of any third party.
     #
     #  Each user of the program will agree and understand, and be deemed to
     #  have agreed and understood, that there is no warranty whatsoever for
     #  the program and, accordingly, the entire risk arising from or
     #  otherwise connected with the program is assumed by the user.
     #
     #  Therefore, neither ICOT, the copyright holder, or any other
     #  organization that participated in or was otherwise related to the
     #  development of the program and their respective officials, directors,
     #  officers and other employees shall be held liable for any and all
     #  damages, including, without limitation, general, special, incidental
     #  and consequential damages, arising out of or otherwise in connection
     #  with the use or inability to use the program or any product, material
     #  or result produced or otherwise obtained by using the program,
     #  regardless of whether they have been advised of, or otherwise had
     #  knowledge of, the possibility of such damages at any time during the
     #  project or thereafter.  Each user will be deemed to have agreed to the
     #  foregoing by his or her commencement of use of the program.  The term
     #  "use" as used herein includes, but is not limited to, the use,
     #  modification, copying and distribution of the program and the
     #  production of secondary products from the program.
     #
     #  In the case where the program, whether in its original form or
     #  modified, was distributed or delivered to or received by a user from
     #  any person, organization or entity other than ICOT, unless it makes or
     #  grants independently of ICOT any specific warranty to the user in
     #  writing, such person, organization or entity, will also be exempted
     #  from and not be held liable to the user for any such damages as noted
     #  above as far as the program is concerned.
     #
     #  ---------------COPYING.ipadic-----END----------------------------------

    3. Lao Word Break Dictionary Data (laodict.txt)

     #  Copyright (c) 2013 International Business Machines Corporation
     #  and others. All Rights Reserved.
     #
     # Project: http://code.google.com/p/lao-dictionary/
     # Dictionary: http://lao-dictionary.googlecode.com/git/Lao-Dictionary.txt
     # License: http://lao-dictionary.googlecode.com/git/Lao-Dictionary-LICENSE.txt
     #              (copied below)
     #
     #  This file is derived from the above dictionary, with slight
     #  modifications.
     #  ----------------------------------------------------------------------
     #  Copyright (C) 2013 Brian Eugene Wilson, Robert Martin Campbell.
     #  All rights reserved.
     #
     #  Redistribution and use in source and binary forms, with or without
     #  modification,
     #  are permitted provided that the following conditions are met:
     #
     #
     # Redistributions of source code must retain the above copyright notice, this
     #  list of conditions and the following disclaimer. Redistributions in
     #  binary form must reproduce the above copyright notice, this list of
     #  conditions and the following disclaimer in the documentation and/or
     #  other materials provided with the distribution.
     #
     #
     # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
     # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
     # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
     # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
     # COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
     # INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
     # (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
     # SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
     # HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
     # STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
     # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
     # OF THE POSSIBILITY OF SUCH DAMAGE.
     #  --------------------------------------------------------------------------

    4. Burmese Word Break Dictionary Data (burmesedict.txt)

     #  Copyright (c) 2014 International Business Machines Corporation
     #  and others. All Rights Reserved.
     #
     #  This list is part of a project hosted at:
     #    github.com/kanyawtech/myanmar-karen-word-lists
     #
     #  --------------------------------------------------------------------------
     #  Copyright (c) 2013, LeRoy Benjamin Sharon
     #  All rights reserved.
     #
     #  Redistribution and use in source and binary forms, with or without
     #  modification, are permitted provided that the following conditions
     #  are met: Redistributions of source code must retain the above
     #  copyright notice, this list of conditions and the following
     #  disclaimer.  Redistributions in binary form must reproduce the
     #  above copyright notice, this list of conditions and the following
     #  disclaimer in the documentation and/or other materials provided
     #  with the distribution.
     #
     #    Neither the name Myanmar Karen Word Lists, nor the names of its
     #    contributors may be used to endorse or promote products derived
     #    from this software without specific prior written permission.
     #
     #  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND
     #  CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
     #  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
     #  MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
     #  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS
     #  BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
     #  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
     #  TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
     #  DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
     #  ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR
     #  TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF
     #  THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
     #  SUCH DAMAGE.
     #  --------------------------------------------------------------------------

    5. Time Zone Database

      ICU uses the public domain data and code derived from Time Zone
    Database for its time zone support. The ownership of the TZ database
    is explained in BCP 175: Procedure for Maintaining the Time Zone
    Database section 7.

     # 7.  Database Ownership
     #
     #    The TZ database itself is not an IETF Contribution or an IETF
     #    document.  Rather it is a pre-existing and regularly updated work
     #    that is in the public domain, and is intended to remain in the
     #    public domain.  Therefore, BCPs 78 [RFC5378] and 79 [RFC3979] do
     #    not apply to the TZ Database or contributions that individuals make
     #    to it.  Should any claims be made and substantiated against the TZ
     #    Database, the organization that is providing the IANA
     #    Considerations defined in this RFC, under the memorandum of
     #    understanding with the IETF, currently ICANN, may act in accordance
     #    with all competent court orders.  No ownership claims will be made
     #    by ICANN or the IETF Trust on the database or the code.  Any person
     #    making a contribution to the database or code waives all rights to
     #    future claims in that contribution or in the TZ Database.

    6. Google double-conversion

    Copyright 2006-2011, the V8 project authors. All rights reserved.
    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

        * Redistributions of source code must retain the above copyright
          notice, this list of conditions and the following disclaimer.
        * Redistributions in binary form must reproduce the above
          copyright notice, this list of conditions and the following
          disclaimer in the documentation and/or other materials provided
          with the distribution.
        * Neither the name of Google Inc. nor the names of its
          contributors may be used to endorse or promote products derived
          from this software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  """

- libuv, located at deps/uv, is licensed as follows:
  """
    libuv is licensed for use as follows:

    ====
    Copyright (c) 2015-present libuv project contributors.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to
    deal in the Software without restriction, including without limitation the
    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
    sell copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.
    ====

    This license applies to parts of libuv originating from the
    https://github.com/joyent/libuv repository:

    ====

    Copyright Joyent, Inc. and other Node contributors. All rights reserved.
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to
    deal in the Software without restriction, including without limitation the
    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
    sell copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.

    ====

    This license applies to all parts of libuv that are not externally
    maintained libraries.

    The externally maintained libraries used by libuv are:

      - tree.h (from FreeBSD), copyright Niels Provos. Two clause BSD license.

      - inet_pton and inet_ntop implementations, contained in src/inet.c, are
        copyright the Internet Systems Consortium, Inc., and licensed under the ISC
        license.

      - stdint-msvc2008.h (from msinttypes), copyright Alexander Chemeris. Three
        clause BSD license.

      - pthread-fixes.c, copyright Google Inc. and Sony Mobile Communications AB.
        Three clause BSD license.

      - android-ifaddrs.h, android-ifaddrs.c, copyright Berkeley Software Design
        Inc, Kenneth MacKay and Emergya (Cloud4all, FP7/2007-2013, grant agreement
        n° 289016). Three clause BSD license.
  """

- llhttp, located at deps/llhttp, is licensed as follows:
  """
    This software is licensed under the MIT License.

    Copyright Fedor Indutny, 2018.

    Permission is hereby granted, free of charge, to any person obtaining a
    copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to permit
    persons to whom the Software is furnished to do so, subject to the
    following conditions:

    The above copyright notice and this permission notice shall be included
    in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
    OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
    NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
    OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
    USE OR OTHER DEALINGS IN THE SOFTWARE.
  """

- OpenSSL, located at deps/openssl, is licensed as follows:
  """
    Copyright (c) 1998-2019 The OpenSSL Project.  All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions
    are met:

    1. Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

    2. Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in
    the documentation and/or other materials provided with the
    distribution.

    3. All advertising materials mentioning features or use of this
    software must display the following acknowledgment:
    "This product includes software developed by the OpenSSL Project
    for use in the OpenSSL Toolkit. (http://www.openssl.org/)"

    4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
    endorse or promote products derived from this software without
    prior written permission. For written permission, please contact
    openssl-core@openssl.org.

    5. Products derived from this software may not be called "OpenSSL"
    nor may "OpenSSL" appear in their names without prior written
    permission of the OpenSSL Project.

    6. Redistributions of any form whatsoever must retain the following
    acknowledgment:
    "This product includes software developed by the OpenSSL Project
    for use in the OpenSSL Toolkit (http://www.openssl.org/)"

    THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
    EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
    IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
    PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
    ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
    NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
    LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
    HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
    STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
    ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
    OF THE POSSIBILITY OF SUCH DAMAGE.
    ====================================================================

    This product includes cryptographic software written by Eric Young
    (eay@cryptsoft.com).  This product includes software written by Tim
    Hudson (tjh@cryptsoft.com).
  """

- Punycode.js, located at lib/punycode.js, is licensed as follows:
  """
    Copyright Mathias Bynens &lt;https://mathiasbynens.be/&gt;

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
  """

- V8, located at deps/v8, is licensed as follows:
  """
    This license applies to all parts of V8 that are not externally
    maintained libraries.  The externally maintained libraries used by V8
    are:

      - PCRE test suite, located in
        test/mjsunit/third_party/regexp-pcre/regexp-pcre.js.  This is based on the
        test suite from PCRE-7.3, which is copyrighted by the University
        of Cambridge and Google, Inc.  The copyright notice and license
        are embedded in regexp-pcre.js.

      - Layout tests, located in test/mjsunit/third_party/object-keys.  These are
        based on layout tests from webkit.org which are copyrighted by
        Apple Computer, Inc. and released under a 3-clause BSD license.

      - Strongtalk assembler, the basis of the files assembler-arm-inl.h,
        assembler-arm.cc, assembler-arm.h, assembler-ia32-inl.h,
        assembler-ia32.cc, assembler-ia32.h, assembler-x64-inl.h,
        assembler-x64.cc, assembler-x64.h, assembler-mips-inl.h,
        assembler-mips.cc, assembler-mips.h, assembler.cc and assembler.h.
        This code is copyrighted by Sun Microsystems Inc. and released
        under a 3-clause BSD license.

      - Valgrind client API header, located at src/third_party/valgrind/valgrind.h
        This is released under the BSD license.

      - The Wasm C/C++ API headers, located at third_party/wasm-api/wasm.{h,hh}
        This is released under the Apache license. The API's upstream prototype
        implementation also formed the basis of V8's implementation in
        src/wasm/c-api.cc.

    These libraries have their own licenses; we recommend you read them,
    as their terms may differ from the terms below.

    Further license information can be found in LICENSE files located in
    sub-directories.

    Copyright 2014, the V8 project authors. All rights reserved.
    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

        * Redistributions of source code must retain the above copyright
          notice, this list of conditions and the following disclaimer.
        * Redistributions in binary form must reproduce the above
          copyright notice, this list of conditions and the following
          disclaimer in the documentation and/or other materials provided
          with the distribution.
        * Neither the name of Google Inc. nor the names of its
          contributors may be used to endorse or promote products derived
          from this software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  """

- SipHash, located at deps/v8/src/third_party/siphash, is licensed as follows:
  """
    SipHash reference C implementation

    Copyright (c) 2016 Jean-Philippe Aumasson &lt;jeanphilippe.aumasson@gmail.com&gt;

    To the extent possible under law, the author(s) have dedicated all
    copyright and related and neighboring rights to this software to the public
    domain worldwide. This software is distributed without any warranty.
  """

- zlib, located at deps/zlib, is licensed as follows:
  """
    zlib.h -- interface of the 'zlib' general purpose compression library
    version 1.2.11, January 15th, 2017

    Copyright (C) 1995-2017 Jean-loup Gailly and Mark Adler

    This software is provided 'as-is', without any express or implied
    warranty.  In no event will the authors be held liable for any damages
    arising from the use of this software.

    Permission is granted to anyone to use this software for any purpose,
    including commercial applications, and to alter it and redistribute it
    freely, subject to the following restrictions:

    1. The origin of this software must not be misrepresented; you must not
    claim that you wrote the original software. If you use this software
    in a product, an acknowledgment in the product documentation would be
    appreciated but is not required.
    2. Altered source versions must be plainly marked as such, and must not be
    misrepresented as being the original software.
    3. This notice may not be removed or altered from any source distribution.

    Jean-loup Gailly        Mark Adler
    jloup@gzip.org          madler@alumni.caltech.edu
  """

- npm, located at deps/npm, is licensed as follows:
  """
    The npm application
    Copyright (c) npm, Inc. and Contributors
    Licensed on the terms of The Artistic License 2.0

    Node package dependencies of the npm application
    Copyright (c) their respective copyright owners
    Licensed on their respective license terms

    The npm public registry at https://registry.npmjs.org
    and the npm website at https://www.npmjs.com
    Operated by npm, Inc.
    Use governed by terms published on https://www.npmjs.com

    "Node.js"
    Trademark Joyent, Inc., https://joyent.com
    Neither npm nor npm, Inc. are affiliated with Joyent, Inc.

    The Node.js application
    Project of Node Foundation, https://nodejs.org

    The npm Logo
    Copyright (c) Mathias Pettersson and Brian Hammond

    "Gubblebum Blocky" typeface
    Copyright (c) Tjarda Koster, https://jelloween.deviantart.com
    Used with permission

    --------

    The Artistic License 2.0

    Copyright (c) 2000-2006, The Perl Foundation.

    Everyone is permitted to copy and distribute verbatim copies
    of this license document, but changing it is not allowed.

    Preamble

    This license establishes the terms under which a given free software
    Package may be copied, modified, distributed, and/or redistributed.
    The intent is that the Copyright Holder maintains some artistic
    control over the development of that Package while still keeping the
    Package available as open source and free software.

    You are always permitted to make arrangements wholly outside of this
    license directly with the Copyright Holder of a given Package.  If the
    terms of this license do not permit the full use that you propose to
    make of the Package, you should contact the Copyright Holder and seek
    a different licensing arrangement.

    Definitions

        "Copyright Holder" means the individual(s) or organization(s)
        named in the copyright notice for the entire Package.

        "Contributor" means any party that has contributed code or other
        material to the Package, in accordance with the Copyright Holder's
        procedures.

        "You" and "your" means any person who would like to copy,
        distribute, or modify the Package.

        "Package" means the collection of files distributed by the
        Copyright Holder, and derivatives of that collection and/or of
        those files. A given Package may consist of either the Standard
        Version, or a Modified Version.

        "Distribute" means providing a copy of the Package or making it
        accessible to anyone else, or in the case of a company or
        organization, to others outside of your company or organization.

        "Distributor Fee" means any fee that you charge for Distributing
        this Package or providing support for this Package to another
        party.  It does not mean licensing fees.

        "Standard Version" refers to the Package if it has not been
        modified, or has been modified only in ways explicitly requested
        by the Copyright Holder.

        "Modified Version" means the Package, if it has been changed, and
        such changes were not explicitly requested by the Copyright
        Holder.

        "Original License" means this Artistic License as Distributed with
        the Standard Version of the Package, in its current version or as
        it may be modified by The Perl Foundation in the future.

        "Source" form means the source code, documentation source, and
        configuration files for the Package.

        "Compiled" form means the compiled bytecode, object code, binary,
        or any other form resulting from mechanical transformation or
        translation of the Source form.

    Permission for Use and Modification Without Distribution

    (1)  You are permitted to use the Standard Version and create and use
    Modified Versions for any purpose without restriction, provided that
    you do not Distribute the Modified Version.

    Permissions for Redistribution of the Standard Version

    (2)  You may Distribute verbatim copies of the Source form of the
    Standard Version of this Package in any medium without restriction,
    either gratis or for a Distributor Fee, provided that you duplicate
    all of the original copyright notices and associated disclaimers.  At
    your discretion, such verbatim copies may or may not include a
    Compiled form of the Package.

    (3)  You may apply any bug fixes, portability changes, and other
    modifications made available from the Copyright Holder.  The resulting
    Package will still be considered the Standard Version, and as such
    will be subject to the Original License.

    Distribution of Modified Versions of the Package as Source

    (4)  You may Distribute your Modified Version as Source (either gratis
    or for a Distributor Fee, and with or without a Compiled form of the
    Modified Version) provided that you clearly document how it differs
    from the Standard Version, including, but not limited to, documenting
    any non-standard features, executables, or modules, and provided that
    you do at least ONE of the following:

        (a)  make the Modified Version available to the Copyright Holder
        of the Standard Version, under the Original License, so that the
        Copyright Holder may include your modifications in the Standard
        Version.

        (b)  ensure that installation of your Modified Version does not
        prevent the user installing or running the Standard Version. In
        addition, the Modified Version must bear a name that is different
        from the name of the Standard Version.

        (c)  allow anyone who receives a copy of the Modified Version to
        make the Source form of the Modified Version available to others
        under

            (i)  the Original License or

            (ii)  a license that permits the licensee to freely copy,
            modify and redistribute the Modified Version using the same
            licensing terms that apply to the copy that the licensee
            received, and requires that the Source form of the Modified
            Version, and of any works derived from it, be made freely
            available in that license fees are prohibited but Distributor
            Fees are allowed.

    Distribution of Compiled Forms of the Standard Version
    or Modified Versions without the Source

    (5)  You may Distribute Compiled forms of the Standard Version without
    the Source, provided that you include complete instructions on how to
    get the Source of the Standard Version.  Such instructions must be
    valid at the time of your distribution.  If these instructions, at any
    time while you are carrying out such distribution, become invalid, you
    must provide new instructions on demand or cease further distribution.
    If you provide valid instructions or cease distribution within thirty
    days after you become aware that the instructions are invalid, then
    you do not forfeit any of your rights under this license.

    (6)  You may Distribute a Modified Version in Compiled form without
    the Source, provided that you comply with Section 4 with respect to
    the Source of the Modified Version.

    Aggregating or Linking the Package

    (7)  You may aggregate the Package (either the Standard Version or
    Modified Version) with other packages and Distribute the resulting
    aggregation provided that you do not charge a licensing fee for the
    Package.  Distributor Fees are permitted, and licensing fees for other
    components in the aggregation are permitted. The terms of this license
    apply to the use and Distribution of the Standard or Modified Versions
    as included in the aggregation.

    (8) You are permitted to link Modified and Standard Versions with
    other works, to embed the Package in a larger work of your own, or to
    build stand-alone binary or bytecode versions of applications that
    include the Package, and Distribute the result without restriction,
    provided the result does not expose a direct interface to the Package.

    Items That are Not Considered Part of a Modified Version

    (9) Works (including, but not limited to, modules and scripts) that
    merely extend or make use of the Package, do not, by themselves, cause
    the Package to be a Modified Version.  In addition, such works are not
    considered parts of the Package itself, and are not subject to the
    terms of this license.

    General Provisions

    (10)  Any use, modification, and distribution of the Standard or
    Modified Versions is governed by this Artistic License. By using,
    modifying or distributing the Package, you accept this license. Do not
    use, modify, or distribute the Package, if you do not accept this
    license.

    (11)  If your Modified Version has been derived from a Modified
    Version made by someone other than you, you are nevertheless required
    to ensure that your Modified Version complies with the requirements of
    this license.

    (12)  This license does not grant you the right to use any trademark,
    service mark, tradename, or logo of the Copyright Holder.

    (13)  This license includes the non-exclusive, worldwide,
    free-of-charge patent license to make, have made, use, offer to sell,
    sell, import and otherwise transfer the Package with respect to any
    patent claims licensable by the Copyright Holder that are necessarily
    infringed by the Package. If you institute patent litigation
    (including a cross-claim or counterclaim) against any party alleging
    that the Package constitutes direct or contributory patent
    infringement, then this Artistic License to you shall terminate on the
    date that such litigation is filed.

    (14)  Disclaimer of Warranty:
    THE PACKAGE IS PROVIDED BY THE COPYRIGHT HOLDER AND CONTRIBUTORS "AS
    IS' AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES. THE IMPLIED
    WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR
    NON-INFRINGEMENT ARE DISCLAIMED TO THE EXTENT PERMITTED BY YOUR LOCAL
    LAW. UNLESS REQUIRED BY LAW, NO COPYRIGHT HOLDER OR CONTRIBUTOR WILL
    BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
    DAMAGES ARISING IN ANY WAY OUT OF THE USE OF THE PACKAGE, EVEN IF
    ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

    --------
  """

- GYP, located at tools/gyp, is licensed as follows:
  """
    Copyright (c) 2009 Google Inc. All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

       * Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.
       * Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.
       * Neither the name of Google Inc. nor the names of its
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  """

- inspector_protocol, located at tools/inspector_protocol, is licensed as follows:
  """
    // Copyright 2016 The Chromium Authors. All rights reserved.
    //
    // Redistribution and use in source and binary forms, with or without
    // modification, are permitted provided that the following conditions are
    // met:
    //
    //    * Redistributions of source code must retain the above copyright
    // notice, this list of conditions and the following disclaimer.
    //    * Redistributions in binary form must reproduce the above
    // copyright notice, this list of conditions and the following disclaimer
    // in the documentation and/or other materials provided with the
    // distribution.
    //    * Neither the name of Google Inc. nor the names of its
    // contributors may be used to endorse or promote products derived from
    // this software without specific prior written permission.
    //
    // THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    // "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    // LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    // A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    // OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    // SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    // LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    // DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    // THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    // (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    // OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  """

- jinja2, located at tools/inspector_protocol/jinja2, is licensed as follows:
  """
    Copyright (c) 2009 by the Jinja Team, see AUTHORS for more details.

    Some rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

        * Redistributions of source code must retain the above copyright
          notice, this list of conditions and the following disclaimer.

        * Redistributions in binary form must reproduce the above
          copyright notice, this list of conditions and the following
          disclaimer in the documentation and/or other materials provided
          with the distribution.

        * The names of the contributors may not be used to endorse or
          promote products derived from this software without specific
          prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  """

- markupsafe, located at tools/inspector_protocol/markupsafe, is licensed as follows:
  """
    Copyright (c) 2010 by Armin Ronacher and contributors.  See AUTHORS
    for more details.

    Some rights reserved.

    Redistribution and use in source and binary forms of the software as well
    as documentation, with or without modification, are permitted provided
    that the following conditions are met:

    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.

    * Redistributions in binary form must reproduce the above
      copyright notice, this list of conditions and the following
      disclaimer in the documentation and/or other materials provided
      with the distribution.

    * The names of the contributors may not be used to endorse or
      promote products derived from this software without specific
      prior written permission.

    THIS SOFTWARE AND DOCUMENTATION IS PROVIDED BY THE COPYRIGHT HOLDERS AND
    CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT
    NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER
    OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
    EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
    PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
    PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
    LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    SOFTWARE AND DOCUMENTATION, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
    DAMAGE.
  """

- cpplint.py, located at tools/cpplint.py, is licensed as follows:
  """
    Copyright (c) 2009 Google Inc. All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

       * Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.
       * Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.
       * Neither the name of Google Inc. nor the names of its
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  """

- ESLint, located at tools/node_modules/eslint, is licensed as follows:
  """
    Copyright JS Foundation and other contributors, https://js.foundation

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE.
  """

- babel-eslint, located at tools/node_modules/babel-eslint, is licensed as follows:
  """
    Copyright (c) 2014-2016 Sebastian McKenzie &lt;sebmck@gmail.com&gt;

    MIT License

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
  """

- gtest, located at test/cctest/gtest, is licensed as follows:
  """
    Copyright 2008, Google Inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

        * Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.
        * Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.
        * Neither the name of Google Inc. nor the names of its
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  """

- nghttp2, located at deps/nghttp2, is licensed as follows:
  """
    The MIT License

    Copyright (c) 2012, 2014, 2015, 2016 Tatsuhiro Tsujikawa
    Copyright (c) 2012, 2014, 2015, 2016 nghttp2 contributors

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
  """

- node-inspect, located at deps/node-inspect, is licensed as follows:
  """
    Copyright Node.js contributors. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to
    deal in the Software without restriction, including without limitation the
    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
    sell copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.
  """

- large_pages, located at src/large_pages, is licensed as follows:
  """
     Copyright (C) 2018 Intel Corporation

     Permission is hereby granted, free of charge, to any person obtaining a copy
     of this software and associated documentation files (the "Software"),
     to deal in the Software without restriction, including without limitation
     the rights to use, copy, modify, merge, publish, distribute, sublicense,
     and/or sell copies of the Software, and to permit persons to whom
     the Software is furnished to do so, subject to the following conditions:

     The above copyright notice and this permission notice shall be included
     in all copies or substantial portions of the Software.

     THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
     OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
     FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL
     THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES
     OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
     ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE
     OR OTHER DEALINGS IN THE SOFTWARE.
  """

- caja, located at lib/internal/freeze_intrinsics.js, is licensed as follows:
  """
     Adapted from SES/Caja - Copyright (C) 2011 Google Inc.
     Copyright (C) 2018 Agoric

     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License.
  """

- brotli, located at deps/brotli, is licensed as follows:
  """
    Copyright (c) 2009, 2010, 2013-2016 by the Brotli Authors.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE.
  """

- HdrHistogram, located at deps/histogram, is licensed as follows:
  """
    The code in this repository code was Written by Gil Tene, Michael Barker,
    and Matt Warren, and released to the public domain, as explained at
    http://creativecommons.org/publicdomain/zero/1.0/

    For users of this code who wish to consume it under the "BSD" license
    rather than under the public domain or CC0 contribution text mentioned
    above, the code found under this directory is *also* provided under the
    following license (commonly referred to as the BSD 2-Clause License). This
    license does not detract from the above stated release of the code into
    the public domain, and simply represents an additional license granted by
    the Author.

    -----------------------------------------------------------------------------
    ** Beginning of "BSD 2-Clause License" text. **

     Copyright (c) 2012, 2013, 2014 Gil Tene
     Copyright (c) 2014 Michael Barker
     Copyright (c) 2014 Matt Warren
     All rights reserved.

     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions are met:

     1. Redistributions of source code must retain the above copyright notice,
        this list of conditions and the following disclaimer.

     2. Redistributions in binary form must reproduce the above copyright notice,
        this list of conditions and the following disclaimer in the documentation
        and/or other materials provided with the distribution.

     THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
     AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
     IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
     ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
     LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
     CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
     SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
     INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
     CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
     ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
     THE POSSIBILITY OF SUCH DAMAGE.
  """

- node-heapdump, located at src/heap_utils.cc, is licensed as follows:
  """
    ISC License

    Copyright (c) 2012, Ben Noordhuis &lt;info@bnoordhuis.nl&gt;

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted, provided that the above
    copyright notice and this permission notice appear in all copies.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
    WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
    MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
    ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
    WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
    ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
    OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

    === src/compat.h src/compat-inl.h ===

    ISC License

    Copyright (c) 2014, StrongLoop Inc.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted, provided that the above
    copyright notice and this permission notice appear in all copies.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
    WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
    MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
    ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
    WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
    ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
    OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
  """

- rimraf, located at lib/internal/fs/rimraf.js, is licensed as follows:
  """
    The ISC License

    Copyright (c) Isaac Z. Schlueter and Contributors

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted, provided that the above
    copyright notice and this permission notice appear in all copies.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
    WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
    MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
    ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
    WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
    ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR
    IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
  """

- uvwasi, located at deps/uvwasi, is licensed as follows:
  """
    MIT License

    Copyright (c) 2019 Colin Ihrig and Contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.
  """</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_ide.wiki_license.asciidoc_microsoft-software-license-terms">MICROSOFT SOFTWARE LICENSE TERMS</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>MICROSOFT VISUAL STUDIO CODE

These license terms are an agreement between you and Microsoft Corporation (or based on where you live, one of its affiliates). They apply to the software named above. The terms also apply to any Microsoft services or updates for the software, except to the extent those have different terms.

IF YOU COMPLY WITH THESE LICENSE TERMS, YOU HAVE THE RIGHTS BELOW.

    1. INSTALLATION AND USE RIGHTS.
        a. General. You may use any number of copies of the software to develop and test your applications, including deployment within your internal corporate network.
        b. Demo use. The uses permitted above include use of the software in demonstrating your applications.
        c. Third Party Components. The software may include third party components with separate legal notices or governed by other agreements, as may be described in the ThirdPartyNotices file accompanying the software.
        d. Extensions. The software gives you the option to download other Microsoft and third party software packages from our extension marketplace or package managers. Those packages are under their own licenses, and not this agreement. Microsoft does not distribute, license or provide any warranties for any of the third party packages. By accessing or using our extension marketplace, you agree to the extension marketplace terms located at https://aka.ms/vsmarketplace-ToU.
    2. DATA.
        a. Data Collection. The software may collect information about you and your use of the software, and send that to Microsoft. Microsoft may use this information to provide services and improve our products and services. You may opt-out of many of these scenarios, but not all, as described in the product documentation located at https://code.visualstudio.com/docs/supporting/faq#_how-to-disable-telemetry-reporting. There may also be some features in the software that may enable you and Microsoft to collect data from users of your applications. If you use these features, you must comply with applicable law, including providing appropriate notices to users of your applications together with Microsoft’s privacy statement. Our privacy statement is located at https://go.microsoft.com/fwlink/?LinkID=824704. You can learn more about data collection and use in the help documentation and our privacy statement. Your use of the software operates as your consent to these practices.
        c. Processing of Personal Data. To the extent Microsoft is a processor or subprocessor of personal data in connection with the software, Microsoft makes the commitments in the European Union General Data Protection Regulation Terms of the Online Services Terms to all customers effective May 25, 2018, at https://go.microsoft.com/?linkid=9840733.
    3. UPDATES. The software may periodically check for updates and download and install them for you. You may obtain updates only from Microsoft or authorized sources. Microsoft may need to update your system to provide you with updates. You agree to receive these automatic updates without any additional notice. Updates may not include or support all existing software features, services, or peripheral devices. If you do not want automatic updates, you may turn them off by following the instructions in the documentation at https://go.microsoft.com/fwlink/?LinkID=616397.
    4. FEEDBACK. If you give feedback about the software to Microsoft, you give to Microsoft, without charge, the right to use, share and commercialize your feedback in any way and for any purpose. You will not give feedback that is subject to a license that requires Microsoft to license its software or documentation to third parties because we include your feedback in them. These rights survive this agreement.
    5. SCOPE OF LICENSE. This license applies to the Visual Studio Code product. Source code for Visual Studio Code is available at https://github.com/Microsoft/vscode under the MIT license agreement. The software is licensed, not sold. This agreement only gives you some rights to use the software. Microsoft reserves all other rights. Unless applicable law gives you more rights despite this limitation, you may use the software only as expressly permitted in this agreement. In doing so, you must comply with any technical limitations in the software that only allow you to use it in certain ways. You may not
        reverse engineer, decompile or disassemble the software, or otherwise attempt to derive the source code for the software except and solely to the extent required by third party licensing terms governing use of certain open source components that may be included in the software;
        remove, minimize, block or modify any notices of Microsoft or its suppliers in the software;
        use the software in any way that is against the law;
        share, publish, rent or lease the software, or provide the software as a stand-alone offering for others to use.
    6. SUPPORT SERVICES. Because this software is “as is,” we may not provide support services for it.
    7. ENTIRE AGREEMENT. This agreement, and the terms for supplements, updates, Internet-based services and support services that you use, are the entire agreement for the software and support services.
    8. EXPORT RESTRICTIONS. You must comply with all domestic and international export laws and regulations that apply to the software, which include restrictions on destinations, end-users, and end use. For further information on export restrictions, see https://www.microsoft.com/exporting.
    9. APPLICABLE LAW. If you acquired the software in the United States, Washington law applies to interpretation of and claims for breach of this agreement, and the laws of the state where you live apply to all other claims. If you acquired the software in any other country, its laws apply.
    10. CONSUMER RIGHTS; REGIONAL VARIATIONS. This agreement describes certain legal rights. You may have other rights, including consumer rights, under the laws of your state or country. Separate and apart from your relationship with Microsoft, you may also have rights with respect to the party from which you acquired the software. This agreement does not change those other rights if the laws of your state or country do not permit it to do so. For example, if you acquired the software in one of the below regions, or mandatory country law applies, then the following provisions apply to you:
        a. Australia. You have statutory guarantees under the Australian Consumer Law and nothing in this agreement is intended to affect those rights.
        b. Canada. If you acquired this software in Canada, you may stop receiving updates by turning off the automatic update feature, disconnecting your device from the Internet (if and when you re-connect to the Internet, however, the software will resume checking for and installing updates), or uninstalling the software. The product documentation, if any, may also specify how to turn off updates for your specific device or software.
        c. Germany and Austria.
            Warranty. The properly licensed software will perform substantially as described in any Microsoft materials that accompany the software. However, Microsoft gives no contractual guarantee in relation to the licensed software.
            Limitation of Liability. In case of intentional conduct, gross negligence, claims based on the Product Liability Act, as well as, in case of death or personal or physical injury, Microsoft is liable according to the statutory law.

        Subject to the foregoing clause (ii), Microsoft will only be liable for slight negligence if Microsoft is in breach of such material contractual obligations, the fulfillment of which facilitate the due performance of this agreement, the breach of which would endanger the purpose of this agreement and the compliance with which a party may constantly trust in (so-called "cardinal obligations"). In other cases of slight negligence, Microsoft will not be liable for slight negligence.
    11. DISCLAIMER OF WARRANTY. The software is licensed “as-is.” You bear the risk of using it. Microsoft gives no express warranties, guarantees or conditions. To the extent permitted under your local laws, Microsoft excludes the implied warranties of merchantability, fitness for a particular purpose and non-infringement.

    12. LIMITATION ON AND EXCLUSION OF DAMAGES. You can recover from Microsoft and its suppliers only direct damages up to U.S. $5.00. You cannot recover any other damages, including consequential, lost profits, special, indirect or incidental damages.

    This limitation applies to (a) anything related to the software, services, content (including code) on third party Internet sites, or third party applications; and (b) claims for breach of contract, breach of warranty, guarantee or condition, strict liability, negligence, or other tort to the extent permitted by applicable law.

    It also applies even if Microsoft knew or should have known about the possibility of the damages. The above limitation or exclusion may not apply to you because your state or country may not allow the exclusion or limitation of incidental, consequential or other damages.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_ide.wiki_license.asciidoc_mozilla-public-license-2.0">Mozilla Public License 2.0</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Mozilla Public License, version 2.0

1. Definitions

1.1. “Contributor”

     means each individual or legal entity that creates, contributes to the
     creation of, or owns Covered Software.

1.2. “Contributor Version”

     means the combination of the Contributions of others (if any) used by a
     Contributor and that particular Contributor’s Contribution.

1.3. “Contribution”

     means Covered Software of a particular Contributor.

1.4. “Covered Software”

     means Source Code Form to which the initial Contributor has attached the
     notice in Exhibit A, the Executable Form of such Source Code Form, and
     Modifications of such Source Code Form, in each case including portions
     thereof.

1.5. “Incompatible With Secondary Licenses”
     means

     a. that the initial Contributor has attached the notice described in
        Exhibit B to the Covered Software; or

     b. that the Covered Software was made available under the terms of version
        1.1 or earlier of the License, but not also under the terms of a
        Secondary License.

1.6. “Executable Form”

     means any form of the work other than Source Code Form.

1.7. “Larger Work”

     means a work that combines Covered Software with other material, in a separate
     file or files, that is not Covered Software.

1.8. “License”

     means this document.

1.9. “Licensable”

     means having the right to grant, to the maximum extent possible, whether at the
     time of the initial grant or subsequently, any and all of the rights conveyed by
     this License.

1.10. “Modifications”

     means any of the following:

     a. any file in Source Code Form that results from an addition to, deletion
        from, or modification of the contents of Covered Software; or

     b. any new file in Source Code Form that contains any Covered Software.

1.11. “Patent Claims” of a Contributor

      means any patent claim(s), including without limitation, method, process,
      and apparatus claims, in any patent Licensable by such Contributor that
      would be infringed, but for the grant of the License, by the making,
      using, selling, offering for sale, having made, import, or transfer of
      either its Contributions or its Contributor Version.

1.12. “Secondary License”

      means either the GNU General Public License, Version 2.0, the GNU Lesser
      General Public License, Version 2.1, the GNU Affero General Public
      License, Version 3.0, or any later versions of those licenses.

1.13. “Source Code Form”

      means the form of the work preferred for making modifications.

1.14. “You” (or “Your”)

      means an individual or a legal entity exercising rights under this
      License. For legal entities, “You” includes any entity that controls, is
      controlled by, or is under common control with You. For purposes of this
      definition, “control” means (a) the power, direct or indirect, to cause
      the direction or management of such entity, whether by contract or
      otherwise, or (b) ownership of more than fifty percent (50%) of the
      outstanding shares or beneficial ownership of such entity.


2. License Grants and Conditions

2.1. Grants

     Each Contributor hereby grants You a world-wide, royalty-free,
     non-exclusive license:

     a. under intellectual property rights (other than patent or trademark)
        Licensable by such Contributor to use, reproduce, make available,
        modify, display, perform, distribute, and otherwise exploit its
        Contributions, either on an unmodified basis, with Modifications, or as
        part of a Larger Work; and

     b. under Patent Claims of such Contributor to make, use, sell, offer for
        sale, have made, import, and otherwise transfer either its Contributions
        or its Contributor Version.

2.2. Effective Date

     The licenses granted in Section 2.1 with respect to any Contribution become
     effective for each Contribution on the date the Contributor first distributes
     such Contribution.

2.3. Limitations on Grant Scope

     The licenses granted in this Section 2 are the only rights granted under this
     License. No additional rights or licenses will be implied from the distribution
     or licensing of Covered Software under this License. Notwithstanding Section
     2.1(b) above, no patent license is granted by a Contributor:

     a. for any code that a Contributor has removed from Covered Software; or

     b. for infringements caused by: (i) Your and any other third party’s
        modifications of Covered Software, or (ii) the combination of its
        Contributions with other software (except as part of its Contributor
        Version); or

     c. under Patent Claims infringed by Covered Software in the absence of its
        Contributions.

     This License does not grant any rights in the trademarks, service marks, or
     logos of any Contributor (except as may be necessary to comply with the
     notice requirements in Section 3.4).

2.4. Subsequent Licenses

     No Contributor makes additional grants as a result of Your choice to
     distribute the Covered Software under a subsequent version of this License
     (see Section 10.2) or under the terms of a Secondary License (if permitted
     under the terms of Section 3.3).

2.5. Representation

     Each Contributor represents that the Contributor believes its Contributions
     are its original creation(s) or it has sufficient rights to grant the
     rights to its Contributions conveyed by this License.

2.6. Fair Use

     This License is not intended to limit any rights You have under applicable
     copyright doctrines of fair use, fair dealing, or other equivalents.

2.7. Conditions

     Sections 3.1, 3.2, 3.3, and 3.4 are conditions of the licenses granted in
     Section 2.1.


3. Responsibilities

3.1. Distribution of Source Form

     All distribution of Covered Software in Source Code Form, including any
     Modifications that You create or to which You contribute, must be under the
     terms of this License. You must inform recipients that the Source Code Form
     of the Covered Software is governed by the terms of this License, and how
     they can obtain a copy of this License. You may not attempt to alter or
     restrict the recipients’ rights in the Source Code Form.

3.2. Distribution of Executable Form

     If You distribute Covered Software in Executable Form then:

     a. such Covered Software must also be made available in Source Code Form,
        as described in Section 3.1, and You must inform recipients of the
        Executable Form how they can obtain a copy of such Source Code Form by
        reasonable means in a timely manner, at a charge no more than the cost
        of distribution to the recipient; and

     b. You may distribute such Executable Form under the terms of this License,
        or sublicense it under different terms, provided that the license for
        the Executable Form does not attempt to limit or alter the recipients’
        rights in the Source Code Form under this License.

3.3. Distribution of a Larger Work

     You may create and distribute a Larger Work under terms of Your choice,
     provided that You also comply with the requirements of this License for the
     Covered Software. If the Larger Work is a combination of Covered Software
     with a work governed by one or more Secondary Licenses, and the Covered
     Software is not Incompatible With Secondary Licenses, this License permits
     You to additionally distribute such Covered Software under the terms of
     such Secondary License(s), so that the recipient of the Larger Work may, at
     their option, further distribute the Covered Software under the terms of
     either this License or such Secondary License(s).

3.4. Notices

     You may not remove or alter the substance of any license notices (including
     copyright notices, patent notices, disclaimers of warranty, or limitations
     of liability) contained within the Source Code Form of the Covered
     Software, except that You may alter any license notices to the extent
     required to remedy known factual inaccuracies.

3.5. Application of Additional Terms

     You may choose to offer, and to charge a fee for, warranty, support,
     indemnity or liability obligations to one or more recipients of Covered
     Software. However, You may do so only on Your own behalf, and not on behalf
     of any Contributor. You must make it absolutely clear that any such
     warranty, support, indemnity, or liability obligation is offered by You
     alone, and You hereby agree to indemnify every Contributor for any
     liability incurred by such Contributor as a result of warranty, support,
     indemnity or liability terms You offer. You may include additional
     disclaimers of warranty and limitations of liability specific to any
     jurisdiction.

4. Inability to Comply Due to Statute or Regulation

   If it is impossible for You to comply with any of the terms of this License
   with respect to some or all of the Covered Software due to statute, judicial
   order, or regulation then You must: (a) comply with the terms of this License
   to the maximum extent possible; and (b) describe the limitations and the code
   they affect. Such description must be placed in a text file included with all
   distributions of the Covered Software under this License. Except to the
   extent prohibited by statute or regulation, such description must be
   sufficiently detailed for a recipient of ordinary skill to be able to
   understand it.

5. Termination

5.1. The rights granted under this License will terminate automatically if You
     fail to comply with any of its terms. However, if You become compliant,
     then the rights granted under this License from a particular Contributor
     are reinstated (a) provisionally, unless and until such Contributor
     explicitly and finally terminates Your grants, and (b) on an ongoing basis,
     if such Contributor fails to notify You of the non-compliance by some
     reasonable means prior to 60 days after You have come back into compliance.
     Moreover, Your grants from a particular Contributor are reinstated on an
     ongoing basis if such Contributor notifies You of the non-compliance by
     some reasonable means, this is the first time You have received notice of
     non-compliance with this License from such Contributor, and You become
     compliant prior to 30 days after Your receipt of the notice.

5.2. If You initiate litigation against any entity by asserting a patent
     infringement claim (excluding declaratory judgment actions, counter-claims,
     and cross-claims) alleging that a Contributor Version directly or
     indirectly infringes any patent, then the rights granted to You by any and
     all Contributors for the Covered Software under Section 2.1 of this License
     shall terminate.

5.3. In the event of termination under Sections 5.1 or 5.2 above, all end user
     license agreements (excluding distributors and resellers) which have been
     validly granted by You or Your distributors under this License prior to
     termination shall survive termination.

6. Disclaimer of Warranty

   Covered Software is provided under this License on an “as is” basis, without
   warranty of any kind, either expressed, implied, or statutory, including,
   without limitation, warranties that the Covered Software is free of defects,
   merchantable, fit for a particular purpose or non-infringing. The entire
   risk as to the quality and performance of the Covered Software is with You.
   Should any Covered Software prove defective in any respect, You (not any
   Contributor) assume the cost of any necessary servicing, repair, or
   correction. This disclaimer of warranty constitutes an essential part of this
   License. No use of  any Covered Software is authorized under this License
   except under this disclaimer.

7. Limitation of Liability

   Under no circumstances and under no legal theory, whether tort (including
   negligence), contract, or otherwise, shall any Contributor, or anyone who
   distributes Covered Software as permitted above, be liable to You for any
   direct, indirect, special, incidental, or consequential damages of any
   character including, without limitation, damages for lost profits, loss of
   goodwill, work stoppage, computer failure or malfunction, or any and all
   other commercial damages or losses, even if such party shall have been
   informed of the possibility of such damages. This limitation of liability
   shall not apply to liability for death or personal injury resulting from such
   party’s negligence to the extent applicable law prohibits such limitation.
   Some jurisdictions do not allow the exclusion or limitation of incidental or
   consequential damages, so this exclusion and limitation may not apply to You.

8. Litigation

   Any litigation relating to this License may be brought only in the courts of
   a jurisdiction where the defendant maintains its principal place of business
   and such litigation shall be governed by laws of that jurisdiction, without
   reference to its conflict-of-law provisions. Nothing in this Section shall
   prevent a party’s ability to bring cross-claims or counter-claims.

9. Miscellaneous

   This License represents the complete agreement concerning the subject matter
   hereof. If any provision of this License is held to be unenforceable, such
   provision shall be reformed only to the extent necessary to make it
   enforceable. Any law or regulation which provides that the language of a
   contract shall be construed against the drafter shall not be used to construe
   this License against a Contributor.


10. Versions of the License

10.1. New Versions

      Mozilla Foundation is the license steward. Except as provided in Section
      10.3, no one other than the license steward has the right to modify or
      publish new versions of this License. Each version will be given a
      distinguishing version number.

10.2. Effect of New Versions

      You may distribute the Covered Software under the terms of the version of
      the License under which You originally received the Covered Software, or
      under the terms of any subsequent version published by the license
      steward.

10.3. Modified Versions

      If you create software not governed by this License, and you want to
      create a new license for such software, you may create and use a modified
      version of this License if you rename the license and remove any
      references to the name of the license steward (except to note that such
      modified license differs from this License).

10.4. Distributing Source Code Form that is Incompatible With Secondary Licenses
      If You choose to distribute Source Code Form that is Incompatible With
      Secondary Licenses under the terms of this version of the License, the
      notice described in Exhibit B of this License must be attached.

Exhibit A - Source Code Form License Notice

      This Source Code Form is subject to the
      terms of the Mozilla Public License, v.
      2.0. If a copy of the MPL was not
      distributed with this file, You can
      obtain one at
      http://mozilla.org/MPL/2.0/.

If it is not possible or desirable to put the notice in a particular file, then
You may include the notice in a location (such as a LICENSE file in a relevant
directory) where a recipient would be likely to look for such a notice.

You may add additional accurate notices of copyright ownership.

Exhibit B - “Incompatible With Secondary Licenses” Notice

      This Source Code Form is “Incompatible
      With Secondary Licenses”, as defined by
      the Mozilla Public License, v. 2.0.

:leveloffset: 1


:leveloffset: 0


:leveloffset!:

:leveloffset: 0

[[devonfw-guide_devon4j.wiki_devon4j.asciidoc]]
= Java

:description: comprehensive documentation for the Java stack of devonfw.
:doctype: book
:toc:
:toc-title: Table of Contents
:idprefix:
:idseparator: -

:reproducible:
:source-highlighter: rouge
:listing-caption: Listing
:chapter-label:

:imagesdir: ./
The devonfw community
dev-SNAPSHOT, 2022-03-30_01.12.42


http://www.devonfw.com/[_devonfw_] provides a solution to building applications which combine best-in-class frameworks and libraries as well as industry proven practices and code conventions.
It massively speeds up development, reduces risks and helps you to deliver better results.

The following sections contain the complete compendium of https://github.com/devonfw/devon4j/[devon4j], the Java stack of devonfw.
With devon4j we support both xref:devonfw-guide_devon4j.wiki_spring.asciidoc[spring] and xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[quarkus] as major frameworks.
However, the general coding patterns are based on common Java standards mainly from https://jakarta.ee[Jakarta EE] and therefore do not differ between those frameworks.
Therefore, the xref:devonfw-guide_devon4j.wiki_devon4j.asciidoc_general[general] section contains all the documentation that is universal to Java and does not differ between the two frameworks.
Only the sections xref:devonfw-guide_devon4j.wiki_spring.asciidoc[spring] and xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[quarkus] contain documentation that is specific to the respective approach.

If you're trying to decide which of the two frameworks to use, have a look at xref:devonfw-guide_devon4j.wiki_decision-between-Spring-and-Quarkus.asciidoc[this guide].

You can also read the latest version of this documentation online at the following sources:

* https://github.com/devonfw/devon4j/wiki[devon4j on github wiki]
* https://devonfw.com/website/pages/docs/devon4j.asciidoc.html[devon4j on devonfw.com].
* https://repository.sonatype.org/service/local/artifact/maven/redirect?r=central-proxy&amp;g=com.devonfw.java.doc&amp;a=devon4j-doc&amp;v=LATEST&amp;p=pdf[devon4j as PDF on maven-central]

[[devonfw-guide_devon4j.wiki_devon4j.asciidoc_general]]
== General
Here you will find documentation and code-patterns for developing with Java in general, independent of the framework you choose.

:leveloffset: +2

:toc: macro
toc::[]
:idprefix:
:idseparator: -

[[devonfw-guide_devon4j.wiki_architecture.asciidoc]]
= Architecture

There are many different views that are summarized by the term _architecture_. First, we will introduce the xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_key-principles[key principles] and xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_architecture-principles[architecture principles] of devonfw. Then, we will go into details of the the xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_application-architecture[architecture of an application].

[[devonfw-guide_devon4j.wiki_architecture.asciidoc_key-principles]]
== Key Principles
For devonfw we follow these fundamental key principles for all decisions about architecture, design, or choosing standards, libraries, and frameworks:

* *KISS* +
Keep it small and simple
* *Open* +
Commitment to open standards and solutions (no required dependencies to commercial or vendor-specific standards or solutions)
* *Patterns* +
We concentrate on providing patterns, best-practices and examples rather than writing framework code.
* *Solid* +
We pick solutions that are established and have been proven to be solid and robust in real-live (business) projects.

[[devonfw-guide_devon4j.wiki_architecture.asciidoc_architecture-principles]]
== Architecture Principles
Additionally we define the following principles that our architecture is based on:

* *Component Oriented Design* +
We follow a strictly component oriented design to address the following sub-principles:
** http://en.wikipedia.org/wiki/Separation_of_concerns[Separation of Concerns]
** http://en.wikipedia.org/wiki/Reusability[Reusability] and avoiding http://en.wikipedia.org/wiki/Redundant_code[redundant code]
** http://en.wikipedia.org/wiki/Information_hiding[Information Hiding] via component API and its exchangeable implementation treated as secret.
** _Design by Contract_ for self-contained, descriptive, and stable component APIs.
** xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_technical-architecture[Layering] as well as separation of business logic from technical code for better maintenance.
** _Data Sovereignty_ (and _high cohesion with low coupling_) says that a component is responsible for its data and changes to this data shall only happen via the component. Otherwise, maintenance problems will arise to ensure that data remains consistent. Therefore, interfaces of a component that may be used by other components are designed _call-by-value_ and not _call-by-reference_.
* *Homogeneity* +
Solve similar problems in similar ways and establish a uniform xref:devonfw-guide_devon4j.wiki_coding-conventions.asciidoc[code-style].

As an architect you should be prepared for the future by reading the https://www.capgemini.com/de-de/wp-content/uploads/sites/5/2020/07/TechnoVision-2020-Report.pdf[TechnoVision].

[[devonfw-guide_devon4j.wiki_architecture.asciidoc_application-architecture]]
== Application Architecture

For the architecture of an application we distinguish the following views:

* The xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_business-architecture[Business Architecture] describes an application from the business perspective. It divides the application into business components and with full abstraction of technical aspects.
* The xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_technical-architecture[Technical Architecture] describes an application from the technical implementation perspective. It divides the application into technical layers and defines which technical products and frameworks are used to support these layers.
* The Infrastructure Architecture describes an application from the operational infrastructure perspective. It defines the nodes used to run the application including clustering, load-balancing and networking. This view is not explored further in this guide.

[[devonfw-guide_devon4j.wiki_architecture.asciidoc_business-architecture]]
=== Business Architecture
The _business architecture_ divides the application into _business components_. A business component has a well-defined responsibility that it encapsulates. All aspects related to that responsibility have to be implemented within that business component. Further, the business architecture defines the dependencies between the business components. These dependencies need to be free of cycles. A business component exports its functionality via well-defined interfaces as a self-contained API. A business component may use another business component via its API and compliant with the dependencies defined by the business architecture.

As the business domain and logic of an application can be totally different, the devonfw can not define a standardized business architecture. Depending on the business domain it has to be defined from scratch or from a domain reference architecture template. For very small systems it may be suitable to define just a single business component containing all the code.

[[devonfw-guide_devon4j.wiki_architecture.asciidoc_technical-architecture]]
=== Technical Architecture
The _technical architecture_ divides the application into technical _layers_ based on the http://en.wikipedia.org/wiki/Multilayered_architecture[multilayered architecture]. A layer is a unit of code with the same category such as a service or presentation logic. So, a layer is often supported by a technical framework. Each business component can therefore be split into _component parts_ for each layer. However, a business component may not have component parts for every layer (e.g. only a presentation part that utilized logic from other components).

An overview of the technical reference architecture of the devonfw is given by xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_img-t-architecture[figure "Technical Reference Architecture"].
It defines the following layers visualized as horizontal boxes:

* xref:devonfw-guide_devon4j.wiki_guide-client-layer.asciidoc[client layer] for the front-end (GUI).
* xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[service layer] for the services used to expose functionality of the
back-end to the client or other consumers.
* xref:devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc[batch layer] for exposing functionality in batch-processes (e.g. mass imports).
* xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc[logic layer] for the business logic.
* xref:devonfw-guide_devon4j.wiki_guide-domain-layer.asciidoc[domain layer] for the data access, especially persistence (in the xref:devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc[classic project structure] this layer is named xref:devonfw-guide_devon4j.wiki_guide-dataaccess-layer.asciidoc[data-access layer]).

Also, you can see the (business) components as vertical boxes (e.g. _A_ and _X_) and how they are composed out of component parts each one assigned to one of the technical layers.

Further, there are technical components for cross-cutting aspects grouped by the gray box on the left. Here is a complete list:

* xref:devonfw-guide_devon4j.wiki_guide-security.asciidoc[Security]
* xref:devonfw-guide_devon4j.wiki_guide-logging.asciidoc[Logging]
* xref:devonfw-guide_devon4j.wiki_guide-monitoring.asciidoc[Monitoring]
* xref:devonfw-guide_devon4j.wiki_guide-transactions.asciidoc[Transaction-Handling]
* xref:devonfw-guide_devon4j.wiki_guide-exceptions.asciidoc[Exception-Handling]
* xref:devonfw-guide_devon4j.wiki_guide-i18n.asciidoc[Internationalization]
* xref:devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc[Dependency-Injection]

[[devonfw-guide_devon4j.wiki_architecture.asciidoc_img-t-architecture]]
.Technical Reference Architecture
image::images/T-Architecture.png["devonfw architecture blueprint",scaledwidth="80%",align="center",link="https://devonfw.com/website/pages/docs/images/T-Architecture.svg"]

Please click on the architecture image to open it as SVG and click on the layers and cross-cutting topics to open the according documentation guide.

We reflect this architecture in our code as described in our xref:devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_packages[coding conventions] allowing a traceability of business components, use-cases, layers, etc. into the code and giving
developers a sound orientation within the project.

Further, the architecture diagram shows the allowed dependencies illustrated by the dark green connectors.
Within a business component a component part can call the next component part on the layer directly below via a dependency on its API (vertical connectors).
While this is natural and obvious, it is generally forbidden to have dependencies upwards the layers
or to skip a layer by a direct dependency on a component part two or more layers below.
The general dependencies allowed between business components are defined by the xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_business-architecture[business architecture].
In our reference architecture diagram we assume that the business component `A1` is allowed to depend
on component `A2`. Therefore, a use-case within the logic component part of `A1` is allowed to call a
use-case from `A2` via a dependency on the component API. The same applies for dialogs on the client layer.
This is illustrated by the horizontal connectors. Please note that xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entity[persistence entities] are part of the API of the data-access component part so only the logic component part of the same
business component may depend on them.

The technical architecture has to address non-functional requirements:

* *scalability* +
is established by keeping state in the client and making the server state-less (except for login session). Via load-balancers new server nodes can be added to improve performance (horizontal scaling).
* *availability* and *reliability* +
are addressed by clustering with redundant nodes avoiding any single-point-of failure. If one node fails the system is still available. Further, the software has to be robust so there are no dead-locks or other bad effects that can make the system unavailable or not reliable.
* *security* +
is archived in the devonfw by the right templates and best-practices that avoid vulnerabilities. See xref:devonfw-guide_devon4j.wiki_guide-security.asciidoc[security guidelines] for further details.
* *performance* +
is obtained by choosing the right products and proper configurations. While the actual implementation of the application matters for performance a proper design is important as it is the key to allow performance-optimizations (see e.g. xref:devonfw-guide_devon4j.wiki_guide-caching.asciidoc[caching]).

[[devonfw-guide_devon4j.wiki_architecture.asciidoc_technology-stack]]
==== Technology Stack
The technology stack of the devonfw is illustrated by the following table.

.Technology Stack of devonfw
[options="header"]
|=======================
|*Topic*|*Detail*|*Standard*|*Suggested implementation*
|runtime|language &amp; VM|Java|Oracle JDK
|runtime|servlet-container|JEE|http://tomcat.apache.org/[tomcat]
|xref:devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc[component management]|dependency injection|https://jcp.org/en/jsr/detail?id=330[JSR330] &amp; https://jcp.org/en/jsr/detail?id=250[JSR250]|http://spring.io/[spring]
|xref:devonfw-guide_devon4j.wiki_guide-configuration.asciidoc[configuration]|framework|-|http://projects.spring.io/spring-boot/[spring-boot]
|xref:devonfw-guide_devon4j.wiki_guide-domain-layer.asciidoc[persistence]|OR-mapper|http://www.oracle.com/technetwork/java/javaee/tech/persistence-jsp-140049.html[JPA] | http://hibernate.org/orm/[hibernate]
|xref:devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc[batch]|framework|https://jcp.org/en/jsr/detail?id=352[JSR352]|http://projects.spring.io/spring-batch/[spring-batch]
|xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[service]|xref:devonfw-guide_devon4j.wiki_guide-soap.asciidoc[SOAP services]|https://jcp.org/en/jsr/detail?id=224[JAX-WS]|http://cxf.apache.org/[CXF]
|xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[service]|xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc[REST services]|https://jax-rs-spec.java.net/[JAX-RS]| http://cxf.apache.org/[CXF]
|xref:devonfw-guide_devon4j.wiki_guide-logging.asciidoc[logging]|framework|http://www.slf4j.org/[slf4j]|http://logback.qos.ch/[logback]
|xref:devonfw-guide_devon4j.wiki_guide-validation.asciidoc[validation]|framework|http://beanvalidation.org/[beanvalidation/JSR303]|http://hibernate.org/validator/[hibernate-validator]
|xref:devonfw-guide_devon4j.wiki_guide-security.asciidoc[security]|Authentication &amp; Authorization|http://www.oracle.com/technetwork/java/javase/jaas/index.html[JAAS]|http://projects.spring.io/spring-security/[spring-security]
|xref:devonfw-guide_devon4j.wiki_guide-monitoring.asciidoc[monitoring]|framework|http://www.oracle.com/technetwork/java/javase/tech/javamanagement-140525.html[JMX]|http://spring.io/[spring]
|xref:devonfw-guide_devon4j.wiki_guide-monitoring.asciidoc[monitoring]|HTTP Bridge|HTTP &amp; JSON|http://www.jolokia.org[jolokia]
|xref:devonfw-guide_devon4j.wiki_guide-aop.asciidoc[AOP]|framework|http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Proxy.html[dynamic proxies]|http://docs.spring.io/autorepo/docs/spring/3.0.6.RELEASE/spring-framework-reference/html/aop.html[spring AOP]
|=======================

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-configuration.asciidoc]]
= Configuration

An application needs to be configurable in order to allow internal setup (like CDI) but also to allow externalized configuration of a deployed package (e.g. integration into runtime environment). We rely on a comprehensive configuration approach following a "convention over configuration" pattern. This guide adds on to this by detailed instructions and best-practices how to deal with configurations.

In general we distinguish the following kinds of configuration that are explained in the following sections:

* xref:devonfw-guide_devon4j.wiki_guide-configuration.asciidoc_internal-application-configuration[Internal Application configuration] maintained by developers
* xref:devonfw-guide_devon4j.wiki_guide-configuration.asciidoc_externalized-configuration[Externalized Environment configuration] maintained by operators
* xref:devonfw-guide_devon4j.wiki_guide-configuration.asciidoc_business-configuration[Externalized Business configuration] maintained by business administrators

[[devonfw-guide_devon4j.wiki_guide-configuration.asciidoc_internal-application-configuration]]
== Internal Application Configuration
The application configuration contains all internal settings and wirings of the application (bean wiring, database mappings, etc.) and is maintained by the application developers at development time.

For more detail of xref:devonfw-guide_devon4j.wiki_spring.asciidoc[Spring] stack, see xref:devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_internal-application-configuration[here]

[[devonfw-guide_devon4j.wiki_guide-configuration.asciidoc_externalized-configuration]]
== Externalized Configuration

Externalized configuration is a configuration that is provided separately to a deployment package and can be maintained undisturbed by re-deployments.

[[devonfw-guide_devon4j.wiki_guide-configuration.asciidoc_environment-configuration]]
=== Environment Configuration

The environment configuration contains configuration parameters (typically port numbers, host names, passwords, logins, timeouts, certificates, etc.) specific for the different environments. These are under the control of the operators responsible for the application.

The environment configuration is maintained in `application.properties` files, defining various properties.
These properties are explained in the corresponding configuration sections of the guides for each topic:

* persistence configuration (for Spring see xref:devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_database-configuration[here], for Quarkus see xref:devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc_database-configuration[here])
* xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc_jax-rs-configuration[service configuration]
* xref:devonfw-guide_devon4j.wiki_guide-logging.asciidoc_configuration[logging guide]

Make sure your properties are thoroughly documented by providing a comment to each property. This inline documentation is most valuable for your operating department.

More about structuring your `application.properties` files can be read xref:devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_application-properties-files[here] for Spring.

For Quarkus, please refer to https://quarkus.io/guides/config-reference[Quarkus Config Reference] for more details.

[[devonfw-guide_devon4j.wiki_guide-configuration.asciidoc_business-configuration]]
=== Business Configuration
Often applications do not need business configuration. In case they do it should typically be editable by administrators via the GUI. The business configuration values should therefore be stored in the database in key/value pairs.

Therefore we suggest to create a dedicated table with (at least) the following columns:

* ID
* Property name
* Property type (Boolean, Integer, String)
* Property value
* Description

According to the entries in this table, an administrative GUI may show a generic form to modify business configuration. Boolean values should be shown as checkboxes, integer and string values as text fields. The values should be validated according to their type so an error is raised if you try to save a string in an integer property for example.

We recommend the following base layout for the hierarchical business configuration:

`component.[subcomponent].[subcomponent].propertyname`


[[devonfw-guide_devon4j.wiki_guide-configuration.asciidoc_security]]
== Security
Often you need to have passwords (for databases, third-party services, etc.) as part of your configuration. These are typically environment specific (see above). However, with DevOps and continuous-deployment you might be tempted to commit such configurations into your version-control (e.g. `git`). Doing that with plain text passwords is a severe problem especially for production systems. Never do that! Instead we offer some suggestions how to deal with sensible configurations:

[[devonfw-guide_devon4j.wiki_guide-configuration.asciidoc_password-encryption]]
=== Password Encryption
A simple but reasonable approach is to configure the passwords encrypted with a master-password. The master-password should be a strong secret that is specific for each environment. It must never be committed to version-control.

For xref:devonfw-guide_devon4j.wiki_spring.asciidoc[Spring], we use https://github.com/ulisesbocchio/jasypt-spring-boot#jasypt-spring-boot[jasypt-spring-boot]. For more details, see xref:devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_password-encryption[here]

For xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[Quarkus], see xref:devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc_password-encryption[here]

[[devonfw-guide_devon4j.wiki_guide-configuration.asciidoc_is-this-security-by-obscurity]]
==== Is this Security by Obscurity?

* Yes, from the point of view to protect the passwords on the target environment this is nothing but security by obscurity. If an attacker somehow got full access to the machine this will only cause him to spend some more time.
* No, if someone only gets the configuration file. So all your developers might have access to the version-control where the config is stored. Others might have access to the software releases that include this configs. But without the master-password that should only be known to specific operators none else can decrypt the password (except with brute-force what will take a very long time, see jasypt for details).

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc]]
= Coding Conventions

The code should follow general conventions for Java (see http://www.oracle.com/technetwork/java/namingconventions-139351.html[Oracle Naming Conventions], https://google.github.io/styleguide/javaguide.html[Google Java Style], etc.).We consider this as common sense and provide configurations for http://www.sonarqube.org/[SonarQube] and related tools such as http://checkstyle.sourceforge.net/[Checkstyle] instead of repeating this here.

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_naming]]
== Naming
Besides general Java naming conventions, we follow the additional rules listed here explicitly:

* Always use short but speaking names (for types, methods, fields, parameters, variables, constants, etc.).
* Strictly avoid special characters in technical names (for files, types, fields, methods, properties, variables, database tables, columns, constraints, etc.). In other words only use Latin alpahnumeric ASCII characters with the common allowed technical separators for the accordign context (e.g. underscore) for technical names (even excluding whitespaces).
* For package segments and type names prefer singular forms (`CustomerEntity` instead of [line-through]`CustomersEntity`). Only use plural forms when there is no singular or it is really semantically required (e.g. for a container that contains multiple of such objects).
* Avoid having duplicate type names. The name of a class, interface, enum or annotation should be unique within your project unless this is intentionally desired in a special and reasonable situation.
* Avoid artificial naming constructs such as prefixes (`I*`) or suffixes (`*IF`) for interfaces.
* Use CamelCase even for abbreviations (`XmlUtil` instead of [line-through]`XMLUtil`)
* Avoid property/field names where the second character is upper-case at all (e.g. 'aBc'). See https://github.com/devonfw/cobigen/issues/1095[#1095] for details.
* Names of Generics should be easy to understand. Where suitable follow the common rule `E=Element`, `T=Type`, `K=Key`, `V=Value` but feel free to use longer names for more specific cases such as `ID`, `DTO` or `ENTITY`. The capitalized naming helps to distinguish a generic type from a regular class.

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_packages]]
== Packages
Java Packages are the most important element to structure your code. We use a strict packaging convention to map technical layers and business components (slices) to the code (See xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_technical-architecture[technical architecture] for further details). By using the same names in documentation and code we create a strong link that gives orientation and makes it easy to find from business requirements, specifications or story tickets into the code and back.

For an devon4j based application we use the following Java-Package schema:
[source]
«root».«component».«layer»[.«detail»]

E.g. in our example application we find the Spring Data repositories for the `ordermanagement` component in the package `com.devonfw.application.mtsj.ordermanagement.dataaccess.api.repo`

.Segments of package schema
[options="header"]
|=============================================
|*Segment*      | *Description* | *Example*
|«root»|Is the basic Java Package name-space of your app. Typically we suggest to use `«group».«artifact»` where `«group»` is your maven/gradle `groupId` corresponding to your organization or IT project owning the code following common Java Package conventions. The segment `«artifact»` is your maven/gradle `artifactId` and is typically the technical name of your app. |`com.devonfw.application.mtsj`
| «component» | The (business) component the code belongs to. It is defined by the business architecture and uses terms from the business domain. Use the implicit component `general` for code not belonging to a specific component (foundation code).| `salesmanagement`
| «layer» | The name of the technical layer (See xref:devonfw-guide_devon4j.wiki_architecture.asciidoc[technical architecture]). Details are described for the xref:devonfw-guide_devon4j.wiki_guide-structure-modern.asciidoc_layers[modern project structure] and for the xref:devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc_layers[classic project structure]. | `logic`
| «detail» | Here you are free to further divide your code into sub-components and other concerns according to the size of your component part. If you want to strictly separate API from implementation you should start `«detail»` with `«scope»` that is explained below. | `dao`
| «scope» | The scope which is one of `api` (official API to be used by other layers or components), `base` (basic code to be reused by other implementations) and `impl` (implementation that should never be imported from outside). This segment was initially mandatory but due to trends such as microservices, lean, and agile we decided to make it optional and do not force anybody to use it. | `api`
|=============================================
Please note that `devon4j` library modules for spring use `com.devonfw.module` as `«root»` and the name of the module as `«component»`. E.g. the API of our `beanmapping` module can be found in the package `com.devonfw.module.beanmapping.common.api`.

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_code-tasks]]
== Code Tasks
Code spots that need some rework can be marked with the following tasks tags. These are already properly pre-configured in your development environment for auto completion and to view tasks you are responsible for. It is important to keep the number of code tasks low. Therefore, every member of the team should be responsible for the overall code quality. So if you change a piece of code and hit a code task that you can resolve in a reliable way, please do this as part of your change and remove the according tag.

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_todo]]
=== TODO
Used to mark a piece of code that is not yet complete (typically because it can not be completed due to a dependency on something that is not ready).

[source,java]
 // TODO «author» «description»

A TODO tag is added by the author of the code who is also responsible for completing this task.

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_fixme]]
=== FIXME
[source,java]
 // FIXME «author» «description»

A FIXME tag is added by the author of the code or someone who found a bug he can not fix right now. The «author» who added the FIXME is also responsible for completing this task. This is very similar to a TODO but with a higher priority. FIXME tags indicate problems that should be resolved before a release is completed while TODO tags might have to stay for a longer time.

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_review]]
=== REVIEW
[source,java]
 // REVIEW «responsible» («reviewer») «description»

A REVIEW tag is added by a reviewer during a code review. Here the original author of the code is responsible to resolve the REVIEW tag and the reviewer is assigning this task to him. This is important for feedback and learning and has to be aligned with a review "process" where people talk to each other and get into discussion. In smaller or local teams a peer-review is preferable but this does not scale for large or even distributed teams.

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_code-documentation]]
== Code-Documentation
As a general goal, the code should be easy to read and understand. Besides, clear naming the documentation is important. We follow these rules:

* APIs (especially component interfaces) are properly documented with JavaDoc.
* JavaDoc shall provide actual value - we do not write JavaDoc to satisfy tools such as checkstyle but to express information not already available in the signature.
* We make use of `{@link}` tags in JavaDoc to make it more expressive.
* JavaDoc of APIs describes how to use the type or method and not how the implementation internally works.
* To document implementation details, we use code comments (e.g. `// we have to flush explicitly to ensure version is up-to-date`). This is only needed for complex logic.
* Avoid the pointless `{@inheritDoc}` as since Java 1.5 there is the `@Override` annotation for overridden methods and your JavaDoc is inherited automatically even without any JavaDoc comment at all.

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_code-style]]
== Code-Style
This section gives you best practices to write better code and avoid pitfalls and mistakes.

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_blobs]]
=== BLOBs
Avoid using `byte[]` for BLOBs as this will load them entirely into your memory. This will cause performance issues or out of memory errors. Instead, use streams when dealing with BLOBs. For further details see xref:devonfw-guide_devon4j.wiki_guide-blob-support.asciidoc[BLOB support].

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_stateless-programming]]
=== Stateless Programming
When implementing logic as components or _beans_ of your container using xref:devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc[dependency injection], we strongly encourage stateless programming.
This is not about data objects like an xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entity[entity] or xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc[transfer-object] that are stateful by design.
Instead this applies to all classes annotated with `@Named`, `@ApplicationScoped`, `@Stateless`, etc. and all their super-classes.
These classes especially include your xref:devonfw-guide_devon4j.wiki_guide-repository.asciidoc[repositories], xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc[use-cases], and xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc_jax-rs[REST services].
Such classes shall never be modified after initialization.
Methods called at runtime (after initialization via the container) do not assign fields (member variables of your class) or mutate the object stored in a field.
This allows your component or bean to be stateless and thread-safe.
Therefore it can be initialized as a singleton so only one instance is created and shared accross all threads of the application.
Here is an example:
[source,java]
----
@ApplicationScoped
@Named
public class UcApproveContractImpl implements UcApproveContract {

  // bad
  private String contractOwner;

  private MyState state;

  @Overide
  public void approve(Contract contract) {
    this.contractOwner = contract.getOwner();
    this.contractOwner = this.contractOwner.toLowerCase(Locale.US);
    this.state.setAdmin(this.contractOwner.endsWith("admin"));
    if (this.state.isAdmin()) {
      ...
    } else {
      ...
    }
  }

  // fine
  @Overide
  public void approveContract(Contract contract) {
    String contractOwner = contract.getOwner().toLowerCase(Locale.US);
    if (contractOwner.endsWith("admin")) {
      ...
    } else {
      ...
    }
  }
}
----

As you can see in the `bad` code fields of the class are assigned when the method `approve` is called.
So mutliple users and therefore threads calling this method concurrently can interfere and override this state causing side-effects on parallel threads.
This will lead to nasty bugs and errors that are hard to trace down.
They will not occur in simple tests but for sure in production with real users.
Therefore *never* do this and implement your functionality stateless.
That is keeping all state in local variables and strictly avoid modifying fields or their value as illustrated in the `fine` code.
If you find yourself passing many parameters between methods that all represent state, you can easily create a separate class that encapsulates this state.
However, then you need to create this state object in your method as local variable and pass it between methods as parameter:
[source,java]
----
@ApplicationScoped
@Named
public class UcApproveContractImpl implements UcApproveContract {

  // fine
  @Overide
  public void approveContract(Contract contract) {
    String contractOwner = contract.getOwner().toLowerCase(Locale.US);
    MyState state = new MyState();
    state.setAdmin(this.contractOwner.endsWith("admin"));
    doApproveContract(contract, state);
  }
}
----

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_closing-resources]]
=== Closing Resources
Resources such as streams (`InputStream`, `OutputStream`, `Reader`, `Writer`) or transactions need to be handled properly. Therefore, it is important to follow these rules:

* Each resource has to be closed properly, otherwise you will get out of file handles, TX sessions, memory leaks or the like
* Where possible avoid to deal with such resources manually. That is why we are recommending `@Transactional` for transactions in devonfw (see xref:devonfw-guide_devon4j.wiki_guide-transactions.asciidoc[Transaction Handling]).
* In case you have to deal with resources manually (e.g. binary streams) ensure to close them properly. See the example below for details.

Closing streams and other such resources is error prone. Have a look at the following example:
[source,java]
----
// bad
try {
  InputStream in = new FileInputStream(file);
  readData(in);
  in.close();
} catch (IOException e) {
  throw new IllegalStateException("Failed to read data.", e);
}
----

The code above is wrong as in case of an `IOException` the `InputStream` is not properly closed. In a server application such mistakes can cause severe errors that typically will only occur in production. As such resources implement the `AutoCloseable` interface you can use the `try-with-resource` syntax to write correct code. The following code shows a correct version of the example:
[source,java]
----
// fine
try (InputStream in = new FileInputStream(file)) {
  readData(in);
} catch (IOException e) {
  throw new IllegalStateException("Failed to read data.", e);
}
----

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_catching-and-handling-exceptions]]
=== Catching and handling Exceptions
When catching exceptions always ensure the following:

* Never call `printStackTrace()` method on an exception
* Either log or wrap and re-throw the entire catched exception. Be aware that the cause(s) of an exception is very valuable information. If you loose such information by improper exception-handling you may be unable to properly analyse production problems what can cause severe issues.
** If you wrap and re-throw an exception ensure that the catched exception is passed as cause to the newly created and thrown exception.
** If you log an exception ensure that the entire exception is passed as argument to the logger (and not only the result of `getMessage()` or `toString()` on the exception).
* See xref:devonfw-guide_devon4j.wiki_guide-exceptions.asciidoc_handling-exceptions[exception handling]

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_lambdas-and-streams]]
=== Lambdas and Streams
With Java8 you have cool new features like lambdas and monads like (`Stream`, `CompletableFuture`, `Optional`, etc.).
However, these new features can also be misused or led to code that is hard to read or debug. To avoid pain, we give you the following best practices:

. Learn how to use the new features properly before using. Developers are often keen on using cool new features. When you do your first experiments in your project code you will cause deep pain and might be ashamed afterwards. Please study the features properly. Even Java8 experts still write for loops to iterate over collections, so only use these features where it really makes sense.
. Streams shall only be used in fluent API calls as a Stream can not be forked or reused.
. Each stream has to have exactly one terminal operation.
. Do not write multiple statements into lambda code:
+
[source,java]
----
// bad
collection.stream().map(x -&gt; {
Foo foo = doSomething(x);
...
return foo;
}).collect(Collectors.toList());
----
+
This style makes the code hard to read and debug. Never do that! Instead, extract the lambda body to a private method with a meaningful name:
+
[source,java]
----
// fine
collection.stream().map(this::convertToFoo).collect(Collectors.toList());
----
. Do not use `parallelStream()` in general code (that will run on server side) unless you know exactly what you are doing and what is going on under the hood. Some developers might think that using parallel streams is a good idea as it will make the code faster. However, if you want to do performance optimizations talk to your technical lead (architect). Many features such as security and transactions will rely on contextual information that is associated with the current thread. Hence, using parallel streams will most probably cause serious bugs. Only use them for standalone (CLI) applications or for code that is just processing large amounts of data.
. Do not perform operations on a sub-stream inside a lambda:
+
[source,java]
----
set.stream().flatMap(x -&gt; x.getChildren().stream().filter(this::isSpecial)).collect(Collectors.toList()); // bad
set.stream().flatMap(x -&gt; x.getChildren().stream()).filter(this::isSpecial).collect(Collectors.toList()); // fine
----
. Only use `collect` at the end of the stream:
+
[source,java]
----
set.stream().collect(Collectors.toList()).forEach(...) // bad
set.stream().peek(...).collect(Collectors.toList()) // fine
----
. Lambda parameters with Types inference
+
[source,java]
----
(String a, Float b, Byte[] c) -&gt; a.toString() + Float.toString(b) + Arrays.toString(c)  // bad
(a,b,c)  -&gt; a.toString() + Float.toString(b) + Arrays.toString(c)  // fine

Collections.sort(personList, (Person p1, Person p2) -&gt; p1.getSurName().compareTo(p2.getSurName()));  // bad
Collections.sort(personList, (p1, p2) -&gt; p1.getSurName().compareTo(p2.getSurName()));  // fine
----
. Avoid Return Braces and Statement
+
[source,java]
----
 a -&gt;  { return a.toString(); } // bad
 a -&gt;  a.toString();   // fine
----
. Avoid Parentheses with Single Parameter
+
[source,java]
----
(a) -&gt; a.toString(); // bad
 a -&gt; a.toString();  // fine
----
. Avoid if/else inside foreach method. Use Filter method &amp; comprehension
+
[source,java]
----
// bad
static public Iterator&lt;String&gt; TwitterHandles(Iterator&lt;Author&gt; authors, string company) {
    final List result = new ArrayList&lt;String&gt; ();
    foreach (Author a : authors) {
      if (a.Company.equals(company)) {
        String handle = a.TwitterHandle;
        if (handle != null)
          result.Add(handle);
      }
    }
    return result;
  }
----
+
[source,java]
----
// fine
public List&lt;String&gt; twitterHandles(List&lt;Author&gt; authors, String company) {
    return authors.stream()
            .filter(a -&gt; null != a &amp;&amp; a.getCompany().equals(company))
            .map(a -&gt; a.getTwitterHandle())
            .collect(toList());
  }
----

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_optionals]]
=== Optionals
With `Optional` you can wrap values to avoid a `NullPointerException` (NPE). However, it is not a good code-style to use `Optional` for every parameter or result to express that it may be null. For such case use `@Nullable` or even better instead annotate `@NotNull` where `null` is not acceptable.

However, `Optional` can be used to prevent NPEs in fluent calls (due to the lack of the elvis operator):
[source,java]
----
Long id;
id = fooCto.getBar().getBar().getId(); // may cause NPE
id = Optional.ofNullable(fooCto).map(FooCto::getBar).map(BarCto::getBar).map(BarEto::getId).orElse(null); // null-safe
----

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_encoding]]
=== Encoding
Encoding (esp. Unicode with combining characters and surrogates) is a complex topic. Please study this topic if you have to deal with encodings and processing of special characters. For the basics follow these recommendations:

* Whenever possible prefer unicode (UTF-8 or better) as encoding. This especially impacts your databases and has to be defined upfront as it typically can not be changed (easily) afterwards.
* Do not cast from `byte` to `char` (unicode characters can be composed of multiple bytes, such cast may only work for ASCII characters)
* Never convert the case of a String using the default locale (esp. when writing generic code like in devonfw). E.g. if you do `"HI".toLowerCase()` and your system locale is Turkish, then the output will be "hı" instead of "hi", which can lead to wrong assumptions and serious problems. If you want to do a "universal" case conversion always explicitly use an according western locale (e.g. `toLowerCase(Locale.US)`). Consider using a helper class (see e.g. https://github.com/m-m-m/base/blob/master/core/src/main/java/io/github/mmm/base/text/CaseHelper.java[CaseHelper]) or create your own little static utility for that in your project.
* Write your code independent from the default encoding (system property `file.encoding`) - this will most likely differ in JUnit from production environment
** Always provide an encoding when you create a `String` from `byte[]`: `new String(bytes, encoding)`
** Always provide an encoding when you create a `Reader` or `Writer` : `new InputStreamReader(inStream, encoding)`

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_prefer-general-api]]
=== Prefer general API
Avoid unnecessary strong bindings:

* Do not bind your code to implementations such as `Vector` or `ArrayList` instead of `List`
* In APIs for input (=parameters) always consider to make little assumptions:
** prefer `Collection` over `List` or `Set` where the difference does not matter (e.g. only use `Set` when you require uniqueness or highly efficient `contains`)
** consider preferring `Collection&lt;? extends Foo&gt;` over `Collection&lt;Foo&gt;` when `Foo` is an interface or super-class

[[devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_prefer-primitive-boolean]]
=== Prefer primitive boolean
Unless in rare cases where you need to allow a flag being `null` avoid using the object type `Boolean`.
[source,java]
----
// bad
public Boolean isEmpty {
  return size() == 0;
}
----
Instead always use the primitive `boolean` type:
[source,java]
----
// fine
public boolean isEmpty {
  return size() == 0;
}
----
The only known excuse is for flags in xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_embeddable[embeddable types] due to limitations of hibernate.

:leveloffset: 2

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-structure.asciidoc]]
= Project structure

In devonfw we want to give clear structure and guidance for building applications.
This also allows tools such as https://github.com/devonfw/cobigen[CobiGen] or https://github.com/devonfw/sonar-devon4j-plugin/[sonar-devon4j-plugin] to "understand" the code.
Also this helps developers going from one devonfw project to the next one to quickly understand the code-base.
If every developer knows where to find what, the project gets more efficient.
A long time ago maven standardized the project structure with `src/main/java`, etc. and turned chaos into structure.
With devonfw we experienced the same for the codebase (what is inside `src/main/java`).

We initially started `devon4j` based on spring and spring-boot and proposed a xref:devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc[classic project structure].
With modern cloud-native trends we added a xref:devonfw-guide_devon4j.wiki_guide-structure-modern.asciidoc[modern project structure], that is more lean and up-to-date with the latest market trends.

:leveloffset: 2

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc]]
= Dependency Injection
Dependency injection is one of the most important design patterns and is a key principle to a modular and component based architecture.
The Java Standard for dependency injection is http://docs.oracle.com/javaee/6/api/javax/inject/package-summary.html[javax.inject (JSR330)] that we use in combination with http://docs.oracle.com/javaee/5/api/javax/annotation/package-summary.html[JSR250].
Additionally, for scoping you can use CDI (Context and Dependency Injection) from https://jcp.org/en/jsr/detail?id=365[JSR365].

There are many frameworks which support this standard including all recent Java EE application servers.
Therefore in devonfw we rely on these open standards and can propagate patterns and code examples that work independent from the underlying frameworks.

[[devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc_key-principles]]
== Key Principles
Within dependency injection a _bean_ is typically a reusable unit of your application providing an encapsulated functionality.
This _bean_ can be injected into other beans and it should in general be replaceable.
As an example we can think of a xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc[use-case], a xref:devonfw-guide_devon4j.wiki_guide-repository.asciidoc[repository], etc.
As best practice we use the following principles:

* *Stateless implementation* +
By default such beans shall be implemented xref:devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_stateless-programming[stateless]. If you store state information in member variables you can easily run into concurrency problems and nasty bugs. This is easy to avoid by using local variables and separate state classes for complex state-information. Try to avoid stateful beans wherever possible. Only add state if you are fully aware of what you are doing and properly document this as a warning in your JavaDoc.
* *Usage of Java standards* +
We use common standards (see above) that makes our code portable. Therefore we use standardized annotations like `@Inject` (`javax.inject.Inject`) instead of proprietary annotations such as `@Autowired`. Generally we avoid proprietary annotations in business code (xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc[logic layer]).
* *Simple injection-style* +
In general you can choose between constructor, setter or field injection. For simplicity we recommend to do private field injection as it is very compact and easy to maintain. We believe that constructor injection is bad for maintenance especially in case of inheritance (if you change the dependencies you need to refactor all sub-classes). Private field injection and public setter injection are very similar but setter injection is much more verbose (often you are even forced to have javadoc for all public methods). If you are writing re-usable library code setter injection will make sense as it is more flexible. In a business application you typically do not need that and can save a lot of boiler-plate code if you use private field injection instead. Nowadays you are using container infrastructure also for your tests (see xref:devonfw-guide_devon4j.wiki_guide-testing.asciidoc[testing]) so there is no need to inject manually (what would require a public setter).
* *KISS* +
To follow the KISS (keep it small and simple) principle we avoid advanced features (e.g. custom xref:devonfw-guide_devon4j.wiki_guide-aop.asciidoc[AOP], non-singleton beans) and only use them where necessary.
* *Separation of API and implementation* +
For important components we should separate a self-contained API documented with JavaDoc from its implementation. Code from other components that wants to use the implementation shall only rely on the API. However, for things that will never be exchanged no API as interface is required you can skip such separation.

[[devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc_example-bean]]
== Example Bean
Here you can see the implementation of an example bean using dependency injection:
[source, java]
----
@ApplicationScoped
@Named("MyComponent")
public class MyComponentImpl implements MyComponent {
  @Inject
  private MyOtherComponent myOtherComponent;

  @PostConstruct
  public void init() {
    // initialization if required (otherwise omit this method)
  }

  @PreDestroy
  public void dispose() {
    // shutdown bean, free resources if required (otherwise omit this method)
  }

  ...
}
----

Here `MyComponentImpl` depends on `MyOtherComponent` that is injected into the field `myOtherComponent` because of the `@Inject` annotation.
To make this work there must be exactly one bean in the container (e.g. xref:devonfw-guide_devon4j.wiki_spring.asciidoc[spring] or xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[quarkus]) that is an instance of `MyOtherComponent`.
In order to put a bean into the container, we can use `@ApplicationScoped` in case of CDI (required for quarkus) for a stateless bean.
In spring we can ommit a CDI annotation and the `@Named` annotation is already sufficient as a bean is stateless by default in spring.
If we always use `@ApplicationScoped` we can make this more explicit and more portable accross different frameworks.
So in our example we put `MyComponentImpl` into the container.
That bean will be called `MyComponent` as we specified in the `@Named` annotation but we can also omit the name to use the classname as fallback.
Now our bean can be injected into other beans using `@Inject` annotation either via `MyComponent` interface (recommended when interface is present) or even directly via `MyComponentImpl`.
In case you omit the interface, you should also omit the `Impl` suffix or instead use `Bean` as suffix.

[[devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc_multiple-bean-implementations]]
== Multiple bean implementations
In some cases you might have multiple implementations as beans for the same interface.
The following sub-sections handle the different scenarios to give you guidance.

[[devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc_only-one-implementation-in-container]]
=== Only one implementation in container
In some cases you still have only one implementation active as bean in the container at runtime.
A typical example is that you have different implemenations for test and main usage.
This case is easy, as `@Inject` will always be unique.
The only thing you need to care about is how to configure your framework (spring, quarkus, etc.) to know which implementation to put in the container depending on specific configuration.
In spring this can be archived via the proprietary `@Profile` annotaiton.

[[devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc_injecting-all-of-multiple-implementations]]
=== Injecting all of multiple implementations
In some situations you may have an interface that defines a kind of "plugin".
You can have multiple implementations in your container and want to have all of them injected.
Then you can request a list with all the bean implementations via the interface as in the following example:
[source, java]
----
  @Inject
  private List&lt;MyConverter&gt; converters;
----

Your code may iterate over all plugins (converters) and apply them sequentially.
Please note that the injection will fail (at least in spring), when there is no bean available to inject.
So you do not get an empty list injected but will get an exception on startup.

[[devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc_injecting-one-of-multiple-implementations]]
=== Injecting one of multiple implementations
Another scenario is that you have multiple implementations in your container coexisting, but for injection you may want to choose a specific implementation.
Here you could use the `@Named` annotation to specify a unique identifier for each implementation what is called qualified injection:
[source, java]
----
@ApplicationScoped
@Named("UserAuthenticator")
public class UserAuthenticator implements Authenticator {
  ...
}
@ApplicationScoped
@Named("ServiceAuthenticator")
public class ServiceAuthenticator implements Authenticator {
  ...
}
public class MyUserComponent {
  @Inject
  @Named("UserAuthenticator")
  private Authenticator authenticator;
  ...
}
public class MyServiceComponent {
  @Inject
  @Named("ServiceAuthenticator")
  private Authenticator authenticator;
  ...
}
----

However, we discovered that this pattern is not so great:
The identifiers in the `@Named` annotation are just strings that could easily break.
You could use constants instead but still this is not the best solution.

In the end you can very much simplify this by just directly injecting the implementation instead:
[source, java]
----
@ApplicationScoped
public class UserAuthenticator implements Authenticator {
  ...
}
@ApplicationScoped
public class ServiceAuthenticator implements Authenticator {
  ...
}
public class MyUserComponent {
  @Inject
  private UserAuthenticator authenticator;
  ...
}
public class MyServiceComponent {
  @Inject
  private ServiceAuthenticator authenticator;
  ...
}
----

In case you want to strictly decouple from implementations, you can still create dedicated interfaces:
[source, java]
----
public interface UserAuthenticator extends Authenticator {}
@ApplicationScoped
public class UserAuthenticatorImpl implements UserAuthenticator {
  ...
}
public interface ServiceAuthenticator extends Authenticator {}
@ApplicationScoped
public class ServiceAuthenticatorImpl implements ServiceAuthenticator {
  ...
}
public class MyUserComponent {
  @Inject
  private UserAuthenticator authenticator;
  ...
}
public class MyServiceComponent {
  @Inject
  private ServiceAuthenticator authenticator;
  ...
}
----

However, as you can see this is again introducing additional boiler-plate code.
While the principle to separate API and implementation and strictly decouple from implementation is valuable in general,
you should always consider KISS, lean, and agile in contrast and balance pros and cons instead of blindly following dogmas.

[[devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc_imports]]
== Imports
Here are the import statements for the most important annotations for dependency injection
[source, java]
----
import javax.inject.Inject;
import javax.inject.Named;
import javax.enterprise.context.ApplicationScoped;
// import javax.enterprise.context.RequestScoped;
// import javax.enterprise.context.SessionScoped;
import javax.annotation.PostConstruct;
import javax.annotation.PreDestroy;
----

[[devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc_dependencies]]
== Dependencies
Please note that with https://jakarta.ee/[Jakarta EE] the dependencies have changed.
When you want to start with Jakarta EE you should use these dependencies to get the annoations for dependency injection:

[source, xml]
----
&lt;!-- Basic injection annotations (JSR-330) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;jakarta.inject&lt;/groupId&gt;
  &lt;artifactId&gt;jakarta.inject-api&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- Basic lifecycle and security annotations (JSR-250)--&gt;
&lt;dependency&gt;
  &lt;groupId&gt;jakarta.annotation&lt;/groupId&gt;
  &lt;artifactId&gt;jakarta.annotation-api&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- Context and dependency injection API (JSR-365) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;jakarta.enterprise&lt;/groupId&gt;
  &lt;artifactId&gt;jakarta.enterprise.cdi-api&lt;/artifactId&gt;
&lt;/dependency&gt;
----

Please note that with xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[quarkus] you will get them as transitive dependencies out of the box.
The above Jakarate EE dependencies replace these JEE depdencies:

[source, xml]
----
&lt;!-- Basic injection annotations (JSR-330) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;javax.inject&lt;/groupId&gt;
  &lt;artifactId&gt;javax.inject&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- Basic lifecycle and security annotations (JSR-250)--&gt;
&lt;dependency&gt;
  &lt;groupId&gt;javax.annotation&lt;/groupId&gt;
  &lt;artifactId&gt;javax.annotation-api&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- Context and dependency injection API (JSR-365) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;jakarta.enterprise&lt;/groupId&gt;
  &lt;artifactId&gt;jakarta.enterprise.cdi-api&lt;/artifactId&gt;
&lt;/dependency&gt;
----

:leveloffset: 2

:leveloffset: +2

:toc: macro
toc::[]
[[devonfw-guide_devon4j.wiki_guide-blob-support.asciidoc]]
= BLOB support

BLOB stands for **B**inary **L**arge **Ob**ject. A BLOB may be an image, an office document, ZIP archive or any other multimedia object.
Often these BLOBs are large. if this is the case you need to take care, that you do not copy all the blob data into you application heap, e.g. when providing them via a REST service.
This could easily lead to performance problems or out of memory errors.
As solution for that problem is "streaming" those BLOBs directly from the database to the client. To demonstrate how this can be accomplished, devonfw provides a xref:devonfw-guide/devon4j.wiki_https://github.com/devonfw-sample/devon4j-blob-streaming[example].

[[devonfw-guide_devon4j.wiki_guide-blob-support.asciidoc_further-reading]]
== Further Reading
- xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_blob[BLOBs and the Data Access Layer]
- https://www.owasp.org/index.php/Unrestricted_File_Upload[Security Vulnerability Unrestricted File Upload]

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-common.asciidoc]]
= Common

In our xref:devonfw-guide_devon4j.wiki_coding-conventions.asciidoc[coding-conventions] we define a clear xref:devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_packages[packaging] and xref:devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_layers[layering].
However, there is always cross-cutting code that does not belong to a specific layer such as generic helpers, general code for configuration or integration, etc.
Therefore, we define a package segment `common` that can be used as `«layer»` for such cross-cutting code.
Code from any other layer is allowed to access such `common` code (at least within the same component).

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc]]
= Java Persistence API

For mapping java objects to a relational database we use the http://www.oracle.com/technetwork/java/javaee/tech/persistence-jsp-140049.html[Java Persistence API (JPA)].
As JPA implementation we recommend to use http://hibernate.org/orm/[Hibernate]. For general documentation about JPA and Hibernate follow the links above as we will not replicate the documentation. Here you will only find guidelines and examples how we recommend to use it properly. The following examples show how to map the data of a database to an entity. As we use JPA we abstract from xref:devonfw-guide_devon4j.wiki_guide-sql.asciidoc[SQL] here. However, you will still need a https://en.wikipedia.org/wiki/Data_definition_language[DDL] script for your schema and during maintenance also xref:devonfw-guide_devon4j.wiki_guide-database-migration.asciidoc[database migrations]. Please follow our xref:devonfw-guide_devon4j.wiki_guide-sql.asciidoc[SQL guide] for such artifacts.

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entity]]
== Entity
Entities are part of the persistence layer and contain the actual data. They are POJOs (Plain Old Java Objects) on which the relational data of a database is mapped and vice versa. The mapping is configured via JPA annotations (`javax.persistence`). Usually an entity class corresponds to a table of a database and a property to a column of that table. A persistent entity instance then represents a row of the database table.

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_a-simple-entity]]
=== A Simple Entity
The following listing shows a simple example:

[source,java]
----
@Entity
@Table(name="TEXTMESSAGE")
public class MessageEntity extends ApplicationPersistenceEntity implements Message {

  private String text;

  public String getText() {
    return this.text;
  }

  public void setText(String text) {
    this.text = text;
  }
 }
----
The `@Entity` annotation defines that instances of this class will be entities which can be stored in the database. The `@Table` annotation is optional and can be used to define the name of the corresponding table in the database. If it is not specified, the simple name of the entity class is used instead.

In order to specify how to map the attributes to columns we annotate the corresponding getter methods (technically also private field annotation is also possible but approaches can not be mixed).
The `@Id` annotation specifies that a property should be used as xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_primary-keys[primary key].
With the help of the `@Column` annotation it is possible to define the name of the column that an attribute is mapped to as well as other aspects such as `nullable` or `unique`. If no column name is specified, the name of the property is used as default.

Note that every entity class needs a constructor with public or protected visibility that does not have any arguments. Moreover, neither the class nor its getters and setters may be final.

Entities should be simple POJOs and not contain business logic.

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entities-and-datatypes]]
=== Entities and Datatypes
Standard datatypes like `Integer`, `BigDecimal`, `String`, etc. are mapped automatically by JPA. Custom xref:devonfw-guide_devon4j.wiki_guide-datatype.asciidoc[datatypes] are mapped as serialized xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_blob[BLOB] by default what is typically undesired.
In order to map atomic custom datatypes (implementations of`+SimpleDatatype`) we implement an `AttributeConverter`. Here is a simple example:
[source,java]
----
@Converter(autoApply = true)
public class MoneyAttributeConverter implements AttributeConverter&lt;Money, BigDecimal&gt; {

  public BigDecimal convertToDatabaseColumn(Money attribute) {
    return attribute.getValue();
  }

  public Money convertToEntityAttribute(BigDecimal dbData) {
    return new Money(dbData);
  }
}
----
The annotation `@Converter` is detected by the JPA vendor if the annotated class is in the packages to scan. Further, `autoApply = true` implies that the converter is automatically used for all properties of the handled datatype. Therefore all entities with properties of that datatype will automatically be mapped properly (in our example `Money` is mapped as `BigDecimal`).

In case you have a composite datatype that you need to map to multiple columns the JPA does not offer a real solution. As a workaround you can use a bean instead of a real datatype and declare it as xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_embeddable[`@Embeddable`]. If you are using Hibernate you can implement `CompositeUserType`. Via the `@TypeDef` annotation it can be registered to Hibernate. If you want to annotate the `CompositeUserType` implementation itself you also need another annotation (e.g. `MappedSuperclass` tough not technically correct) so it is found by the scan.

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_enumerations]]
==== Enumerations
By default JPA maps Enums via their ordinal. Therefore the database will only contain the ordinals (0, 1, 2, etc.) . So , inside the database you can not easily understand their meaning. Using `@Enumerated` with `EnumType.STRING` allows to map the enum values to their name (`Enum.name()`). Both approaches are fragile when it comes to code changes and refactoring (if you change the order of the enum values or rename them) after the application is deployed to production. If you want to avoid this and get a robust mapping you can define a dedicated string in each enum value for database representation that you keep untouched. Then you treat the enum just like any other xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entities-and-datatypes[custom datatype].

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_blob]]
==== BLOB
If binary or character large objects (BLOB/CLOB) should be used to store the value of an attribute, e.g. to store an icon, the `@Lob` annotation should be used as shown in the following listing:
[source,java]
----
@Lob
public byte[] getIcon() {
  return this.icon;
}
----
WARNING: Using a byte array will cause problems if BLOBs get large because the entire BLOB is loaded into the RAM of the server and has to be processed by the garbage collector. For larger BLOBs the type http://docs.oracle.com/javase/7/docs/api/java/sql/Blob.html[Blob] and xref:devonfw-guide_devon4j.wiki_guide-blob-support.asciidoc[streaming] should be used.

[source,java]
----
public Blob getAttachment() {
  return this.attachment;
}
----

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_date-and-time]]
==== Date and Time
To store date and time related values, the temporal annotation can be used as shown in the listing below:
[source,java]
----
@Temporal(TemporalType.TIMESTAMP)
public java.util.Date getStart() {
  return start;
}
----
Until Java8 the java data type `java.util.Date` (or Jodatime) has to be used.
`TemporalType` defines the granularity. In this case, a precision of nanoseconds is used. If this granularity is not wanted, `TemporalType.DATE` can be used instead, which only has a granularity of milliseconds.
Mixing these two granularities can cause problems when comparing one value to another. This is why we *only*  use `TemporalType.TIMESTAMP`.

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_querydsl-and-custom-types]]
==== QueryDSL and Custom Types
Using the Aliases API of QueryDSL might result in an `InvalidDataAccessApiUsageException` when using custom datatypes in entity properties. This can be circumvented in two steps:

. Ensure you have the following maven dependencies in your project (`core` module) to support custom types via the Aliases API:
+
[source,xml]
----
&lt;dependency&gt;
  &lt;groupId&gt;org.ow2.asm&lt;/groupId&gt;
  &lt;artifactId&gt;asm&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;cglib&lt;/groupId&gt;
  &lt;artifactId&gt;cglib&lt;/artifactId&gt;
&lt;/dependency&gt;
----

. Make sure, that all your custom types used in entities provide a non-argument constructor with at least visibility level `protected`.

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_primary-keys]]
=== Primary Keys
We only use simple Long values as primary keys (IDs).
By default it is auto generated (`@GeneratedValue(strategy=GenerationType.AUTO)`).
This is already provided by the class `com.devonfw.&lt;projectName&gt;.general.dataaccess.api.AbstractPersistenceEntity` within the xref:devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc_architecture-mapping[classic project structure] respectively `com.devonfw.&lt;projectName&gt;.general.domain.model.AbstractPersistenceEntity` within the xref:devonfw-guide_devon4j.wiki_guide-structure-modern.asciidoc_architecture-mapping[modern project structure], that you can extend.

The reason for this recommendation is simply because using a number (`Long`) is the most efficient representation for the database.
You may also consider to use other types like `String` or `UUID` or even composite custom datatypes and this is technically possible.
However, please consider that the primary key is used to lookup the row from the database table, also in foreign keys and thus in JOINs.
Please note that your project sooner or later may reach some complexity where performance really matters.
Working on big data and performing JOINs when using types such as `String` (`VARCHAR[2]`) as primary and foreign keys will kill your performance.
You are still free to make a different choice and devonfw only gives recommendations but does not want to dictate you what to do.
However, you have been warned about the concequences.
If you are well aware of what you are doing, you can still use differnet types of primary keys.
In such case, create your own entity not extending `AbstractPersistenceEntity` or create your own copy of `AbstractPersistenceEntity` with a different name and a different type of primary key.

In case you have business oriented keys (often as `String`), you can define an additional property for it and declare it as unique (`@Column(unique=true)`).
Be sure to include "AUTO_INCREMENT" in your sql table field ID to be able to persist data (or similar for other databases).

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_relationships]]
== Relationships
[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_n1-and-11-relationships]]
=== n:1 and 1:1 Relationships
Entities often do not exist independently but are in some relation to each other. For example, for every period of time one of the StaffMember's of the restaurant example has worked, which is represented by the class `WorkingTime`, there is a relationship to this StaffMember.

The following listing shows how this can be modeled using JPA:
[source,java]
----
...

@Entity
public class WorkingTimeEntity {
   ...

   private StaffMemberEntity staffMember;

   @ManyToOne
   @JoinColumn(name="STAFFMEMBER")
   public StaffMemberEntity getStaffMember() {
      return this.staffMember;
   }

   public void setStaffMember(StaffMemberEntity staffMember) {
      this.staffMember = staffMember;
   }
}
----
To represent the relationship, an attribute of the type of the corresponding entity class that is referenced has been introduced. The relationship is a n:1 relationship, because every `WorkingTime` belongs to exactly one `StaffMember`, but a `StaffMember` usually worked more often than once. +
This is why the `@ManyToOne` annotation is used here. For 1:1 relationships the `@OneToOne` annotation can be used which works basically the same way. To be able to save information about the relation in the database, an additional column in the corresponding table of WorkingTime is needed which contains the primary key of the referenced StaffMember. With the `name` element of the `@JoinColumn` annotation it is possible to specify the name of this column.

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_1n-and-nm-relationships]]
=== 1:n and n:m Relationships
The relationship of the example listed above is currently an unidirectional one, as there is a getter method for retrieving the `StaffMember` from the `WorkingTime` object, but not vice versa.

To make it a bidirectional one, the following code has to be added to `StaffMember`:
[source,java]
----
  private Set&lt;WorkingTimeEntity&gt; workingTimes;

  @OneToMany(mappedBy="staffMember")
  public Set&lt;WorkingTimeEntity&gt; getWorkingTimes() {
    return this.workingTimes;
  }

  public void setWorkingTimes(Set&lt;WorkingTimeEntity&gt; workingTimes) {
    this.workingTimes = workingTimes;
  }
----
To make the relationship bidirectional, the tables in the database do not have to be changed. Instead the column that corresponds to the attribute `staffMember` in class `WorkingTime` is used, which is specified by the `mappedBy` element of the `@OneToMany` annotation. Hibernate will search for corresponding `WorkingTime` objects automatically when a `StaffMember` is loaded.

The problem with bidirectional relationships is that if a `WorkingTime` object is added to the set or list `workingTimes` in `StaffMember`, this does not have any effect in the database unless
the `staffMember` attribute of that `WorkingTime` object is set. That is why the devon4j advices not to use bidirectional relationships but to use queries instead. How to do this is shown xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_queries[here]. If a bidirectional relationship should be used nevertheless, appropriate add and remove methods must be used.

For 1:n and n:m relations, the devon4j demands that (unordered) Sets and no other collection types are used, as shown in the listing above. The only exception is whenever an ordering is really needed, (sorted) lists can be used. +
For example, if `WorkingTime` objects should be sorted by their start time, this could be done like this:
[source,java]
----
  private List&lt;WorkingTimeEntity&gt; workingTimes;

  @OneToMany(mappedBy = "staffMember")
  @OrderBy("startTime asc")
  public List&lt;WorkingTimeEntity&gt; getWorkingTimes() {
    return this.workingTimes;
  }

  public void setWorkingTimes(List&lt;WorkingTimeEntity&gt; workingTimes) {
    this.workingTimes = workingTimes;
  }
----
The value of the `@OrderBy` annotation consists of an attribute name of the class followed by `asc` (ascending) or `desc` (descending).

To store information about a n:m relationship, a separate table has to be used, as one column cannot store several values (at least if the database schema is in first normal form). +
For example if one wanted to extend the example application so that all ingredients of one `FoodDrink` can be saved and to model the ingredients themselves as entities (e.g. to store additional information about them), this could be modeled as follows (extract of class `FoodDrink`):
[source,java]
----
  private Set&lt;IngredientEntity&gt; ingredients;

  @ManyToMany()
  @JoinTable
  public Set&lt;IngredientEntity&gt; getIngredients() {
    return this.ingredients;
  }

  public void setOrders(Set&lt;IngredientEntity&gt; ingredients) {
    this.ingredients = ingredients;
  }
----
Information about the relation is stored in a table called `BILL_ORDER` that has to have two columns, one for referencing the Bill, the other one for referencing the Order. Note that the `@JoinTable` annotation is not needed in this case because a separate table is the default solution here (same for n:m relations) unless there is a `mappedBy` element specified.

For 1:n relationships this solution has the disadvantage that more joins (in the database system) are needed to get a Bill with all the Orders it refers to. This might have a negative impact on performance so that the solution to store a reference to the Bill row/entity in the Order's table is probably the better solution in most cases.

Note that bidirectional n:m relationships are not allowed for applications based on devon4j. Instead a third entity has to be introduced, which "represents" the relationship (it has two n:1 relationships).

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_eager-vs.-lazy-loading]]
=== Eager vs. Lazy Loading
Using JPA it is possible to use either lazy or eager loading. Eager loading means that for entities retrieved from the database, other entities that are referenced by these entities are also retrieved, whereas lazy loading means that this is only done when they are actually needed, i.e. when the corresponding getter method is invoked.

Application based on devon4j are strongly advised to *always use lazy loading*. The JPA defaults are:

* `@OneToMany`: LAZY
* `@ManyToMany`: LAZY
* `@ManyToOne`: EAGER
* `@OneToOne`: EAGER

So at least for `@ManyToOne` and `@OneToOne` you always need to override the default by providing `fetch = FetchType.LAZY`.

IMPORTANT: Please read the xref:devonfw-guide_devon4j.wiki_guide-jpa-performance.asciidoc[performance guide].

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_cascading-relationships]]
=== Cascading Relationships
For relations it is also possible to define whether operations are cascaded (like a recursion) to the related entity.
By default, nothing is done in these situations. This can be changed by using the `cascade` property of the annotation that specifies the relation type (`@OneToOne`, `@ManyToOne`, `@OneToMany`, `@ManyToOne`). This property accepts a `CascadeType` that offers the following options:

* PERSIST (for `EntityManager.persist`, relevant to inserted transient entities into DB)
* REMOVE (for `EntityManager.remove` to delete entity from DB)
* MERGE (for `EntityManager.merge`)
* REFRESH (for `EntityManager.refresh`)
* DETACH (for `EntityManager.detach`)
* ALL (cascade all of the above operations)

See http://meri-stuff.blogspot.de/2012/03/jpa-tutorial.html[here] for more information.

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_typesafe-foreign-keys-using-idref]]
=== Typesafe Foreign Keys using IdRef

For simple usage you can use `Long` for all your foreign keys.
However, as an optional pattern for advanced and type-safe usage, we offer xref:devonfw-guide_devon4j.wiki_guide-jpa-idref.asciidoc[IdRef].

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_embeddable]]
== Embeddable
An embeddable Object is a way to group properties of an xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entity[entity] into a separate Java (child) object. Unlike with implement xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_relationships[relationships] the embeddable is not a separate entity and its properties are stored (embedded) in the same table together with the entity. This is helpful to structure and reuse groups of properties.

The following example shows an `Address` implemented as an embeddable class:
[source,java]
----
@Embeddable
public class AddressEmbeddable {

  private String street;
  private String number;
  private Integer zipCode;
  private String city;

  @Column(name="STREETNUMBER")
  public String getNumber() {
    return number;
  }

  public void setNumber(String number) {
    this.number = number;
  }

  ...  // other getter and setter methods, equals, hashCode
}
----
As you can see an embeddable is similar to an entity class, but with an `@Embeddable` annotation instead of the `@Entity` annotation and without primary key or modification counter.
An Embeddable does not exist on its own but in the context of an entity.
As a simplification Embeddables do not require a separate interface and xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc_ETO[ETO] as the xref:devonfw-guide_devon4j.wiki_guide-beanmapping.asciidoc[bean-mapper] will create a copy automatically when converting the owning entity to an ETO.
However, in this case the embeddable becomes part of your `api` module that therefore needs a dependency on the `JPA`.

In addition to that the methods `equals(Object)` and `hashCode()` need to be implemented as this is required by Hibernate (it is not required for entities because they can be unambiguously identified by their primary key). For some hints on how to implement the `hashCode()` method please have a look http://stackoverflow.com/questions/113511/hash-code-implementation[here].

Using this `AddressEmbeddable` inside an entity class can be done like this:
[source,java]
----
  private AddressEmbeddable address;

  @Embedded
  public AddressEmbeddable getAddress() {
    return this.address;
  }

  public void setAddress(AddressEmbeddable address) {
    this.address = address;
  }
}
----
The `@Embedded` annotation needs to be used for embedded attributes. Note that if in all columns of the embeddable (here `Address`) are `null`, then the embeddable object itself is also `null` inside the entity. This has to be considered to avoid NullPointerException's. Further this causes some issues with primitive types in embeddable classes that can be avoided by only using object types instead.

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_inheritance]]
== Inheritance
Just like normal java classes, xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entity[entity] classes can inherit from others. The only difference is that you need to specify how to map a class hierarchy to database tables. Generic abstract super-classes for entities can simply be annotated with `@MappedSuperclass`.

For all other cases the JPA offers the annotation `@Inheritance` with the property `strategy` talking an `InheritanceType` that has the following options:
--
* `SINGLE_TABLE`: This strategy uses a single table that contains all columns needed to store all entity-types of the entire inheritance hierarchy. If a column is not needed for an entity because of its type, there is a null value in this column. An additional column is introduced, which denotes the type of the entity (called `dtype`).
* `TABLE_PER_CLASS`: For each concrete entity class there is a table in the database that can store such an entity with all its attributes. An entity is only saved in the table corresponding to its most concrete type. To get all entities of a super type, joins are needed.
* `JOINED`: In this case there is a table for every entity class including abstract classes, which contains only the columns for the persistent properties of that particular class. Additionally there is a primary key column in every table. To get an entity of a class that is a subclass of another one, joins are needed.
--
Each of the three approaches has its advantages and drawbacks, which are discussed in detail http://openjpa.apache.org/builds/1.0.4/apache-openjpa-1.0.4/docs/manual/jpa_overview_mapping_inher.html#jpa_overview_mapping_inher_tpc[here]. In most cases, the first one should be used, because it is usually the fastest way to do the mapping, as no joins are needed when retrieving, searching or persisting entities. Moreover it is rather simple and easy to understand.
One major disadvantage is that the first approach could lead to a table with a lot of null values, which might have a negative impact on the database size.

The inheritance strategy has to be annotated to the top-most entity of the class hierarchy (where `@MappedSuperclass` classes are not considered) like in the following example:
[source,java]
----
@Entity
@Inheritance(strategy=InheritanceType.SINGLE_TABLE)
public abstract class MyParentEntity extends ApplicationPersistenceEntity implements MyParent {
  ...
}

@Entity
public class MyChildEntity extends MyParentEntity implements MyChild {
  ...
}

@Entity
public class MyOtherEntity extends MyParentEntity implements MyChild {
  ...
}
----
As a best practice we advise you to avoid entity hierarchies at all where possible and otherwise to keep the hierarchy as small as possible. In order to just ensure reuse or establish a common API you can consider a shared interface, a `@MappedSuperclass` or an `@Embeddable` instead of an entity hierarchy.

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_repositories-and-daos]]
== Repositories and DAOs
For each entity a code unit is created that groups all database operations for that entity. We recommend to use xref:devonfw-guide_devon4j.wiki_guide-repository.asciidoc[spring-data repositories] for that as it is most efficient for developers. As an alternative there is still the classic approach using xref:devonfw-guide_devon4j.wiki_guide-dao.asciidoc[DAOs].

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_concurrency-control]]
=== Concurrency Control
The concurrency control defines the way concurrent access to the same data of a database is handled. When several users (or threads of application servers) concurrently access a database, anomalies may happen, e.g. a transaction is able to see changes from another transaction although that one did, not yet commit these changes. Most of these anomalies are automatically prevented by the database system, depending on the http://en.wikipedia.org/wiki/Isolation_(database_systems)[_isolation level_] (property `hibernate.connection.isolation` in the `jpa.xml`, see http://docs.jboss.org/hibernate/orm/5.0/manual/en-US/html/ch03.html[here], or `quarkus.datasource.jdbc.transaction-isolation-level` in the `application.properties`).

Another anomaly is when two stakeholders concurrently access a record, do some changes and write them back to the database. The JPA addresses this with different locking strategies (see http://www.objectdb.com/java/jpa/persistence/lock[here]).

As a best practice we are using optimistic locking for regular end-user xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[services] (OLTP) and pessimistic locking for xref:devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc[batches].

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_optimistic-locking]]
=== Optimistic Locking
The class `com.devonfw.module.jpa.persistence.api.AbstractPersistenceEntity` already provides optimistic locking via a `modificationCounter` with the `@Version` annotation. Therefore JPA takes care of optimistic locking for you. When entities are transferred to clients, modified and sent back for update you need to ensure the `modificationCounter` is part of the game. If you follow our guides about xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc[transfer-objects] and xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[services] this will also work out of the box.
You only have to care about two things:

* How to deal with optimistic locking in xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_relationships[relationships]? +
Assume an entity `A` contains a collection of `B` entities. Should there be a locking conflict if one user modifies an instance of `A` while another user in parallel modifies an instance of `B` that is contained in the other instance? To address this , take a look at https://github.com/devonfw/devon4j/blob/develop/modules/jpa-basic/src/main/java/com/devonfw/module/jpa/dataaccess/api/feature/FeatureForceIncrementModificationCounter.java[FeatureForceIncrementModificationCounter].
* What should happen in the UI if an `OptimisticLockException` occurred? +
According to KISS our recommendation is that the user gets an error displayed that tells him to do his change again on the recent data. Try to design your system and the work processing in a way to keep such conflicts rare and you are fine.

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_pessimistic-locking]]
=== Pessimistic Locking
For back-end xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[services] and especially for xref:devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc[batches] optimistic locking is not suitable. A human user shall not cause a large batch process to fail because he was editing the same entity. Therefore such use-cases use pessimistic locking what gives them a kind of priority over the human users.
In your xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_data-access-object[DAO] implementation you can provide methods that do pessimistic locking via http://docs.oracle.com/javaee/7/api/javax/persistence/EntityManager.html[`EntityManager`] operations that take a http://docs.oracle.com/javaee/7/api/javax/persistence/LockModeType.html[`LockModeType`]. Here is a simple example:
[source,java]
----
  getEntityManager().lock(entity, LockModeType.READ);
----
When using the `lock(Object, LockModeType)` method with `LockModeType.READ`, Hibernate will issue a `SELECT ... FOR UPDATE`. This means that no one else can update the entity (see http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_10002.htm[here] for more information on the statement). If `LockModeType.WRITE` is specified, Hibernate issues a `SELECT ... FOR UPDATE NOWAIT` instead, which has has the same meaning as the statement above, but if there is already a lock, the program will not wait for this lock to be released. Instead, an exception is raised. +
Use one of the types if you want to modify the entity later on, for read only access no lock is required.

As you might have noticed, the behavior of Hibernate deviates from what one would expect by looking at the `LockModeType` (especially `LockModeType.READ` should not cause a `SELECT ... FOR UPDATE` to be issued). The framework actually deviates from what is http://docs.oracle.com/javaee/7/api/javax/persistence/LockModeType.html[specified] in the JPA for unknown reasons.

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_database-auditing]]
== Database Auditing
See xref:devonfw-guide_devon4j.wiki_guide-auditing.asciidoc[auditing guide].

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_testing-data-access]]
== Testing Data-Access
For testing of Entities and Repositories or DAOs see xref:devonfw-guide_devon4j.wiki_guide-testing.asciidoc_level-2-component-test[testing guide].

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_principles]]
== Principles
We strongly recommend these principles:

* Use the JPA where ever possible and use vendor (hibernate) specific features only for situations when JPA does not provide a solution. In the latter case consider first if you really need the feature.
* Create your entities as simple POJOs and use JPA to annotate the getters in order to define the mapping.
* Keep your entities simple and avoid putting advanced logic into entity methods.

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_database-configuration]]
== Database Configuration

For details on the configuration of the database connection and database logging of the individual framework, please refer to the respective configuration guide.

For xref:devonfw-guide_devon4j.wiki_spring.asciidoc[spring] see xref:devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_database-configuration[here].

For xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[quarkus] see xref:devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc_database-configuration[here].

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_database-migration]]
=== Database Migration
See xref:devonfw-guide_devon4j.wiki_guide-database-migration.asciidoc[database migration].

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_pooling]]
=== Pooling
You typically want to pool JDBC connections to boost performance by recycling previous connections. There are many libraries available to do connection pooling. We recommend to use https://github.com/brettwooldridge/HikariCP[HikariCP]. For Oracle RDBMS see xref:devonfw-guide_devon4j.wiki_guide-oracle.asciidoc_pooling[here].

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_security]]
== Security
[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_sql-injection]]
=== SQL-Injection
A common xref:devonfw-guide_devon4j.wiki_guide-security.asciidoc[security] threat is http://en.wikipedia.org/wiki/SQL_injection[SQL-injection]. Never build queries with string concatenation or your code might be vulnerable as in the following example:
[source, java]
----
  String query = "Select op from OrderPosition op where op.comment = " + userInput;
  return getEntityManager().createQuery(query).getResultList();
----
Via the parameter `userInput` an attacker can inject SQL (JPQL) and execute arbitrary statements in the database causing extreme damage.

In order to prevent such injections you have to strictly follow our rules for xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_queries[queries]:

* Use named queries for xref:devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_static-queries[static queries].
* Use QueryDSL for xref:devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_dynamic-queries[dynamic queries].
* Please also consult the https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet[SQL Injection Prevention Cheat Sheet].

[[devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_limited-permissions-for-application]]
=== Limited Permissions for Application
We suggest that you operate your application with a database user that has limited permissions so he can not modify the SQL schema (e.g. drop tables). For initializing the schema (DDL) or to do schema migrations use a separate user that is not used by the application itself.

:leveloffset: 2

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc]]
= Queries
The http://www.oracle.com/technetwork/java/javaee/tech/persistence-jsp-140049.html[Java Persistence API (JPA)] defines its own query language, the https://docs.oracle.com/html/E13946_01/ejb3_langref.html[_java persistence query language_ (JPQL)] (see also https://docs.oracle.com/javaee/7/tutorial/persistence-querylanguage.htm[JPQL tutorial]), which is similar to SQL but operates on entities and their attributes instead of tables and columns.

The simplest CRUD-Queries (e.g. find an entity by its ID) are already build in the devonfw CRUD functionality (via xref:devonfw-guide_devon4j.wiki_guide-repository.asciidoc[Repository] or xref:devonfw-guide_devon4j.wiki_guide-dao.asciidoc[DAO]). For other cases you need to write your own query. We distinguish between _static_ and _dynamic_ queries. xref:devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_static-queries[Static queries] have a fixed JPQL query string that may only use parameters to customize the query at runtime. Instead, xref:devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_dynamic-queries[dynamic queries] can change their clauses (`WHERE`, `ORDER BY`, `JOIN`, etc.) at runtime depending on the given search criteria.

[[devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_static-queries]]
== Static Queries
E.g. to find all https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/java/com/devonfw/application/mtsj/dishmanagement/dataaccess/api/DishEntity.java[DishEntries] (from MTS sample app) that have a price not exceeding a given `maxPrice` we write the following JPQL query:
[source,sql]
----
SELECT dish FROM DishEntity dish WHERE dish.price &lt;= :maxPrice
----
Here `dish` is used as alias (variable name) for our selected `DishEntity` (what refers to the simple name of the Java entity class). With `dish.price` we are referring to the Java property `price` (`getPrice()`/`setPrice(...)`) in `DishEntity`. A named variable provided from outside (the search criteria at runtime) is specified with a colon (`:`) as prefix. Here with `:maxPrice` we reference to a variable that needs to be set via `query.setParameter("maxPrice", maxPriceValue)`. JPQL also supports indexed parameters (`?`) but they are discouraged because they easily cause confusion and mistakes.

[[devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_using-queries-to-avoid-bidirectional-relationships]]
=== Using Queries to Avoid Bidirectional Relationships
With the usage of queries it is possible to avoid exposing relationships or modelling bidirectional relationships, which have some disadvantages (see xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_relationships[relationships]). This is especially desired for relationships between entities of different business components.
So for example to get all https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/java/com/devonfw/application/mtsj/ordermanagement/dataaccess/api/OrderLineEntity.java[OrderLineEntities] for a specific https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/java/com/devonfw/application/mtsj/ordermanagement/dataaccess/api/OrderEntity.java[OrderEntity] without using the `orderLines` relation from `OrderEntity` the following query could be used:
[source,sql]
----
SELECT line FROM OrderLineEntity line WHERE line.order.id = :orderId
----

[[devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_dynamic-queries]]
== Dynamic Queries
For dynamic queries, we use the http://querydsl.com/static/querydsl/latest/reference/html/ch02.html[JPA] module for http://www.querydsl.com/[Querydsl]. Querydsl also supports other modules such as http://querydsl.com/static/querydsl/latest/reference/html/ch02s07.html[MongoDB], and http://querydsl.com/static/querydsl/latest/reference/html/ch02s05.html[Apache Lucene]. It allows to implement queries in a powerful but readable and type-safe way (unlike Criteria API). If you already know JPQL, you will quickly be able to read and write Querydsl code. It feels like JPQL but implemented in Java instead of plain text.

To use Querydsl in your Maven project, add the following dependencies:

[source,xml]
----
&lt;dependencies&gt;

    &lt;dependency&gt;
        &lt;groupId&gt;com.querydsl&lt;/groupId&gt;
        &lt;artifactId&gt;querydsl-apt&lt;/artifactId&gt;
        &lt;version&gt;${querydsl.version}&lt;/version&gt;
        &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
        &lt;groupId&gt;com.querydsl&lt;/groupId&gt;
        &lt;artifactId&gt;querydsl-jpa&lt;/artifactId&gt;
        &lt;version&gt;${querydsl.version}&lt;/version&gt;
    &lt;/dependency&gt;

&lt;/dependencies&gt;
----

Next, configure the annotation processing tool (APT) plugin:

[source,xml]
----
&lt;project&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      ...
      &lt;plugin&gt;
        &lt;groupId&gt;com.mysema.maven&lt;/groupId&gt;
        &lt;artifactId&gt;apt-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.1.3&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;process&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
              &lt;outputDirectory&gt;target/generated-sources/java&lt;/outputDirectory&gt;
              &lt;processor&gt;com.querydsl.apt.jpa.JPAAnnotationProcessor&lt;/processor&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
      ...
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;
----

Here is an example from our sample application:

[source,java]
----
  public List&lt;DishEntity&gt; findDishes(DishSearchCriteriaTo criteria) {
    QDishEntity dish = QDishEntity.dishEntity;
    JPAQuery&lt;DishEntity&gt; query = new JPAQuery&lt;OrderEntity&gt;(getEntityManager());
    query.from(dish);

    Range&lt;BigDecimal&gt; priceRange = criteria.getPriceRange();
    if (priceRange != null) {
      BigDecimal min = priceRange.getMin();
      if (min != null) {
        query.where(dish.price.goe(min));
      }
      BigDecimal max = priceRange.getMax();
      if (max != null) {
        query.where(dish.price.loe(max));
      }
    }
    String name = criteria.getName();
    if ((name != null) &amp;&amp; (!name.isEmpty())) {
      query.where(dish.name.eq(name));
    }
    query.orderBy(dish.price.asc(), dish.name.asc());
    return query.fetch();
  }
----

In this example, we use the so called Q-types (`QDishEntity`). These are classes generated at build time by the Querydsl annotation processor from entity classes. The Q-type classes can be used as static types representative of the original entity class.

The `query.from(dish)` method call defines the query source, in this case the `dish` table. The `where` method defines a filter. For example, The first call uses the `goe` operator to filter out any dishes that are not greater or equal to the minimal price. Further operators can be found https://querydsl.com/static/querydsl/latest/apidocs/com/querydsl/core/types/dsl/ComparableExpression.html[here].

The `orderBy` method is used to sort the query results according to certain criteria. Here, we sort the results first by their price and then by their name, both in ascending order. To sort in descending order, use `.desc()`. To partition query results into groups of rows, see the https://querydsl.com/static/querydsl/latest/reference/html_single/#d0e377[groupBy] method.

For spring, devon4j provides another approach that you can use for your Spring applications to implement Querydsl logic without having to use these metaclasses. An example can be found xref:devonfw-guide_devon4j.wiki_spring_guide-querydsl-spring.asciidoc[here].

[[devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_native-queries]]
== Native Queries
Spring Data supports the use of _native queries_. Native queries use simple native SQL syntax that is not parsed in JPQL. This allows you to use all the features that your database supports.
The downside to this is that database portability is lost due to the absence of an abstraction layer. Therefore, the queries may not work with another database because it may use a different syntax.

You can implement a native query using `@Query` annotation with the `nativeQuery` attribute set to true:

[source,java]
----
@Query(value="...", nativeQuery=true)
----

NOTE: This will not work with Quarkus because Quarkus does not support native queries by using the `@Query` annotation (see xref:devonfw-guide_devon4j.wiki_guide-repository.asciidoc_limitations-in-quarkus[here]).

You can also implement native queries directly using the `EntityManager` API and the `createNativeQuery` method.
*This approach also works with Quarkus*.

[source,java]
----
Query query = entityManager.createNativeQuery("SELECT * FROM Product", ProductEntity.class);
List&lt;ProductEntity&gt; products = query.getResultList();
----

NOTE: Be sure to use the name of the table when using native queries, while you must use the entity name when implementing queries with JPQL.

[[devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_using-wildcards]]
== Using Wildcards
For flexible queries it is often required to allow wildcards (especially in xref:devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_dynamic_queries[dynamic queries]). While users intuitively expect glob syntax, the SQL and JPQL standards work differently. Therefore, a mapping is required. devonfw provides this on a lower level with https://github.com/devonfw/devon4j/blob/develop/modules/basic/src/main/java/com/devonfw/module/basic/common/api/query/LikePatternSyntax.java[LikePatternSyntax] and on a higher level with https://github.com/devonfw/devon4j/blob/develop/modules/jpa-basic/src/main/java/com/devonfw/module/jpa/dataaccess/api/QueryUtil.java#L54[QueryUtil] (see https://github.com/devonfw/devon4j/blob/develop/modules/jpa-basic/src/main/java/com/devonfw/module/jpa/dataaccess/api/QueryHelper.java#L199[QueryHelper.newStringClause(...)]).

[[devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_pagination]]
== Pagination
When dealing with large amounts of data, an efficient method of retrieving the data is required. Fetching the entire data set each time would be too time consuming. Instead, __Paging__ is used to process only small subsets of the entire data set.

If you are using xref:devonfw-guide_devon4j.wiki_guide-repository.asciidoc[Spring Data repositories] you will get pagination support out of the box by providing the interfaces https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Pageable.html[Page] and  https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Pageable.html[Pageable]:

.**repository**
[source,java]
----
Page&lt;DishEntity&gt; findAll(Pageable pageable);
----

Then you can create a Pageable object and pass it to the method call as follows:

[source,java]
----
int page = criteria.getPageNumber();
int size = criteria.getPageSize();
Pageable pageable = PageRequest.of(page, size);
Page&lt;DishEntity&gt; dishes = dishRepository.findAll(pageable);
----

[[devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_paging-with-querydsl]]
=== Paging with Querydsl

Pagination is also supported for dynamic queries with Querydsl:

[source,java]
----
  public Page&lt;DishEntity&gt; findDishes(DishSearchCriteriaTo criteria) {
    QDishEntity dish = QDishEntity.dishEntity;
    JPAQuery&lt;DishEntity&gt; query = new JPAQuery&lt;OrderEntity&gt;(getEntityManager());
    query.from(dish);

    // conditions

    int page = criteria.getPageNumber();
    int size = criteria.getPageSize();
    Pageable pageable = PageRequest.of(page, size);
    query.offset(pageable.getOffset());
    query.limit(pageable.getPageSize());

    List&lt;DishEntity&gt; dishes = query.fetch();
    return new PageImpl&lt;&gt;(dishes, pageable, dishes.size());
  }
----

[[devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_pagination-example]]
=== Pagination example
For the table entity we can make a search request by accessing the REST endpoint with pagination support like in the following examples:



[source,json]
----
POST mythaistar/services/rest/tablemanagement/v1/table/search
{
  "pagination": {
    "size":2,
    "total":true
  }
}

//Response
{
    "pagination": {
        "size": 2,
        "page": 1,
        "total": 11
    },
    "result": [
        {
            "id": 101,
            "modificationCounter": 1,
            "revision": null,
            "waiterId": null,
            "number": 1,
            "state": "OCCUPIED"
        },
        {
            "id": 102,
            "modificationCounter": 1,
            "revision": null,
            "waiterId": null,
            "number": 2,
            "state": "FREE"
        }
    ]
}
----

NOTE: As we are requesting with the `total` property set to `true` the server responds with the total count of rows for the query.

For retrieving a concrete page, we provide the `page` attribute with the desired value. Here we also left out the `total` property so the server doesn't incur on the effort to calculate it:

[source,json]
----
POST mythaistar/services/rest/tablemanagement/v1/table/search
{
  "pagination": {
    "size":2,
    "page":2
  }
}

//Response

{
    "pagination": {
        "size": 2,
        "page": 2,
        "total": null
    },
    "result": [
        {
            "id": 103,
            "modificationCounter": 1,
            "revision": null,
            "waiterId": null,
            "number": 3,
            "state": "FREE"
        },
        {
            "id": 104,
            "modificationCounter": 1,
            "revision": null,
            "waiterId": null,
            "number": 4,
            "state": "FREE"
        }
    ]
}
----

[[devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_pagingation-in-devon4j-spring]]
=== Pagingation in devon4j-spring
For spring applications, devon4j also offers its own solution for pagination. You can find an example of this xref:devonfw-guide_devon4j.wiki_spring_guide-querydsl-spring.asciidoc_pagination[here].

[[devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_query-meta-parameters]]
== Query Meta-Parameters
Queries can have meta-parameters and that are provided via `SearchCriteriaTo`. Besides paging (see above) we also get https://github.com/devonfw/devon4j/blob/develop/modules/jpa-basic/src/main/java/com/devonfw/module/jpa/dataaccess/api/QueryHelper.java#L51[timeout support].

[[devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_advanced-queries]]
== Advanced Queries
Writing queries can sometimes get rather complex. The current examples given above only showed very simple basics. Within this topic a lot of advanced features need to be considered like:

* https://www.w3schools.com/sql/sql_join.asp[Joins]
* https://docs.oracle.com/html/E13946_04/ejb3_langref.html#ejb3_langref_constructor[Constructor queries]
* https://www.w3schools.com/sql/sql_orderby.asp[Order By] (Sorting)
* https://www.w3schools.com/sql/sql_groupby.asp[Grouping]
* https://www.w3schools.com/sql/sql_having.asp[Having]
* https://www.w3schools.com/sql/sql_union.asp[Unions]
* https://docs.oracle.com/cd/E11035_01/kodo41/full/html/ejb3_langref.html#ejb3_langref_subqueries[Sub-Queries]
* Aggregation functions like e.g. https://www.w3schools.com/sql/sql_count_avg_sum.asp[count/avg/sum]
* https://www.w3schools.com/sql/sql_distinct.asp[Distinct selections]
* SQL Hints (see e.g. https://docs.oracle.com/cd/B19306_01/server.102/b14211/hintsref.htm#i8327[Oracle hints] or http://sqlhints.com/[SQL-Server hints]) - only when required for ultimate performance tuning

This list is just containing the most important aspects. As we can not cover all these topics here, they are linked to external documentation that can help and guide you.


:leveloffset: 2

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-repository.asciidoc]]
= Spring Data
https://projects.spring.io/spring-data-jpa/[Spring Data JPA] is supported by both Spring and Quarkus. However, in Quarkus this approach still has some limitations. For detailed information, see the official https://quarkus.io/guides/spring-data-jpa[Quarkus Spring Data guide].

[[devonfw-guide_devon4j.wiki_guide-repository.asciidoc_motivation]]
== Motivation
The benefits of Spring Data are (for examples and explanations see next sections):

* All you need is one single repository interface for each entity. No need for a separate implementation or other code artifacts like XML descriptors, `NamedQueries` class, etc.
* You have all information together in one place (the repository interface) that actually belong together (where as in the classic approach you have the static xref:devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc[queries] in an XML file, constants to them in `NamedQueries` class and referencing usages in DAO implementation classes).
* Static xref:devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc[queries] are most simple to realize as you do not need to write any method body. This means you can develop faster.
* Support for paging is already build-in. Again for static xref:devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc[query] method the is nothing you have to do except using the paging objects in the signature.
* Still you have the freedom to write custom implementations via default methods within the repository interface (e.g. for dynamic queries).

[[devonfw-guide_devon4j.wiki_guide-repository.asciidoc_dependency]]
== Dependency
In case you want to switch to or add Spring Data support to your Spring or Quarkus application, all you need is to add the respective maven dependency:

.**spring**
[source,xml]
--------
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
&lt;/dependency&gt;
--------

.**quarkus**
[source,xml]
--------
&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-spring-data-jpa&lt;/artifactId&gt;
&lt;/dependency&gt;
--------

[[devonfw-guide_devon4j.wiki_guide-repository.asciidoc_repository]]
== Repository
For each entity `«Entity»Entity` an interface is created with the name `«Entity»Repository` extending https://docs.spring.io/spring-data/jpa/docs/current/api/org/springframework/data/jpa/repository/JpaRepository.html[JpaRepository].
Such repository is the analogy to a xref:devonfw-guide_devon4j.wiki_guide-dao.asciidoc[Data-Access-Object (DAO)] used in the classic approach or when Spring Data is not an option.

.**Repository**
[source,java]
----
public interface ProductRepository extends JpaRepository&lt;ProductEntity, Long&gt; {

}
----

The Spring Data repository provides some basic implementations for accessing data, e.g. returning all instances of a type (`findAll`) or returning an instance by its ID (`findById`).

[[devonfw-guide_devon4j.wiki_guide-repository.asciidoc_custom-method-implementation]]
== Custom method implementation

In addition, repositories can be enriched with additional functionality, e.g. to add QueryDSL functionality or to override the default implementations, by using so called repository fragments:

[[devonfw-guide_devon4j.wiki_guide-repository.asciidoc_example]]
=== Example
The following example shows how to write such a repository:

.**Repository**
[source,java]
----
public interface ProductRepository extends JpaRepository&lt;ProductEntity, Long&gt;, ProductFragment {

  @Query("SELECT product FROM ProductEntity product" //
      + " WHERE product.title = :title")
  List&lt;ProductEntity&gt; findByTitle(@Param("title") String title);

  @Query("SELECT product FROM ProductEntity product" //
      + " WHERE product.title = :title")
  Page&lt;ProductEntity&gt; findByTitlePaginated(@Param("title") String title, Pageable pageable);
}
----

.**Repository fragment**
[source,java]
----
public interface ProductFragment {
  Page&lt;ProductEntity&gt; findByCriteria(ProductSearchCriteriaTo criteria);
}
----

.**Fragment implementation**
[source,java]
----
public class ProductFragmentImpl implements ProductFragment {
  @Inject
  EntityManager entityManager;

  public Page&lt;ProductEntity&gt; findByCriteria(ProductSearchCriteriaTo criteria) {
    QProductEntity product = QProductEntity.productEntity;
    JPAQuery&lt;ProductEntity&gt; query = new JPAQuery&lt;ProductEntity&gt;(this.entityManager);
    query.from(product);

    String title = criteria.getTitle();
    if ((title != null) &amp;&amp; !title.isEmpty()) {
      query.where(product.title.eq(title));
    }

    List&lt;ProductEntity&gt; products = query.fetch();
    return new PageImpl&lt;&gt;(products, PageRequest.of(criteria.getPageNumber(), criteria.getPageSize()), products.size());
  }
}
----

This `ProductRepository` has the following features:

* CRUD support from Spring Data (see https://docs.spring.io/spring-data/data-jpa/docs/current/api/org/springframework/data/jpa/repository/JpaRepository.html[JavaDoc] for details).
* Support for https://github.com/devonfw/devon4j/blob/develop/modules/jpa-spring-data/src/main/java/com/devonfw/module/jpa/dataaccess/api/data/QueryDslSupport.java[QueryDSL integration], https://github.com/devonfw/devon4j/blob/develop/modules/jpa-basic/src/main/java/com/devonfw/module/jpa/dataaccess/api/QueryUtil.java[paging and more].
* A static xref:devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc[query] method `findByTitle` to find all `ProductEntity` instances from DB that have the given title. Please note the `@Param` annotation that links the method parameter with the variable inside the query (`:title`).
* The same with pagination support via findByTitlePaginated method.
* A dynamic xref:devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc[query] method `findByCriteria` showing the QueryDSL and paging integration into Spring via a fragment implementation.

You can find an implementation of this `ProductRepository` in our https://github.com/devonfw-sample/devon4quarkus-reference/tree/master/src/main/java/com/devonfw/quarkus/productmanagement/domain/repo[Quarkus reference application].

NOTE: In Quarkus, native and named queries via the `@Query` annotation are currently not supported

[[devonfw-guide_devon4j.wiki_guide-repository.asciidoc_integration-of-spring-data-in-devon4j-spring]]
=== Integration of Spring Data in devon4j-spring

For Spring applications, devon4j offers a proprietary solution that integrates seamlessly with QueryDSL and uses default methods instead of the fragment approach. A separate guide for this can be found xref:devonfw-guide_devon4j.wiki_spring_guide-devon4j-spring-repository.asciidoc[here].

[[devonfw-guide_devon4j.wiki_guide-repository.asciidoc_custom-methods-without-fragment-approach]]
=== Custom methods without fragment approach

The fragment approach is a bit laborious, as three types (repository interface, fragment interface and fragment implementation) are always needed to implement custom methods.
We cannot simply use default methods within the repository because we cannot inject the `EntityManager` directly into the repository interface.

As a workaround, you can create a `GenericRepository` interface, as is done in the https://github.com/devonfw/devon4j/tree/master/modules/jpa-spring-data/src/main/java/com/devonfw/module/jpa/dataaccess/impl/data[devon4j jpa-spring-data module].

[source,java]
----
public interface GenericRepository&lt;E&gt; {

  EntityManager getEntityManager();

  ...
}
----

[source,java]
----
public class GenericRepositoryImpl&lt;E&gt; implements GenericRepository&lt;E&gt; {

  @Inject
  EntityManager entityManager;

  @Override
  public EntityManager getEntityManager() {

    return this.entityManager;
  }

  ...
}
----

Then, all your repository interfaces can extend the `GenericRepository` and you can implement queries directly in the repository interface using default methods:

[source,java]
----
public interface ProductRepository extends JpaRepository&lt;ProductEntity, Long&gt;, GenericRepository&lt;ProductEntity&gt; {

  default Page&lt;ProductEntity&gt; findByTitle(Title title) {

    EntityManager entityManager = getEntityManager();
    Query query = entityManager.createNativeQuery("select * from Product where title = :title", ProductEntity.class);
    query.setParameter("title", title);
    List&lt;ProductEntity&gt; products = query.getResultList();
    return new PageImpl&lt;&gt;(products);
  }

  ...
}
----

[[devonfw-guide_devon4j.wiki_guide-repository.asciidoc_drawbacks]]
== Drawbacks
Spring Data also has some drawbacks:

* Some kind of magic behind the scenes that are not so easy to understand. So in case you want to extend all your repositories without providing the implementation via a default method in a parent repository interface you need to deep-dive into Spring Data. We assume that you do not need that and hope what Spring Data and devon already provides out-of-the-box is already sufficient.
* The Spring Data magic also includes guessing the query from the method name. This is not easy to understand and especially to debug. Our suggestion is not to use this feature at all and either provide a `@Query` annotation or an implementation via default method.

[[devonfw-guide_devon4j.wiki_guide-repository.asciidoc_limitations-in-quarkus]]
== Limitations in Quarkus
* Native and named queries are not supported using `@Query` annotation. You will receive something like: __Build step io.quarkus.spring.data.deployment.SpringDataJPAProcessor#build threw an exception: java.lang.IllegalArgumentException: Attribute nativeQuery of @Query is currently not supported__
* Customizing the base repository for all repository interfaces in the code base, which is done in Spring Data by registering a class the extends `SimpleJpaRepository`

:leveloffset: 2

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-dao.asciidoc]]
= Data Access Object

The _Data Access Objects_ (DAOs) are part of the persistence layer.
They are responsible for a specific xref:devonfw-guide_devon4j.wiki_guide-dao.asciidoc_entity[entity] and should be named `«Entity»Dao` and `«Entity»DaoImpl`.
The DAO offers the so called CRUD-functionalities (create, retrieve, update, delete) for the corresponding entity.
Additionally a DAO may offer advanced operations such as xref:devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc[query] or locking methods.

[[devonfw-guide_devon4j.wiki_guide-dao.asciidoc_dao-interface]]
== DAO Interface
For each DAO there is an interface named `«Entity»Dao` that defines the API. For CRUD support and common naming we derive it from the `ApplicationDao` interface that comes with the devon application template:
[source,java]
----
public interface MyEntityDao extends ApplicationDao&lt;MyEntity&gt; {
  List&lt;MyEntity&gt; findByCriteria(MyEntitySearchCriteria criteria);
}
----
All CRUD operations are inherited from `ApplicationDao` so you only have to declare the additional methods.

[[devonfw-guide_devon4j.wiki_guide-dao.asciidoc_dao-implementation]]
== DAO Implementation
Implementing a DAO is quite simple. We create a class named `«Entity»DaoImpl` that extends `ApplicationDaoImpl` and implements your `«Entity»Dao` interface:
[source,java]
----
public class MyEntityDaoImpl extends ApplicationDaoImpl&lt;MyEntity&gt; implements MyEntityDao {

  public List&lt;MyEntity&gt; findByCriteria(MyEntitySearchCriteria criteria) {
    TypedQuery&lt;MyEntity&gt; query = createQuery(criteria, getEntityManager());
    return query.getResultList();
  }
  ...
}
----

Again you only need to implement the additional non-CRUD methods that you have declared in your `«Entity»Dao` interface.
In the DAO implementation you can use the method `getEntityManager()` to access the `EntityManager` from the JPA. You will need the `EntityManager` to create and execute xref:devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc[queries].

[[devonfw-guide_devon4j.wiki_guide-dao.asciidoc_static-queries-for-dao-implementation]]
=== Static queries for DAO Implementation
All static xref:devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc[queries] are declared in the file `src\main\resources\META-INF\orm.xml`:
[source,xml]
----
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;entity-mappings version="1.0" xmlns="http://java.sun.com/xml/ns/persistence/orm" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm http://java.sun.com/xml/ns/persistence/orm_1_0.xsd"&gt;
  &lt;named-query name="find.dish.with.max.price"&gt;
    &lt;query&gt;&lt;![SELECT dish FROM DishEntity dish WHERE dish.price &lt;= :maxPrice]]&gt;&lt;/query&gt;
  &lt;/named-query&gt;
  ...
&lt;/hibernate-mapping&gt;
----
When your application is started, all these static queries will be created as prepared statements. This allows better performance and also ensures that you get errors for invalid JPQL queries when you start your app rather than later when the query is used.

To avoid redundant occurrences of the query name (`get.open.order.positions.for.order`) we define a constant for each named query:
[source,java]
----
public class NamedQueries {
  public static final String FIND_DISH_WITH_MAX_PRICE = "find.dish.with.max.price";
}
----
Note that changing the name of the java constant (`FIND_DISH_WITH_MAX_PRICE`) can be done easily with refactoring. Further you can trace where the query is used by searching the references of the constant.

The following listing shows how to use this query:
[source,java]
----
public List&lt;DishEntity&gt; findDishByMaxPrice(BigDecimal maxPrice) {
  Query query = getEntityManager().createNamedQuery(NamedQueries.FIND_DISH_WITH_MAX_PRICE);
  query.setParameter("maxPrice", maxPrice);
  return query.getResultList();
}
----
Via `EntityManager.createNamedQuery(String)` we create an instance of `Query` for our predefined static query.
Next we use `setParameter(String, Object)` to provide a parameter (`maxPrice`) to the query. This has to be done for all parameters of the query.

Note that using the `createQuery(String)` method, which takes the entire query as string (that may already contain the parameter) is not allowed to avoid SQL injection vulnerabilities.
When the method `getResultList()` is invoked, the query is executed and the result is delivered as `List`. As an alternative, there is a method called `getSingleResult()`, which returns the entity if the query returned exactly one and throws an exception otherwise.

:leveloffset: 2

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-jpa-performance.asciidoc]]
= JPA Performance
When using JPA the developer sometimes does not see or understand where and when statements to the database are triggered.
[quote, Dan Allen, https://epdf.tips/seam-in-action.html]
____
Establishing expectations Developers shouldn’t expect to sprinkle magic pixie dust on POJOs in hopes they will become persistent.
____
So in case you do not understand what is going on under the hood of JPA, you will easily run into performance issues due to lazy loading and other effects.

[[devonfw-guide_devon4j.wiki_guide-jpa-performance.asciidoc_n-plus-1-problem]]
== N plus 1 Problem
The most prominent phenomena is call the `N+1 Problem`.
We use entities from our https://github.com/devonfw/my-thai-star[MTS] demo app as an example to explain the problem.
There is a https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/java/com/devonfw/application/mtsj/dishmanagement/dataaccess/api/DishEntity.java[DishEntity] that has a `@ManyToMany` relation to
https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/java/com/devonfw/application/mtsj/dishmanagement/dataaccess/api/IngredientEntity.java[IngredientEntity].
Now we assume that we want to iterate all ingredients for a dish like this:
[source,java]
----
DishEntity dish = dao.findDishById(dishId);
BigDecimal priceWithAllExtras = dish.getPrice();
for (IngredientEntity ingredient : dish.getExtras()) {
  priceWithAllExtras = priceWithAllExtras.add(ingredient.getPrice());
}
----

Now `dish.getExtras()` is loaded lazy. Therefore the JPA vendor will provide a list with lazy initialized instances of `IngredientEntity` that only contain the ID of that entity. Now with every call of `ingredient.getPrice()` we technically trigger an SQL query statement to load the specific `IngredientEntity` by its ID from the database.
Now `findDishById` caused 1 initial query statement and for any number `N` of ingredients we are causing an additional query statement. This makes a total of `N+1` statements. As causing statements to the database is an expensive operation with a lot of overhead (creating connection, etc.) this ends in bad performance and is therefore a problem (the N+1 Problem).

[[devonfw-guide_devon4j.wiki_guide-jpa-performance.asciidoc_solving-n-plus-1-problem]]
== Solving N plus 1 Problem
To solve the N+1 Problem you need to change your code to only trigger a single statement instead. This can be archived in various ways. The most universal solution is to use `FETCH JOIN` in order to pre-load the nested `N` child entities into the first level cache of the JPA vendor implementation. This will behave very similar as if the `@ManyToMany` relation to `IngredientEntity` was having `FetchType.EAGER` but only for the specific query and not in general. Because changing `@ManyToMany` to `FetchType.EAGER` would cause bad performance for other usecases where only the dish but not its extra ingredients are needed. For this reason all relations, including `@OneToOne` should always be `FetchType.LAZY`. Back to our example we simply replace `dao.findDishById(dishId)` with `dao.findDishWithExtrasById(dishId)` that we implement by the following JPQL query:
[source,sql]
----
SELECT dish FROM DishEntity dish
  LEFT JOIN FETCH dish.extras
  WHERE dish.id = :dishId
----
The rest of the code does not have to be changed but now `dish.getExtras()` will get the `IngredientEntity` from the first level cache where is was fetched by the initial query above.

Please note that if you only need the sum of the prices from the extras you can also create a query using an aggregator function:
----
SELECT sum(dish.extras.price) FROM DishEntity dish
----
As you can see you need to understand the concepts in order to get good performance.

There are many advanced topics such as creating database indexes or calculating statistics for the query optimizer to get the best performance. For such advanced topics we recommend to have a database expert in your team that cares about such things. However, understanding the _N+1 Problem_ and its solutions is something that every Java developer in the team needs to understand.

:leveloffset: 2

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-jpa-idref.asciidoc]]
= IdRef

IdRef can be used to reference other entities in TOs in order to make them type-safe and semantically more expressive.
It is an optional concept in devon4j for more complex applications that make intensive use of relations and foreign keys.

[[devonfw-guide_devon4j.wiki_guide-jpa-idref.asciidoc_motivation]]
== Motivation

Assuming you have a method signature like the following:
[source,java]
----
Long approve(Long cId, Long cuId);
----

So what are the paremeters? What is returned?

`IdRef` is just a wrapper for a Long used as foreign key. This makes our signature much more expressive and self-explanatory:

[source,java]
----
IdRef&lt;Contract&gt; approve(IdRef&lt;Contract&gt; cId, IdRef&lt;Customer&gt; cuId);
----

Now we can easily see, that the result and the parameters are foreign-keys and which entity they are referring to via their generic type.
We can read the javadoc of these entities from the generic type and understand the context.
Finally, when passing `IdRef` objects to such methods, we get compile errors in case we accidentally place parameters in the wrong order.

[[devonfw-guide_devon4j.wiki_guide-jpa-idref.asciidoc_idref-and-mapping]]
== IdRef and Mapping

In order to easily map relations from entities to xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc[transfer-objects] and back, we can easily also put according getters and setters into our entities:

[source,java]
----
public class ContractEntity extends ApplicationPersistenceEntity implements Contract {

  private CustomerEntity customer;

  ...

  @ManyToOne(fetch = FetchType.LAZY)
  @JoinColumn(name = "CUSTOMER_ID")
  public CustomerEntity getCustomer() {
    return this.customer;
  }

  public void setCustomer(CustomerEntity customer) {
    this.customer = customer;
  }

  @Transient
  public IdRef&lt;Customer&gt; getCustomerId() {
    return IdRef.of(this.customer);
  }

  public void setCustomerId(IdRef&lt;Customer&gt; customerId) {
    this.customer = JpaHelper.asEntity(customerId, CustomerEntity.class);
  }
}
----

Now, ensure that you have the same getters and setters for `customerId` in your `Eto`:

[source,java]
----
public class ContractEto extends AbstractEto implements Contract {

  private IdRef&lt;Customer&gt; customerId;

  ...

  public IdRef&lt;Customer&gt; getCustomerId() {
    return this.customerId;
  }

  public void setCustomerId(IdRef&lt;Customer&gt; customerId) {
    this.customerId = customerId;
  }
}
----

This way the bean-mapper can automatically map from your entity (`ContractEntity`) to your Eto (`ContractEto`) and vice-versa.

[[devonfw-guide_devon4j.wiki_guide-jpa-idref.asciidoc_jpahelper-and-entitymanager-access]]
== JpaHelper and EntityManager access

In the above example we used `JpaHelper.asEntity` to convert the foreign key (`IdRef&lt;Customer&gt;`) to the according entity (`CustomerEntity`).
This will internally use `EntityManager.getReference` to properly create a JPA entity.
The alternative "solution" that may be used with `Long` instead of `IdRef` is typically:
[source,java]
----
  public void setCustomerId(IdRef&lt;Customer&gt; customerId) {
    Long id = null;
    if (customerId != null) {
      id = customerId.getId();
    }
    if (id == null) {
      this.customer = null;
    } else {
      this.customer = new CustomerEntity();
      this.customer.setId(id);
    }
  }
----

While this "solution" works is most cases, we discovered some more complex cases, where it fails with very strange hibernate exceptions.
When cleanly creating the entity via `EntityManager.getReference` instead it is working in all cases.
So how can `JpaHelper.asEntity` as a static method access the `EntityManager`?
Therefore we need to initialize this as otherwise you may see this exception:</code></pre>
</div>
</div>
<div class="paragraph">
<p>java.lang.IllegalStateException: EntityManager has not yet been initialized!
	at com.devonfw.module.jpa.dataaccess.api.JpaEntityManagerAccess.getEntityManager(JpaEntityManagerAccess.java:38)
	at com.devonfw.module.jpa.dataaccess.api.JpaHelper.asEntity(JpaHelper.java:49)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>For main usage in your application we assume that there is only one instance of `EntityManager`.
Therefore we can initialize this instance during the spring boot setup.
This is what we provide for you in https://github.com/devonfw/devon4j/blob/master/modules/jpa-basic/src/main/java/com/devonfw/module/jpa/dataaccess/api/JpaInitializer.java[JpaInitializer] for you
when xref:devonfw-guide_devon4j.wiki_tutorial-newapp.asciidoc[creating a devon4j app].

[[devonfw-guide_devon4j.wiki_guide-jpa-idref.asciidoc_jpahelper-and-spring-test]]
=== JpaHelper and spring-test

Further, you also want your code to work in integration tests.
Spring-test provides a lot of magic under the hood to make integration testing easy for you.
To boost the performance when running multiple tests, spring is smart and avoids creating the same spring-context multiple times.
Therefore it stores these contexts so that if a test-case is executed with a specific spring-configuration that has already been setup before,
the same spring-context can be reused instead of creating it again.
However, your tests may have multiple spring configurations leading to multiple spring-contexts.
Even worse these tests can run in any order leading to switching between spring-contexts forth and back.
Therefore, a static initializer during the spring boot setup can lead to strange errors as you can get the wrong `EntityManager` instance.
In order to fix such problems, we provide a solution pattern via https://github.com/devonfw/devon4j/blob/master/modules/test-jpa/src/main/java/com/devonfw/module/test/common/base/DbTest.java#L32[DbTest] ensuring for every test,
that the proper instance of `EntityManager` is initialized.
Therefore you should derive directly or indirectly (e.g. via `ComponentDbTest` and `SubsystemDbTest`) from `DbTesT` or adopt your own way to apply this pattern to your tests, when using `JpaHelper`.
This already happens if you are extending `ApplicationComponentTest` or `ApplicationSubsystemTest`.

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-transactions.asciidoc]]
= Transaction Handling

For transaction handling we xref:devonfw-guide_devon4j.wiki_guide-aop.asciidoc[AOP] to add transaction control via annotations as aspect.
This is done by annotating your code with the `@Transactional` annotation.
You can either annotate your xref:devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc_key-principles[container bean] at class level to make all methods transactional or your can annotate individual methods to make them transactional:

[source,java]
----
  @Transactional
  public Output getData(Input input) {
    ...
  }
----

[[devonfw-guide_devon4j.wiki_guide-transactions.asciidoc_jta-imports]]
== JTA Imports
Here are the import statements for transaction support:
[source, java]
----
import javax.transaction.Transactional;
----

CAUTION: Use the above import statement to follow JEE and avoid using `org.springframework.transaction.annotation.Transactional`.

[[devonfw-guide_devon4j.wiki_guide-transactions.asciidoc_jta-dependencies]]
== JTA Dependencies
Please note that with https://jakarta.ee/[Jakarta EE] the dependencies have changed.
When you want to start with Jakarta EE you should use these dependencies to get the annoations for dependency injection:

[source, xml]
----
&lt;!-- Java Transaction API (JTA) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;jakarta.transaction&lt;/groupId&gt;
  &lt;artifactId&gt;jakarta.transaction-api&lt;/artifactId&gt;
&lt;/dependency&gt;
----

Please note that with xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[quarkus] you will get them as transitive dependencies out of the box.
The above Jakarate EE dependencies replace these JEE depdencies:

[source, xml]
----
&lt;!-- Java Transaction API (JTA) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;javax.transaction&lt;/groupId&gt;
  &lt;artifactId&gt;javax.transaction-api&lt;/artifactId&gt;
&lt;/dependency&gt;
----

[[devonfw-guide_devon4j.wiki_guide-transactions.asciidoc_handling-constraint-violations]]
== Handling constraint violations
Using `@Transactional` magically wraps transaction handling around your code.
As constraints are checked by the database at the end when the transaction gets committed, a constraint violation will be thrown by this aspect outside your code.
In case you have to handle constraint violations manually, you have to do that in code outside the logic that is annotated with `@Transactional`.
This may be done in a xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[service operation] by catching a `ConstraintViolationException` (`org.hibernate.exception.ConstraintViolationException` for hibernate).
As a generic approach you can solve this via xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc_rest-exception-handling[REST execption handling].

[[devonfw-guide_devon4j.wiki_guide-transactions.asciidoc_batches]]
== Batches
Transaction control for batches is a lot more complicated and is described in the xref:devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc[batch layer].

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-sql.asciidoc]]
= SQL

For general guides on dealing or avoiding SQL, preventing SQL-injection, etc. you should study xref:devonfw-guide_devon4j.wiki_guide-domain-layer.asciidoc[domain layer].

[[devonfw-guide_devon4j.wiki_guide-sql.asciidoc_naming-conventions]]
== Naming Conventions

Here we define naming conventions that you should follow whenever you write SQL files:

* All SQL-Keywords in UPPER CASE
* Indentation should be 2 spaces as suggested by devonfw for every format.

[[devonfw-guide_devon4j.wiki_guide-sql.asciidoc_ddl]]
=== DDL
The naming conventions for database constructs (tables, columns, triggers, constraints, etc.) should be aligned with your database product and their operators.
However, when you have the freedom of choice and a modern case-sensitive database, you can simply use your code conventions also for database constructs to avoid explicitly mapping each and every property (e.g. `RestaurantTable` vs. `RESTAURANT_TABLE`).

* Define columns and constraints inline in the statement to create the table
* Indent column types so they all start in the same text column
* Constraints should be named explicitly (to get a reasonable hint error messages) with:
** `PK_«table»` for primary key (name optional here as PK constraint are fundamental)
** `FK_«table»_«property»` for foreign keys (`«table»` and `«property»` are both on the source where the foreign key is defined)
** `+UC_«table»_«property»[_«propertyN»]*+` for unique constraints
** `CK_«table»_«check»` for check constraints (`«check»` describes the check, if it is defined on a single property it should start with the property).
* Old RDBMS had hard limitations for names (e.g. 30 characters). Please note that recent databases have overcome this very low length limitations. However, keep your names short but precise and try to define common abbreviations in your project for according (business) terms. Especially do not just truncate the names at the limit.
* If possible add comments on table and columns to help DBAs understanding your schema. This is also honored by many tools (not only DBA-tools).

Here is a brief example of a DDL:
[source,sql]
--------
CREATE SEQUENCE HIBERNATE_SEQUENCE START WITH 1000000;

-- *** Table ***
CREATE TABLE RESTAURANT_TABLE (
  ID                   NUMBER(19) NOT NULL,
  MODIFICATION_COUNTER INTEGER NOT NULL,
  SEATS                INTEGER NOT NULL,
  CONSTRAINT PK_TABLE PRIMARY KEY(ID)
);
COMMENT ON TABLE RESTAURANT_TABLE IS 'The physical tables inside the restaurant.';
-- *** Order ***
CREATE TABLE RESTAURANT_ORDER (
  ID                   NUMBER(19) NOT NULL,
  MODIFICATION_COUNTER INTEGER NOT NULL,
  TABLE_ID             NUMBER(19) NOT NULL,
  TOTAL                DECIMAL(5, 2) NOT NULL,
  CREATION_DATE        TIMESTAMP NOT NULL,
  PAYMENT_DATE         TIMESTAMP,
  STATUS               VARCHAR2(10 CHAR) NOT NULL,
  CONSTRAINT PK_ORDER PRIMARY KEY(ID),
  CONSTRAINT FK_ORDER_TABLE_ID FOREIGN KEY(TABLE_ID) REFERENCES RESTAURANT_TABLE(ID)
);
COMMENT ON TABLE RESTAURANT_ORDER IS 'An order and bill at the restaurant.';
...
--------

ATTENTION: Please note that `TABLE` and `ORDER` are reserved keywords in SQL and you should avoid using such keywords to prevent problems.

[[devonfw-guide_devon4j.wiki_guide-sql.asciidoc_data]]
=== Data
For insert, update, delete, etc. of data SQL scripts should additionally follow these guidelines:

* Inserts always with the same order of columns in blocks for each table.
* Insert column values always starting with ID, MODIFICATION_COUNTER, [DTYPE, ] ...
* List columns with fixed length values (boolean, number, enums, etc.) before columns with free text to support alignment of multiple insert statements
* Pro Tip: Get familiar with column mode of advanced editors such as `+notepad+++` when editing large blocks of similar insert statements.

[source,sql]
--------
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (0, 1, 4);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (1, 1, 4);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (2, 1, 4);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (3, 1, 4);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (4, 1, 6);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (5, 1, 6);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (6, 1, 6);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (7, 1, 8);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (8, 1, 8);
...
--------


See also xref:devonfw-guide_devon4j.wiki_guide-database-migration.asciidoc[Database Migrations].

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-database-migration.asciidoc]]
= Database Migration

When you have a schema-based https://github.com/devonfw/devonfw-guide/blob/master/general/db/guide-database.asciidoc[database],
you need a solution for schema versioning and migration for your database.
A specific release of your app requires a corresponding version of the schema in the database to run.
As you want simple and continuous deployment you should automate the schema versiong and database migration.

The general idea is that your software product contains "scripts" to migrate the database from schema version `X` to verion `X+1`.
When you begin your project you start with version `1` and with every increment of your app that needs a change to the database schema (e.g. a new table, a new column to an existing table, a new index, etc.) you add another "script" that migrates from the current to the next version.
For simplicity these versions are just sequential numbers or timestamps.
Now, the solution you choose will automatically manage the schema version in a separate metadata table in your database that stores the current schema version.
When your app is started, it will check the current version inside the database from that metadata table.
As long as there are "scripts" that migrate from there to a higher version, they will be automatically applied to the database and this process is protocolled to the metadata table in your database what also updates the current schema version there.
Using this approach, you can start with an empty database what will result in all "scripts" being applied sequentially.
Also any version of your database schema can be present and you will always end up in a controlled migration to the latest schema version.

[[devonfw-guide_devon4j.wiki_guide-database-migration.asciidoc_options-for-database-migration]]
== Options for database migration

For database migration you can choose between the following options:

* xref:devonfw-guide_devon4j.wiki_guide-flyway.asciidoc[flyway] (KISS based approach with migrations as SQL)
* xref:devonfw-guide_devon4j.wiki_guide-liquibase.asciidoc[liquibase] (more complex approach with database abstraction)

:leveloffset: 2

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-flyway.asciidoc]]
= Flyway

http://flywaydb.org/[Flyway] is a tool for xref:devonfw-guide_devon4j.wiki_guide-database-migration.asciidoc[database migration and schema versioning].
See https://flywaydb.org/getstarted/why[why] for a motivation why using flyway.

Flyway can be used standalone e.g. via https://flywaydb.org/documentation/getstarted/firststeps/maven[flyway-maven-plugin] or can be integrated directly into your app to make sure the database migration takes place on startup.
For simplicity we recommend to integrate flyway into your app.
However, you need to be aware that therefore your app needs database access with full schema owner permissions.

[[devonfw-guide_devon4j.wiki_guide-flyway.asciidoc_organizational-advice]]
== Organizational Advice
A few considerations with respect to project organization will help to implement maintainable Flyway migrations.

At first, testing and production environments must be clearly and consistently distinguished. Use the following directory structure to achieve this distinction:
[source, text]
----
  src/main/resources/db
  src/test/resources/db
----
Although this structure introduces redundancies, the benefit outweighs this disadvantage.
An even more fine-grained production directory structure which contains one sub folder per release should be implemented:
[source, text]
----
  src/main/resources/db/migration/releases/X.Y/x.sql
----
Emphasizing that migration scripts below the current version must never be changed will aid the second advantage of migrations: it will always be clearly reproducible in which state the database currently is.
Here, it is important to mention that, if test data is required, it must be managed separately from the migration data in the following directory:
[source, text]
----
  src/test/resources/db/migration/
----
The `migration` directory is added to aid easy usage of Flyway defaults.
Of course, test data should also be managed per release as like production data.

With regard to content, separation of concerns (SoC) is an important goal. SoC can be achieved by distinguishing and writing multiple scripts with respect to business components/use cases (or database tables in case of large volumes of master data footnote:["Stammdaten" in German.]. Comprehensible file names aid this separation.

It is important to have clear responsibilities regarding the database, the persistence layer (JPA), and migrations. Therefore a dedicated database expert should be in charge of any migrations performed or she should at least be informed before any change to any of the mentioned parts is applied.

[[devonfw-guide_devon4j.wiki_guide-flyway.asciidoc_technical-configuration]]
== Technical Configuration
Database migrations can be https://flywaydb.org/documentation/concepts/migrations#sql-based-migrations[SQL] based or https://flywaydb.org/documentation/concepts/migrations#java-based-migrations[Java] based.

To enable auto migration on startup (not recommended for productive environment) set the following property in the `application.properties` file for an environment.
[source, properties]
----
flyway.enabled=true
flyway.clean-on-validation-error=false
----
For development environment it is helpful to set both properties to `true` in order to simplify development. For regular environments `+flyway.clean-on-validation-error+` should be `false`.

If you want to use Flyway set the following property in any case to prevent Hibernate from doing changes on the database (pre-configured by default in devonfw):

[source, properties]
----
spring.jpa.hibernate.ddl-auto=validate
----
//Changed her to their to generalize it.
The setting must be communicated to and coordinated with the customer and their needs.
In acceptance testing the same configuration as for the production environment should be enabled.

Since migration scripts will also be versioned the end-of-line (EOL) style must be fixated according to https://github.com/flyway/flyway/issues/253[this issue]. This is however solved in flyway 4.0+ and the latest devonfw release.
Also, the version numbers of migration scripts should not consist of simple ascending integer numbers like V0001__..., V0002__..., ... This naming may lead to problems when merging branches. Instead the usage of timestamps as version numbers will help to avoid such problems.

[[devonfw-guide_devon4j.wiki_guide-flyway.asciidoc_naming-conventions]]
== Naming Conventions
Database migrations should follow this naming convention:
V&lt;version&gt;\__&lt;description&gt; (e.g.: V12345__Add_new_table.sql).

It is also possible to use Flyway for test data. To do so place your test data migrations in +src/main/resources/db/testdata/+ and set property

[source, properties]
----
flyway.locations=classpath:db/migration/releases,classpath:db/migration/testdata
----
Then Flyway scans the additional location for migrations and applies all in the order specified by their version. If migrations +V0001__...+ and +V0002__...+ exist and a test data migration should be applied in between you can name it +V0001_1__...+.

:leveloffset: 2

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-liquibase.asciidoc]]
= Liquibase

https://www.liquibase.org/[Liquibase] is a tool for xref:devonfw-guide_devon4j.wiki_guide-database-migration.asciidoc[database migration and schema versioning].

See https://github.com/devonfw/devon4j/issues/303[devon4j#303] for details and status.

[[devonfw-guide_devon4j.wiki_guide-liquibase.asciidoc_spring-boot-usage]]
== Spring-boot usage

For using liquibase in xref:devonfw-guide_devon4j.wiki_spring.asciidoc[spring] see https://docs.liquibase.com/tools-integrations/springboot/springboot.html[Using Liquibase with Spring Boot].

[[devonfw-guide_devon4j.wiki_guide-liquibase.asciidoc_quarkus-usage]]
== Quarkus usage

For uisng liquibase in xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[quarkus] see https://quarkus.io/guides/liquibase[Using Liquibase].

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-rest.asciidoc]]
= REST
REST (https://en.wikipedia.org/wiki/Representational_state_transfer[REpresentational State Transfer]) is an inter-operable protocol for xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[services] that is more lightweight than xref:devonfw-guide_devon4j.wiki_guide-soap.asciidoc[SOAP].
However, it is no real standard and can cause confusion (see xref:devonfw-guide/devon4j.wiki_https://github.com/devonfw/devon4j/blob/master/documentation/guide-rest-philosophy[REST philosophy]).
Therefore we define best practices here to guide you.

[[devonfw-guide_devon4j.wiki_guide-rest.asciidoc_urls]]
== URLs
URLs are not case sensitive. Hence, we follow the best practice to use only lower-case-letters-with-hyphen-to-separate-words.
For operations in REST we distinguish the following types of URLs:

* A _collection URL_ is build from the rest service URL by appending the name of a collection. This is typically the name of an entity. Such URL identifies the entire collection of all elements of this type. Example: `\https://mydomain.com/myapp/services/rest/mycomponent/v1/myentity`
* An _element URL_ is build from a collection URL by appending an element ID. It identifies a single element (entity) within the collection. Example: `\https://mydomain.com/myapp/services/rest/mycomponent/v1/myentity/42`

To follow KISS avoid using plural forms (`.../productmanagement/v1/products` vs. `.../productmanagement/v1/product/42`). Always use singular forms and avoid confusions (except for the rare cases where no singular exists).

The REST URL scheme fits perfect for https://en.wikipedia.org/wiki/Create,_read,_update_and_delete[CRUD] operations.
For business operations (processing, calculation, advanced search, etc.) we simply append a collection URL with the name of the business operation.
Then we can `POST` the input for the business operation and get the result back. Example: `\https://mydomain.com/myapp/services/rest/mycomponent/v1/myentity/search`

[[devonfw-guide_devon4j.wiki_guide-rest.asciidoc_http-methods]]
== HTTP Methods
The following table defines the HTTP methods (verbs) and their meaning:

.Usage of HTTP methods
[options="header"]
|=======================
|*HTTP Method*|*Meaning*
|`GET`        .&lt;|Read data (stateless).
|`PUT`        .&lt;|Create or update data.
|`POST`       .&lt;|Process data.
|`DELETE`     .&lt;|Delete an entity.
|=======================

Please also note that for (large) bulk deletions you may be forced to used `POST` instead of `DELETE` as according to the HTTP standard `DELETE` must not have payload and URLs are limited in length.

For general recommendations on HTTP methods for collection and element URLs see http://en.wikipedia.org/wiki/Representational_State_Transfer#Applied_to_web_services[REST@wikipedia].

[[devonfw-guide_devon4j.wiki_guide-rest.asciidoc_http-status-codes]]
== HTTP Status Codes
Further we define how to use the HTTP status codes for REST services properly. In general the 4xx codes correspond to an error on the client side and the 5xx codes to an error on the server side.

.Usage of HTTP status codes
[options="header"]
|=======================
|*HTTP Code*  |*Meaning*   |*Response*       |*Comment*
|200          |OK          |requested result |Result of successful GET
|204          |No Content  |_none_           |Result of successful POST, DELETE, or PUT with empty result (void return)
|400          |Bad Request |error details    |The HTTP request is invalid (parse error, validation failed)
|401          |Unauthorized|_none_           |Authentication failed
|403          |Forbidden   |_none_           |Authorization failed
|404          |Not found   |_none_           |Either the service URL is wrong or the requested resource does not exist
|500          |Server Error|error code, UUID |Internal server error occurred, in case of an exception, see xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc_rest-exception-handling[REST exception handling]
|=======================

[[devonfw-guide_devon4j.wiki_guide-rest.asciidoc_jax-rs]]
== JAX-RS
For implementing REST services we use the https://jax-rs-spec.java.net/[JAX-RS] standard.
As payload encoding we recommend xref:devonfw-guide_devon4j.wiki_guide-json.asciidoc[JSON] bindings using http://wiki.fasterxml.com/JacksonHome[Jackson].
To implement a REST service you simply add JAX-RS annotations.
Here is a simple example:
[source,java]
--------
@ApplicationScoped
@Path("/imagemanagement/v1")
@Consumes(MediaType.APPLICATION_JSON)
@Produces(MediaType.APPLICATION_JSON)
public class ImagemanagementRestService {

  @Inject
  private Imagemanagement imagemanagement;

  @GET
  @Path("/image/{id}/")
  public ImageDto getImage(@PathParam("id") long id) {

    return this.imagemanagement.findImage(id);
  }
}
--------

Here we can see a REST service for the xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_business-architecture[business component] `imagemanagement`. The method `getImage` can be accessed via HTTP GET (see `@GET`) under the URL path `imagemanagement/image/{id}` (see `@Path` annotations) where `{id}` is the ID of the requested table and will be extracted from the URL and provided as parameter `id` to the method `getImage`. It will return its result (`ImageDto`) as xref:devonfw-guide_devon4j.wiki_guide-json.asciidoc[JSON] (see `@Produces` annotation - you can also extend `RestService` marker interface that defines these annotations for JSON). As you can see it delegates to the xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc[logic] component `imagemanagement` that contains the actual business logic while the service itself only exposes this logic via HTTP. The REST service implementation is a regular CDI bean that can use xref:devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc[dependency injection].

NOTE: With JAX-RS it is important to make sure that each service method is annotated with the proper HTTP method (`@GET`,`@POST`,etc.) to avoid unnecessary debugging. So you should take care not to forget to specify one of these annotations.

[[devonfw-guide_devon4j.wiki_guide-rest.asciidoc_service-interface]]
=== Service-Interface

You may also separate API and implementation in case you want to reuse the API for xref:devonfw-guide_devon4j.wiki_guide-service-client.asciidoc[service-client]:

[source,java]
--------
@Path("/imagemanagement/v1")
@Consumes(MediaType.APPLICATION_JSON)
@Produces(MediaType.APPLICATION_JSON)
public interface ImagemanagementRestService {

  @GET
  @Path("/image/{id}/")
  ImageEto getImage(@PathParam("id") long id);

}

@Named("ImagemanagementRestService")
public class ImagemanagementRestServiceImpl implements ImagemanagementRestService {

  @Override
  public ImageEto getImage(long id) {

    return this.imagemanagement.findImage(id);
  }

}
--------

[[devonfw-guide_devon4j.wiki_guide-rest.asciidoc_jax-rs-configuration]]
=== JAX-RS Configuration
Starting from CXF 3.0.0 it is possible to enable the auto-discovery of JAX-RS roots.

When the JAX-RS server is instantiated, all the scanned root and provider beans (beans annotated with `javax.ws.rs.Path` and `javax.ws.rs.ext.Provider`) are configured.

[[devonfw-guide_devon4j.wiki_guide-rest.asciidoc_rest-exception-handling]]
=== REST Exception Handling
For exceptions, a service needs to have an exception facade that catches all exceptions and handles them by writing proper log messages and mapping them to a HTTP response with an corresponding xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc_http-status-codes[HTTP status code].
For this, devon4j provides a generic solution via `RestServiceExceptionFacade` that you can use within your Spring applications. You need to follow the xref:devonfw-guide_devon4j.wiki_guide-exceptions.asciidoc[exception guide] in order for it to work out of the box because the facade needs to be able to distinguish between business and technical exceptions.
To implement a generic exception facade in Quarkus, follow the xref:devonfw-guide_devon4j.wiki_quarkus_guide-exception-handling.asciidoc[Quarkus exception guide].

Now your service may throw exceptions, but the facade will automatically handle them for you.

The general format for returning an error to the client is as follows:

[source,javascript]
----
{
  "message": "A human-readable message describing the error",
  "code": "A code identifying the concrete error",
  "uuid": "An identifier (generally the correlation id) to help identify corresponding requests in logs"
}
----

[[devonfw-guide_devon4j.wiki_guide-rest.asciidoc_pagination-details]]
=== Pagination details
We recommend to use xref:devonfw-guide_devon4j.wiki_guide-repository.asciidoc[spring-data repositories] for database access that already comes with pagination support.
Therefore, when performing a search, you can include a https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Pageable.html[Pageable] object.
Here is a JSON example for it:
[source,javascript]
----
{ "pageSize": 20, "pageNumber": 0, "sort": [] }
----

By increasing the `pageNumber` the client can browse and page through the hits.

As a result you will receive a https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Page.html[Page].
It is a container for your search results just like a `Collection` but additionally contains pagination information for the client.
Here is a JSON example:
[source,javascript]
----
{ "totalElements": 1022,
  pageable: { "pageSize": 20, "pageNumber": 0 },
  content: [ ... ] }
----

The `totalElements` property contains the total number of hits.
This can be used by the client to compute the total number of pages and render the pagination links accordingly.
Via the `pageable` property the client gets back the `Pageable` properties from the search request.
The actual hits for the current page are returned as array in the `content` property.

[[devonfw-guide_devon4j.wiki_guide-rest.asciidoc_rest-testing]]
== REST Testing
For testing REST services in general consult the xref:devonfw-guide_devon4j.wiki_guide-testing.asciidoc[testing guide].

For manual testing REST services there are browser plugins:

* Firefox: https://addons.mozilla.org/de/firefox/addon/rested/[rested]
* Chrome: http://www.getpostman.com/[postman] (https://chrome.google.com/webstore/detail/advanced-rest-client/hgmloofddffdnphfgcellkdfbfbjeloo[advanced-rest-client])

[[devonfw-guide_devon4j.wiki_guide-rest.asciidoc_security]]
== Security
Your services are the major entry point to your application. Hence security considerations are important here.

[[devonfw-guide_devon4j.wiki_guide-rest.asciidoc_csrf]]
=== CSRF
A common security threat is https://www.owasp.org/index.php/Top_10_2013-A8-Cross-Site_Request_Forgery_(CSRF)[CSRF] for REST services. Therefore all REST operations that are performing modifications (PUT, POST, DELETE, etc. - all except GET) have to be secured against CSRF attacks. See xref:devonfw-guide_devon4j.wiki_guide-csrf.asciidoc[CSRF] how to do this.

[[devonfw-guide_devon4j.wiki_guide-rest.asciidoc_json-top-level-arrays]]
=== JSON top-level arrays
OWASP earlier suggested to never return JSON arrays at the top-level, to prevent attacks without rationale.
We digged deep and found https://haacked.com/archive/2008/11/20/anatomy-of-a-subtle-json-vulnerability.aspx/[anatomy-of-a-subtle-json-vulnerability].
To sum it up the attack is many years old and does not work in any recent or relevant browser.
Hence it is fine to use arrays as top-level result in a JSON REST service (means you can return `List&lt;Foo&gt;` in a Java JAX-RS service).

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-json.asciidoc]]
= JSON

http://en.wikipedia.org/wiki/JSON[JSON] (JavaScript Object Notation) is a popular format to represent and exchange data especially for modern web-clients. For mapping Java objects to JSON and vice-versa there is no official standard API. We use the established and powerful open-source solution http://wiki.fasterxml.com/JacksonHome[Jackson].
Due to problems with the wiki of fasterxml you should try this alternative xref:devonfw-guide/devon4j.wiki_ https://github.com/FasterXML/jackson#jackson-project-home-github[Jackson/AltLink].

[[devonfw-guide_devon4j.wiki_guide-json.asciidoc_configure-json-mapping]]
== Configure JSON Mapping
In order to avoid polluting business objects with proprietary Jackson annotations (e.g. `@JsonTypeInfo`, `@JsonSubTypes`, `@JsonProperty`) we propose to create a separate configuration class. Every devonfw application (sample or any app created from our xref:devonfw-guide_devon4j.wiki_tutorial-newapp.asciidoc[app-template]) therefore has a class called `ApplicationObjectMapperFactory` that extends +ObjectMapperFactory+ from the +devon4j-rest+ module. It looks like this:

[source,java]
--------
@Named("ApplicationObjectMapperFactory")
public class ApplicationObjectMapperFactory extends ObjectMapperFactory {

  public RestaurantObjectMapperFactory() {
    super();
    // JSON configuration code goes here
  }
}
--------

[[devonfw-guide_devon4j.wiki_guide-json.asciidoc_json-and-inheritance]]
== JSON and Inheritance
If you are using inheritance for your objects mapped to JSON then polymorphism can not be supported out-of-the box. So in general avoid polymorphic objects in JSON mapping. However, this is not always possible.
Have a look at the following example from our sample application:
[[devonfw-guide_devon4j.wiki_guide-json.asciidoc_img-rest-inheritance]]
.Transfer-Objects using Inheritance
image::images/REST-Inheritance.png["inheritance class diagram",scaledwidth="80%",align="center"]

Now assume you have a xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc_rest[REST service operation] as Java method that takes a +ProductEto+ as argument. As this is an abstract class the server needs to know the actual sub-class to instantiate.
We typically do not want to specify the classname in the JSON as this should be an implementation detail and not part of the public JSON format (e.g. in case of a service interface). Therefore we use a symbolic name for each polymorphic subtype that is provided as virtual attribute +@type+ within the JSON data of the object:
[source,json]
--------
{ "@type": "Drink", ... }
--------

Therefore you add configuration code to the constructor of xref:devonfw-guide_devon4j.wiki_guide-json.asciidoc_configure-json-mapping[ApplicationObjectMapperFactory]. Here you can see an example from the sample application:

[source,java]
--------
setBaseClasses(ProductEto.class);
addSubtypes(new NamedType(MealEto.class, "Meal"), new NamedType(DrinkEto.class, "Drink"),
  new NamedType(SideDishEto.class, "SideDish"));
--------

We use `setBaseClasses` to register all top-level classes of polymorphic objects. Further we declare all concrete polymorphic sub-classes together with their symbolic name for the JSON format via `addSubtypes`.

[[devonfw-guide_devon4j.wiki_guide-json.asciidoc_custom-mapping]]
== Custom Mapping
In order to map custom xref:devonfw-guide_devon4j.wiki_guide-datatype.asciidoc[datatypes] or other types that do not follow the Java bean conventions, you need to define a custom mapping. If you create objects dedicated for the JSON mapping you can easily avoid such situations. When this is not suitable follow these instructions to define the mapping:

. As an example, the use of JSR354 (`javax.money`) is appreciated in order to process monetary amounts properly. However, without custom mapping, the default mapping of Jackson will produce the following JSON for a `MonetaryAmount`:
+
[source,json]
------
"currency": {"defaultFractionDigits":2, "numericCode":978, "currencyCode":"EUR"},
"monetaryContext": {...},
"number":6.99,
"factory": {...}
------
+
As clearly can be seen, the JSON contains too much information and reveals implementation secrets that do not belong here. Instead the JSON output expected and desired would be:
+
[source,json]
------
"currency":"EUR","amount":"6.99"
------
+
Even worse, when we send the JSON data to the server, Jackson will see that `MonetaryAmount` is an interface and does not know how to instantiate it so the request will fail.
Therefore we need a customized xref:devonfw-guide/devon4j.wiki_https://github.com/FasterXML/jackson-docs/wiki/JacksonHowToCustomSerializers[Serializer].

. We implement `MonetaryAmountJsonSerializer` to define how a `MonetaryAmount` is serialized to JSON:
+
[source,java]
------
public final class MonetaryAmountJsonSerializer extends JsonSerializer&lt;MonetaryAmount&gt; {

  public static final String NUMBER = "amount";
  public static final String CURRENCY = "currency";

  public void serialize(MonetaryAmount value, JsonGenerator jgen, SerializerProvider provider) throws ... {
    if (value != null) {
      jgen.writeStartObject();
      jgen.writeFieldName(MonetaryAmountJsonSerializer.CURRENCY);
      jgen.writeString(value.getCurrency().getCurrencyCode());
      jgen.writeFieldName(MonetaryAmountJsonSerializer.NUMBER);
      jgen.writeString(value.getNumber().toString());
      jgen.writeEndObject();
    }
  }
------
+
For composite datatypes it is important to wrap the info as an object (`writeStartObject()` and `writeEndObject()`). `MonetaryAmount` provides the information we need by the `getCurrency()` and `getNumber()`. So that we can easily write them into the JSON data.

. Next, we implement `MonetaryAmountJsonDeserializer` to define how a `MonetaryAmount` is deserialized back as Java object from JSON:
+
[source,java]
------
public final class MonetaryAmountJsonDeserializer extends AbstractJsonDeserializer&lt;MonetaryAmount&gt; {
  protected MonetaryAmount deserializeNode(JsonNode node) {
    BigDecimal number = getRequiredValue(node, MonetaryAmountJsonSerializer.NUMBER, BigDecimal.class);
    String currencyCode = getRequiredValue(node, MonetaryAmountJsonSerializer.CURRENCY, String.class);
    MonetaryAmount monetaryAmount =
        MonetaryAmounts.getAmountFactory().setNumber(number).setCurrency(currencyCode).create();
    return monetaryAmount;
  }
}
------
+
For composite datatypes we extend from https://github.com/devonfw/devon4j/blob/develop/modules/rest/src/main/java/com/devonfw/module/rest/service/impl/json/AbstractJsonDeserializer.java[`AbstractJsonDeserializer`] as this makes our task easier. So we already get a `JsonNode` with the parsed payload of our datatype. Based on this API it is easy to retrieve individual fields from the payload without taking care of their order, etc.
`AbstractJsonDeserializer` also provides methods such as `getRequiredValue` to read required fields and get them converted to the desired basis datatype. So we can easily read the amount and currency and construct an instance of `MonetaryAmount` via the official factory API.

. Finally we need to register our custom (de)serializers with the following configuration code in the constructor of xref:devonfw-guide_devon4j.wiki_guide-json.asciidoc_configure-json-mapping[ApplicationObjectMapperFactory]:+
[source,java]
--------
  SimpleModule module = getExtensionModule();
  module.addDeserializer(MonetaryAmount.class, new MonetaryAmountJsonDeserializer());
  module.addSerializer(MonetaryAmount.class, new MonetaryAmountJsonSerializer());
--------
Now we can read and write `MonetaryAmount` from and to JSON as expected.

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-xml.asciidoc]]
= XML

http://en.wikipedia.org/wiki/XML[XML] (Extensible Markup Language) is a W3C standard format for structured information. It has a large eco-system of additional standards and tools.

In Java there are many different APIs and frameworks for accessing, producing and processing XML. For the devonfw we recommend to use xref:devonfw-guide_devon4j.wiki_guide-xml.asciidoc_jaxb[JAXB] for mapping Java objects to XML and vice-versa. Further there is the popular http://docs.oracle.com/javase/7/docs/api/org/w3c/dom/package-summary.html[DOM API] for reading and writing smaller XML documents directly. When processing large XML documents http://en.wikipedia.org/wiki/StAX[StAX] is the right choice.

[[devonfw-guide_devon4j.wiki_guide-xml.asciidoc_jaxb]]
== JAXB
We use http://en.wikipedia.org/wiki/Java_Architecture_for_XML_Binding[JAXB] to serialize Java objects to XML or vice-versa.

[[devonfw-guide_devon4j.wiki_guide-xml.asciidoc_jaxb-and-inheritance]]
=== JAXB and Inheritance
Use `@XmlSeeAlso` annotation to provide sub-classes.
See section "Collective Polymorphism" described https://dzone.com/articles/java-and-xml-part-3-jaxb[here].

[[devonfw-guide_devon4j.wiki_guide-xml.asciidoc_jaxb-custom-mapping]]
=== JAXB Custom Mapping
In order to map custom xref:devonfw-guide_devon4j.wiki_guide-datatype.asciidoc[datatypes] or other types that do not follow the Java bean conventions, you need to define a custom mapping. If you create dedicated objects for the XML mapping you can easily avoid such situations. When this is not suitable use `@XmlJavaTypeAdapter` and provide an `XmlAdapter` implementation that handles the mapping.
For details see https://www.eclipse.org/eclipselink/documentation/2.6/moxy/advanced_concepts006.htm[here].

[[devonfw-guide_devon4j.wiki_guide-xml.asciidoc_security]]
== Security

To prevent XML External Entity attacks, follow https://docs.oracle.com/en/java/javase/11/security/java-api-xml-processing-jaxp-security-guide.html[JAXP Security Guide] and enable https://docs.oracle.com/en/java/javase/11/security/java-api-xml-processing-jaxp-security-guide.html#GUID-88B04BE2-35EF-4F61-B4FA-57A0E9102342[FSP].

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-soap.asciidoc]]
= SOAP
https://en.wikipedia.org/wiki/SOAP[SOAP] is a common protocol for xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[services] that is rather complex and heavy. It allows to build inter-operable and well specified services (see WSDL). SOAP is transport neutral what is not only an advantage. We strongly recommend to use HTTPS transport and ignore additional complex standards like WS-Security and use established HTTP-Standards such as RFC2617 (and RFC5280).
//There is no SOAP example in our application -maybe keep this as a general example?-

[[devonfw-guide_devon4j.wiki_guide-soap.asciidoc_jax-ws]]
== JAX-WS
For building web-services with Java we use the https://jcp.org/en/jsr/detail?id=224[JAX-WS] standard.
There are two approaches:

* code first
* contract first

Here is an example in case you define a code-first service.

[[devonfw-guide_devon4j.wiki_guide-soap.asciidoc_web-service-interface]]
=== Web-Service Interface
We define a regular interface to define the API of the service and annotate it with JAX-WS annotations:
[source,java]
--------
@WebService
public interface TablemanagmentWebService {

  @WebMethod
  @WebResult(name = "message")
  TableEto getTable(@WebParam(name = "id") String id);

}
--------

[[devonfw-guide_devon4j.wiki_guide-soap.asciidoc_web-service-implementation]]
=== Web-Service Implementation

And here is a simple implementation of the service:
[source,java]
--------
@Named
@WebService(endpointInterface = "com.devonfw.application.mtsj.tablemanagement.service.api.ws.TablemanagmentWebService")
public class TablemanagementWebServiceImpl implements TablemanagmentWebService {

  private Tablemanagement tableManagement;

  @Override
  public TableEto getTable(String id) {

    return this.tableManagement.findTable(id);
  }
--------

[[devonfw-guide_devon4j.wiki_guide-soap.asciidoc_soap-custom-mapping]]
== SOAP Custom Mapping
In order to map custom xref:devonfw-guide_devon4j.wiki_guide-datatype.asciidoc[datatypes] or other types that do not follow the Java bean conventions, you need to write adapters for JAXB (see xref:devonfw-guide_devon4j.wiki_guide-xml.asciidoc[XML]).

[[devonfw-guide_devon4j.wiki_guide-soap.asciidoc_soap-testing]]
== SOAP Testing
For testing SOAP services in general consult the xref:devonfw-guide_devon4j.wiki_guide-testing.asciidoc[testing guide].

For testing SOAP services manually we strongly recommend http://www.soapui.org/[SoapUI].

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc]]
= Logging

We recommend to use http://www.slf4j.org/[SLF4J] as API for logging, that has become a de facto standard in Java as it has a much better design than `java.util.logging` offered by the JDK.
There are serveral implementations for SLF4J. For Spring applications our recommended implementation is http://logback.qos.ch/[Logback]. Quarkus uses JBoss Logging which provides a JBoss Log Manager implementation for SLF4J. For more information on logging in Quarkus, see the https://quarkus.io/guides/logging[Quarkus logging guide].

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc_logging-dependencies]]
== Logging Dependencies

To use Logback in your Spring application, you need to include the following dependencies:

[source, xml]
----
&lt;!-- SLF4J as logging API --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
  &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- Logback as logging implementation  --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
  &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- JSON logging for cloud-native log monitoring --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;net.logstash.logback&lt;/groupId&gt;
  &lt;artifactId&gt;logstash-logback-encoder&lt;/artifactId&gt;
&lt;/dependency&gt;
----

In devon4j these dependencies are provided by the https://github.com/devonfw/devon4j/tree/master/modules/logging[devon4j-logging module].

In Quarkus, SLF4J and the https://github.com/jboss-logging/slf4j-jboss-logmanager[`slf4j-jboss-logmanager`] are directly included in the Quarkus core runtime and can be used out of the box.

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc_logger-access]]
== Logger Access
The general pattern for accessing loggers from your code is a static logger instance per class using the following pattern:

[source,java]
----
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class MyClass {
  private static final Logger LOG = LoggerFactory.getLogger(MyClass.class);
  ...
}
----

For detailed documentation how to use the logger API check the http://www.slf4j.org/manual.html[SLF4j manual].

NOTE: In case you are using https://github.com/devonfw/ide[devonfw-ide] and Eclipse you can just type `LOG` and hit `[ctrl][space]` to insert the code pattern including the imports into your class.

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc_lombok]]
=== Lombok
In case you are using xref:devonfw-guide_devon4j.wiki_guide-lombok.asciidoc[Lombok], you can simply use the https://projectlombok.org/api/lombok/extern/slf4j/Slf4j.html[`@Slf4j`] annotation in your class. This causes Lombok to generate the logger instance for you.

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc_log-levels]]
== Log-Levels
We use a common understanding of the log-levels as illustrated by the following table.
This helps for better maintenance and operation of the systems.

.Log-levels
[options="header"]
|=======================
| *Log-level* | *Description* | *Impact* | *Active Environments*
| FATAL | Only used for fatal errors that prevent the application to work at all (e.g. startup fails or shutdown/restart required) | Operator has to react immediately | all
| ERROR | An abnormal error indicating that the processing failed due to technical problems. | Operator should check for known issue and otherwise inform development | all
| WARNING | A situation where something worked not as expected. E.g. a business exception or user validation failure occurred. | No direct reaction required. Used for problem analysis. | all
| INFO | Important information such as context, duration, success/failure of request or process | No direct reaction required. Used for analysis. | all
| DEBUG | Development information that provides additional context for debugging problems. | No direct reaction required. Used for analysis. | development and testing
| TRACE | Like DEBUG but exhaustive information and for code that is run very frequently. Will typically cause large log-files. | No direct reaction required. Used for problem analysis. | none (turned off by default)
|=======================
Exceptions (with their stack trace) should only be logged on `FATAL` or `ERROR` level. For business exceptions typically a `WARNING` including the message of the exception is sufficient.

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc_configuration-of-logback]]
=== Configuration of Logback
The configuration of logback happens via the `logback.xml` file that you should place into `src/main/resources` of your app.
For details consult the http://logback.qos.ch/manual/configuration.html[logback configuration manual].

NOTE: Logback also allows to overrule the configuration with a `logback-test.xml` file that you may put into `src/test/resources` or into a test-dependency.

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc_configuration-in-quarkus]]
=== Configuration in Quarkus
The are several options you can set in the `application.properties` file to configure the behaviour of the logger in Quarkus. For a detailed overview, see the corresponding part of the https://quarkus.io/guides/logging#runtime-configuration[Quarkus guide].

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc_json-logging]]
== JSON-logging

For easy integration with xref:devonfw-guide_devon4j.wiki_guide-log-monitoring.asciidoc[log-monitoring], we recommend that your app logs to `standard out` in JSON following https://jsonlines.org/[JSON Lines].

In Spring applications, this can be achieved via https://github.com/logstash/logstash-logback-encoder[logstash-logback-encoder] (see xref:devonfw-guide_devon4j.wiki_guide-logging.asciidoc_dependencies[dependencies]). In Quarkus, it can be easily achieved using the https://github.com/quarkusio/quarkus/tree/main/extensions/logging-json[quarkus-logging-json] extension (see https://quarkus.io/guides/logging#json-logging[here] for more details).

This will produce log-lines with the following format (example formatted for readability):

[source,javascript]
----
{
  "timestamp":"2000-12-31T23:59:59.999+00:00",
  "@version":"1",
  "message":"Processing 4 order(s) for shipment",
  "logger_name":"com.myapp.order.logic.UcManageOrder",
  "thread_name":"http-nio-8081-exec-6",
  "level":"INFO",
  "level_value":20000,
  "appname":"myapp",
}
----

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc_adding-custom-values-to-json-log-with-logstash]]
=== Adding custom values to JSON log with Logstash

The JSON encoder even supports logging custom properties for your xref:devonfw-guide_devon4j.wiki_guide-log-monitoring.asciidoc[log-monitoring].
The _trick_ is to use the class `net.logstash.logback.argument.StructuredArguments` for adding the arguments to you log message, e.g.

[source,java]
----
import static net.logstash.logback.argument.StructuredArguments.v;

...
    LOG.info("Request with {} and {} took {} ms.", v("url", url), v("status", statusCode), v("duration", millis));
...
----

This will produce the a JSON log-line with the following properties:
[source,javascript]
----
...
  "message":"Request with url=https://api/service/v1/ordermanagement/order and status=200 took duration=251 ms",
  "url":"https://api/service/v1/ordermanagement/order",
  "status":"200",
  "duration":"251",
...
----

As you can quickly see besides the human readable `message` you also have the structured properties `url`, `status` and `duration` that can be extremly valuable to configure dashboards in your xref:devonfw-guide_devon4j.wiki_guide-log-monitoring.asciidoc[log-monitoring] that visualize success/failure ratio as well as performance of your requests.

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc_classic-log-files]]
== Classic log-files

NOTE: **In devon4j, we strongly recommend using JSON logging instead of classic log files. The following section refers only to devon4j Spring applications that use Logback.**

Even though we do not recommend anymore to write classical log-files to the local disc, here you can still find our approach for it.

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc_maven-integration]]
=== Maven-Integration
In the `pom.xml` of your application add this dependency:
[source,xml]
----
&lt;dependency&gt;
  &lt;groupId&gt;com.devonfw.java&lt;/groupId&gt;
  &lt;artifactId&gt;devon4j-logging&lt;/artifactId&gt;
&lt;/dependency&gt;
----

The above dependency already adds transitive dependencies to SLF4J and logback.
Also it comes with https://github.com/devonfw/devon4j/tree/master/modules/logging/src/main/resources/com/devonfw/logging/logback[configration snipplets] that can be included from your `logback.xml` file (see xref:devonfw-guide_devon4j.wiki_guide-logging.asciidoc_configuration[configuration]).

The `logback.xml` to write regular log-files can look as following:

[source,xml]
----
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration scan="true" scanPeriod="60 seconds"&gt;
  &lt;property resource="com/devonfw/logging/logback/application-logging.properties" /&gt;
  &lt;property name="appname" value="MyApp"/&gt;
  &lt;property name="logPath" value="../logs"/&gt;
  &lt;include resource="com/devonfw/logging/logback/appenders-file-all.xml" /&gt;
  &lt;include resource="com/devonfw/logging/logback/appender-console.xml" /&gt;

  &lt;root level="DEBUG"&gt;
    &lt;appender-ref ref="ERROR_APPENDER"/&gt;
    &lt;appender-ref ref="INFO_APPENDER"/&gt;
    &lt;appender-ref ref="DEBUG_APPENDER"/&gt;
    &lt;appender-ref ref="CONSOLE_APPENDER"/&gt;
  &lt;/root&gt;

  &lt;logger name="org.springframework" level="INFO"/&gt;
&lt;/configuration&gt;
----

The provided `logback.xml` is configured to use variables defined on the `config/application.properties` file.
On our example, the log files path point to `../logs/` in order to log to tomcat log directory when starting tomcat on the bin folder.
Change it according to your custom needs.

.config/application.properties
[source, properties]
----
log.dir=../logs/
----

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc_log-files]]
=== Log Files
The classical approach uses the following log files:

* *Error Log*: Includes log entries to detect errors.
* *Info Log*: Used to analyze system status and to detect bottlenecks.
* *Debug Log*: Detailed information for error detection.

The log file name pattern is as follows:
[source]
«LOGTYPE»_log_«HOST»_«APPLICATION»_«TIMESTAMP».log

.Segments of Logfilename
[options="header"]
|=======================
| *Element*     | *Value*              | *Description*
| «LOGTYPE»     |  info, error, debug  |  Type of log file
| «HOST»        |  e.g. mywebserver01  |  Name of server, where logs are generated
| «APPLICATION» |  e.g. myapp          |  Name of application, which causes logs
| «TIMESTAMP»   |  +YYYY-MM-DD_HH00+   |  date of log file
|=======================
Example:
+error_log_mywebserver01_myapp_2013-09-16_0900.log+

Error log from +mywebserver01+ at application +myapp+ at 16th September 2013 9pm.

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc_output-format]]
=== Output format

We use the following output format for all log entries to ensure that searching and filtering of log entries work consistent for all logfiles:</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>   * *D*: Date (Timestamp in ISO8601 format e.g. 2013-09-05 16:40:36,464)
   * *P*: Priority (the log level)
   * *C*: xref:devonfw-guide_devon4j.wiki_guide-logging.asciidoc_correlation-id[Correlation ID] (ID to identify users across multiple systems, needed when application is distributed)
   * *T*: Thread (Name of thread)
   * *L*: Logger name (use class name)
   * *M*: Message (log message)

Example:</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>NOTE: When using devon4j-logging, this format is used by default. To achieve this format in Quarkus, set `quarkus.log.console.format=[D: %d] [P: %p] [C: %X] [T: %t] [L: %c] [M: %m]%n` in your properties.

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc_correlation-id]]
=== Correlation ID
In order to correlate separate HTTP requests to services belonging to the same user / session, we provide a servlet filter called `DiagnosticContextFilter`.
This filter takes a provided correlation ID from the HTTP header `X-Correlation-Id`.
If none was found, it will generate a new correlation id as `UUID`.
This correlation ID is added as MDC to the logger.
Therefore, it will then be included to any log message of the current request (thread).
Further concepts such as xref:devonfw-guide_devon4j.wiki_guide-service-client.asciidoc[service invocations] will pass this correlation ID to subsequent calls in the application landscape. Hence you can find all log messages related to an initial request simply via the correlation ID even in highly distributed systems.

[[devonfw-guide_devon4j.wiki_guide-logging.asciidoc_security]]
=== Security
In order to prevent https://owasp.org/www-community/attacks/Log_Injection[log forging] attacks you can simply use the suggested xref:devonfw-guide_devon4j.wiki_guide-logging.asciidoc_json-logging[JSON logging] format.
Otherwise you can use `com.devonfw.module.logging.common.impl.SingleLinePatternLayout` as demonstrated  https://github.com/devonfw/devon4j/blob/master/modules/logging/src/main/resources/com/devonfw/logging/logback/appender-file-warn.xml[here] in order to prevent such attacks.

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc:
toc::[]

[[devonfw-guide_devon4j.wiki_guide-monitoring.asciidoc]]
= Monitoring

For monitoring a complex application landscape it is crucial to have an exact overview which applications are up and running and which are not and why.
In devonfw we only focus on topics which are most important when developing production-ready applications.
On a high level view we strongly suggest to separate the application to be monitored from the `monitoring system` itself.
Therefore, your application should concentrate on providing app specific data for the monitoring.
Aspects such as aggregation, visualization, search, alerting, etc. should be addressed outside of your app by a monitoring system product.
There are many products providing such a monitoring system like https://checkmk.com[checkmk], https://icinga.com/[icinga], https://skywalking.apache.org/[SkyWalking], etc.
Please note that there is a huge list of such products and devonfw is not biased or aims to make a choice for you.
Instead please search and find the products that fit best for your requirements and infrastructure.

[[devonfw-guide_devon4j.wiki_guide-monitoring.asciidoc_types-of-monitoring]]
== Types of monitoring

As monitoring coveres a lot of different aspects we separate the following types of monitoring and according data:

* *xref:devonfw-guide_devon4j.wiki_guide-log-monitoring.asciidoc[Log-monitoring]* +
is about collecting and monitoring the logs of all apps and containers in your IT landscape. It is suitable for events such as an HTTP request with its URL, resulting status code and duration in milliseconds. Your monitoring may not react to such data in realtime. Instead it may take a delay of one or a few seconds.
* *Infrastructure monitoring* +
is about monitoring the (hardware) infrastructure with measures like usage of CPU, memory, disc-space, etc. This is a pure operational task and your app should have nothing to do with this. In other words it is a waste if your app tries to monitor these aspects as existing products can do this much better and your app will only see virtual machines and is unable to see the physical infrastructure.
* *xref:devonfw-guide_devon4j.wiki_guide-monitoring.asciidoc_health-check[Health check]* +
is about providing internal data about the current health of your app. Typically you provide sensors with health status per component or interface to neighbour service (database connectivity, etc.).
* *xref:devonfw-guide_devon4j.wiki_guide-apm.asciidoc[Application Performance Monitoring]* +
is about measuring performance and tracing down performance issues.

[[devonfw-guide_devon4j.wiki_guide-monitoring.asciidoc_health-check]]
== Health-Check

The idea of a health check is to prodvide monitoring data about the current health status of your application.
This allows to integrate this specific data into the monitoring system used for your IT landscape.
In order to keep the monitoring simple and easy to integreate consider using the following best practices:

* Use simple and established protocols such as xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc[REST] instead of xref:devonfw-guide_devon4j.wiki_guide-jmx.asciidoc[JMX via RMI].
* Considuer using recent standards such as https://github.com/eclipse/microprofile-health[microprofile-health].
* Consider to drop xref:devonfw-guide_devon4j.wiki_guide-access-control.asciidoc[access-control] for your monitoring interfaces and for security prevent external access to it in your infrastructure (loadbalancers or gateways). Monitoring is only for usage within an IT landscape internally. It does not make sense for externals and end-users to access your app for reading monitoring data from a random node decided by a loadbalancer. Furhter, external access can easily lead to https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure[sensitive data exposure].
* Consider to define different end-points per usage-scenario. So if you want the loadbalancer to ask your app monitoring for availability of each node then create a separate service URL that only provides `OK` or anything else for failure (`NOK`, 404, 500, timeout). Do not mix this with a health-check that needs more detailed information.
* Also do not forget about basic features such as prodiving the name and the release version of your application.
* Be careful to automate decisions based on monitoring and health checks. It easily turns out to be stupid if you automatically restart your pod or container because of some monitoring indicator. In the worst case a failure of a central component will cause your health-check to report down for all apps and as a result all your containers will be restarted frequently. Indead of curing problems such decisions will cause much more harm and trouble.
* Avoid causing reasonable load with your monitoring and health-check itself. In many cases it is better to use xref:devonfw-guide_devon4j.wiki_guide-log-monitoring.asciidoc[log-monitoring] or to collect monitoring data from use-cases that happen in your app anyway. If you create dummy read and write requests in your monitoring implementation you will easily turn it into a DOS-attack.

For xref:devonfw-guide_devon4j.wiki_spring.asciidoc[spring] you can simply integrate app monitoring and health check via https://docs.spring.io/spring-boot/docs/current/reference/html/actuator.html[spring-boot-actuator].

For xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[quarkus] you can simply integrate app monitoring via https://quarkus.io/guides/micrometer[micrometer] or https://quarkus.io/guides/smallrye-metrics[smallrye-metrics] and health check via https://quarkus.io/guides/smallrye-health[smallrye-health].


:leveloffset: 2

:leveloffset: +2

:toc:
toc::[]

[[devonfw-guide_devon4j.wiki_guide-log-monitoring.asciidoc]]
= Log-Monitoring

Log-monitoring is an aspect of xref:devonfw-guide_devon4j.wiki_guide-monitoring.asciidoc[monitoring] with a strict focus on xref:devonfw-guide_devon4j.wiki_guide-logging.asciidoc[logging].
With trends towards IT landscapes with many but much smaller apps the classicial approach to write log-files to the disc and let operators read those via SSH became entirely obsolete.
Nowadays we have up to hundreds or even thousands of apps that themselves are clustered into multiple nodes.
Therefore you should establish a centralized log monitoring system in the environment and let all your nodes log directly into that system.
This approach gives the following benefits:

* all log information available in one place
* full-text search accross all logfiles
* ability to automatically trigger alerts from specific log patterns
* ability to do data-mining on logs and visualize in dashboards

[[devonfw-guide_devon4j.wiki_guide-log-monitoring.asciidoc_options-for-log-monitoring]]
== Options for log-monitoring

Typical products for such a log monitoring system are:

* https://www.elastic.co/de/what-is/elk-stack[ELK-Stack]
* https://www.graylog.org/[Graylog]
* https://www.splunk.com/[Splunk]

In devonfw we are not biased for any of these products. Therefore, feel free to make your choice according to the requirements of your project.

For Quarkus applications, you can get an insight into the topic by reading the guide about https://quarkus.io/guides/centralized-log-management[centralized log management].

[[devonfw-guide_devon4j.wiki_guide-log-monitoring.asciidoc_api-for-log-monitoring]]
== API for log-monitoring

The "API" for logging to a log-monitoring system for your app is pretty simple:

* Write your logs to standard out.
* Use xref:devonfw-guide_devon4j.wiki_guide-logging.asciidoc_json-logging[JSON logging] as format.

Then the container infrastructure can automatically collect your logs from standard out and directly feed those into the log monitoring system.
As a result, your app does not need to know anything about your log monitoring system and logging becomes most simple.
Further, if you do not write log-files anymore, you might not need to write any other files and therefore may not even need write permissions on the filesystem of your container.
In such case an attacker who may find a vulnerability in your app will have less attack surface in case he can not write any file.

:leveloffset: 2

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-apm.asciidoc]]
= Application Performance Management

This guide gives hints how to manage, monitor and analyse performance of Java applications.

[[devonfw-guide_devon4j.wiki_guide-apm.asciidoc_temporary-analysis]]
== Temporary Analysis
If you are facing performance issues and want to do a punctual analysis we recommend you to use https://glowroot.org/[glowroot]. It is ideal in cases where monitoring in your local development environment is suitable. However, it is also possible to use it in your test environment. It is entirely free and open-source. Still it is very powerful and helps to trace down bottlenecks. To get a first impression of the tool take a look at the https://demo.glowroot.org[demo].

[[devonfw-guide_devon4j.wiki_guide-apm.asciidoc_jeewtp]]
=== JEE/WTP
In case you are forced to use an xref:devonfw-guide_devon4j.wiki_guide-jee.asciidoc[JEE application server] and want to do a temporary analysis you can double click your server instance from the servers view in Eclipse and click on the link `Open launch configuration` in order to add the `-javaagent` JVM option.

[[devonfw-guide_devon4j.wiki_guide-apm.asciidoc_regular-analysis]]
== Regular Analysis
In case you want to manage application performance regularly we recommend to use https://github.com/javamelody/javamelody#javamelody[JavaMelody] that can be integrated into your application. More information on javamelody is available on the https://github.com/javamelody/javamelody/wiki[JavaMelody Wiki]

[[devonfw-guide_devon4j.wiki_guide-apm.asciidoc_alternatives]]
== Alternatives

* https://github.com/naver/pinpoint[PinPoint]
* https://openapm.io/[OpenAPM]
* https://www.appdynamics.com/java/[AppDynamics]
* https://www.zabbix.com/features[Zabbix]

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-security.asciidoc]]
= Security
//Fixed Typo
Security is todays most important cross-cutting concern of an application and an enterprise IT-landscape. We seriously care about security and give you detailed guides to prevent pitfalls, vulnerabilities, and other disasters. While many mistakes can be avoided by following our guidelines you still have to consider security and think about it in your design and implementation. The security guide will not only automatically prevent you from any harm, but will provide you hints and best practices already used in different software products.

An important aspect of security is proper authentication and authorization as described in xref:devonfw-guide_devon4j.wiki_guide-access-control.asciidoc[access-control]. In the following we discuss about potential vulnerabilities and protection to prevent them.

[[devonfw-guide_devon4j.wiki_guide-security.asciidoc_vulnerabilities-and-protection]]
== Vulnerabilities and Protection
Independent from classical authentication and authorization mechanisms there are many common pitfalls that can lead to vulnerabilities and security issues in your application such as XSS, CSRF, SQL-injection, log-forging, etc. A good source of information about this is the https://www.owasp.org[OWASP].
We address these common threats individually in _security_ sections of our technological guides as a concrete solution to prevent an attack typically depends on the according technology. The following table illustrates common threats and contains links to the solutions and protection-mechanisms provided by the devonfw:

.Security threats and protection-mechanisms
[options="header"]
|=======================
|*Threat*|*Protection*|*Link to details*
|https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection.html[A1 Injection]
|validate input, escape output, use proper frameworks
|xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_security[SQL Injection]

|https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A2-Broken_Authentication.html[A2 Broken Authentication]
|encrypt all channels, use a central identity management with strong password-policy
|xref:devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_authentication[Authentication]

|https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html[A3 Sensitive Data Exposure]
|Use secured exception facade, design your data model accordingly
|xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc_rest-exception-handling[REST exception handling]

|https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A4-XML_External_Entities_(XXE).html[A4 XML External Entities]
|Prefer JSON over XML, ensure https://docs.oracle.com/en/java/javase/11/security/java-api-xml-processing-jaxp-security-guide.html[FSP] when parsing (external) XML
|xref:devonfw-guide_devon4j.wiki_guide-xml.asciidoc[XML guide]

|https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A5-Broken_Access_Control.html[A5 Broken Access Control]
|Ensure proper authorization for all use-cases, use `@DenyAll` as default to enforce
|xref:devonfw-guide_devon4j.wiki_guide-access-control.asciidoc[Access-control guide] especially xref:devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_configuration-on-java-method-level[method authorization]

|https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration.html[A6 Security Misconfiguration]
|Use devon4j application template and guides to avoid
|xref:devonfw-guide_devon4j.wiki_tutorial-newapp.asciidoc[tutorial-newapp] and xref:devonfw-guide_devon4j.wiki_guide-configuration.asciidoc_security[sensitive configuration]

|https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A7-Cross-Site_Scripting_(XSS).html[A7 Cross-Site Scripting]
|prevent injection (see A1) for HTML, JavaScript and CSS and understand same-origin-policy
|xref:devonfw-guide_devon4j.wiki_guide-client-layer.asciidoc[client-layer]

|https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A8-Insecure_Deserialization.html[A8 Insecure Deserialization]
|Use simple and established serialization formats such as JSON, prevent generic deserialization (for polymorphic types)
|xref:devonfw-guide_devon4j.wiki_guide-json.asciidoc[JSON guide] especially xref:devonfw-guide_devon4j.wiki_guide-json.asciidoc_json-and-inheritance[inheritence], xref:devonfw-guide_devon4j.wiki_guide-xml.asciidoc[XML guide]

|https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A9-Using_Components_with_Known_Vulnerabilities.html[A9 Using Components with Known Vulnerabilities]
|subscribe to security newsletters, recheck products and their versions continuously, use devonfw dependency management
|https://cve.mitre.org/news/newsletter.html[CVE newsletter] and xref:devonfw-guide_devon4j.wiki_guide-security.asciidoc_dependency-check[dependency check]

|https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A10-Insufficient_Logging%252526Monitoring.html[A10 Insufficient_Logging &amp; Monitoring]
|Ensure to log all security related events (login, logout, errors), establish effective monitoring
|xref:devonfw-guide_devon4j.wiki_guide-logging.asciidoc[Logging guide] and xref:devonfw-guide_devon4j.wiki_guide-monitoring.asciidoc[monitoring guide]

|https://owasp.org/www-chapter-ghana/assets/slides/IDOR.pdf[Insecure Direct Object References]
|Using direct object references (IDs) only with appropriate authorization
|xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc_direct-object-references[logic-layer]

|https://owasp.org/www-community/attacks/csrf[Cross-Site Request Forgery (CSRF)]
|secure mutable service operations with an explicit CSRF security token sent in HTTP header and verified on the server
|xref:devonfw-guide_devon4j.wiki_guide-csrf.asciidoc[CSRF guide]

|https://owasp.org/www-community/attacks/Log_Injection[Log-Forging]
|Escape newlines in log messages
|xref:devonfw-guide_devon4j.wiki_guide-logging.asciidoc_security[logging security]

|https://owasp.org/www-pdf-archive//OWASP_LA_New_OWASP_Top_10_David_Caissy_2017_07.pdf[Unvalidated Redirects and Forwards]
|Avoid using redirects and forwards, in case you need them do a security audit on the solution.
|devonfw proposes to use rich-clients (SPA/RIA). We only use redirects for login in a safe way.
|=======================

[[devonfw-guide_devon4j.wiki_guide-security.asciidoc_advanced-security]]
== Advanced Security

While OWASP Top 10 covers the basic aspects of application security, there are advanced standards such as `AVS`.
In devonfw we address this in the https://github.com/devonfw/security/wiki[
Application Security Quick Solution Guide].

[[devonfw-guide_devon4j.wiki_guide-security.asciidoc_tools]]
== Tools
[[devonfw-guide_devon4j.wiki_guide-security.asciidoc_dependency-check]]
=== Dependency Check
To address the thread `Using Components with Known Vulnerabilities` we recomment to use https://www.owasp.org/index.php/OWASP_Dependency_Check[OWASP dependency check] that ships with a maven plugin and can analyze your dependencies for known https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures[CVE]s.
In order to run this check, you can simply call this command on any maven project:
[source,bash]
----
mvn org.owasp:dependency-check-maven:6.1.5:aggregate
----

NOTE: The version is just for completeness. You should check yourself for using a recent version of the plugin.

If you build an devon4j spring application from our xref:devonfw-guide_devon4j.wiki_tutorial-newapp.asciidoc[app-template] you can activate the dependency check even easier with the `security` profile:
[source,bash]
----
mvn clean install -P security
----
This does not run by default as it causes some overhead for the build performance. However, consider to build this in your CI at least nightly.
After the dependency check is performed, you will find the results in `target/dependency-check-report.html` of each module. The report will also be generated when the site is build (`mvn site`) even without the profile.

[[devonfw-guide_devon4j.wiki_guide-security.asciidoc_penetration-testing]]
=== Penetration Testing
For penetration testing (testing for vulnerabilities) of your web application, we recommend the following tools:

* https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project[ZAP] (OWASP Zed Attack Proxy Project)
* http://sqlmap.org/[sqlmap] (or https://github.com/PaulSec/HQLmap[HQLmap])
* https://nmap.org/[nmap]
* See the marvelous presentation https://jaxenter.com/security-open-source-toolbox-video-151314.html[Toolbox of a security professional] from https://www.Christian-Schneider.net[Christian Schneider].

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-cors-support.asciidoc]]
= CORS support

When you are developing Javascript client and server application separately, you have to deal with cross domain issues. We have to request from a origin domain distinct to target domain and browser does not allow this.

So , we need to prepare server side to accept request from other domains. We need to cover the following points:

* Accept request from other domains.

* Accept devonfw used headers like `X-CSRF-TOKEN` or `correlationId.`

* Be prepared to receive secured request (cookies).

It is important to note that if you are using security in your request (sending cookies) you have to set  `withCredentials` flag to `true` in your client side request and deal with special IE8 characteristics.

For more information about CORS see https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS[here]. Information about the CORS headers can be found https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers#cors[here].

[[devonfw-guide_devon4j.wiki_guide-cors-support.asciidoc_configuring-cors-support]]
== Configuring CORS support

To enable CORS support for your application, see the advanced guides. For Spring applications see xref:devonfw-guide_devon4j.wiki_spring_guide-cors-spring.asciidoc[here]. For Quarkus follow the https://quarkus.io/guides/http-reference#cors-filter[official Quarkus guide].

[[devonfw-guide_devon4j.wiki_guide-cors-support.asciidoc_configuration-with-service-mesh]]
== Configuration with service mesh

If you are using a service mesh, you can also define your CORS policy directly there. Here is an example from https://istio.io/latest/docs/reference/config/networking/virtual-service/#CorsPolicy[Istio].

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-jdk.asciidoc]]
= Java Development Kit

The https://en.wikipedia.org/wiki/Java_Development_Kit[Java Development Kit] is an implementation of the Java platform. It provides the https://en.wikipedia.org/wiki/Java_virtual_machine[Java Virtual Machine] (JVM) and the Java Runtime Environment (JRE).

[[devonfw-guide_devon4j.wiki_guide-jdk.asciidoc_editions]]
== Editions

The JDK exists in different editions:

* https://openjdk.java.net/[OpenJDK] is a free and open-source edition of the JDK.
* https://www.oracle.com/technetwork/java/javase/overview/index.html[OracleJDK] is a commercial edition of the JDK.
* https://en.wikipedia.org/wiki/List_of_Java_virtual_machines[Various alternative JDK editions] either commercial (e.g. IBM's JVM) or open-source.

As Java is evolving and also complex maintaining a JVM requires a lot of energy.
Therefore many alternative JDK editions are unable to cope with this and support latest Java versions and according compatibility.
Unfortunately OpenJDK only maintains a specific version of Java for a relative short period of time before moving to the next major version.
In the end, this technically means that OpenJDK is continuous beta and can not be used in production for reasonable software projects.
As OracleJDK changed its licensing model and can not be used for commercial usage even during development, things can get tricky.
You may want to use OpenJDK for development and OracleJDK only in production.
However, e.g. OpenJDK 11 never released a version that is stable enough for reasonable development (e.g. javadoc tool is https://bugs.openjdk.java.net/browse/JDK-8212233[broken] and fixes are not available of OpenJDK 11 - fixed in 11.0.3 what is only available as OracleJDK 11 or you need to go to OpenJDK 12+, what has other bugs) so in the end there is no working release of OpenJDK 11.
This more or less forces you to use OracleJDK what requires you to buy a subscription so you can use it for commercial development.
However, there is https://github.com/AdoptOpenJDK[AdoptOpenJDK] that provides forked releases of OpenJDK with bug-fixes what might be an option.
Anyhow, as you want to have your development environment close to production, the productively used JDK (most likely OracleJDK) should be preferred also for development.

[[devonfw-guide_devon4j.wiki_guide-jdk.asciidoc_upgrading]]
== Upgrading

Until Java 8 compatibility was one of the key aspects for Java version updates (after the mess on the Swing updates with Java2 many years ago).
However, Java 9 introduced a lot of breaking changes.
This documentation wants to share the experience we collected in devonfw when upgrading from Java 8 to newer versions.
First of all we separate runtime changes that you need if you want to build your software with JDK 8 but such that it can also run on newer versions (e.g. JRE 11)
from changes required to also build your software with more recent JDKs (e.g. JDK 11 or 12).

[[devonfw-guide_devon4j.wiki_guide-jdk.asciidoc_runtime-changes]]
=== Runtime Changes
This section describes required changes to your software in order to make it run also with versions newer than Java 8.

[[devonfw-guide_devon4j.wiki_guide-jdk.asciidoc_classes-removed-from-jdk]]
==== Classes removed from JDK
The first thing that most users hit when running their software with newer Java versions is a `ClassNotFoundException` like this:</code></pre>
</div>
</div>
<div class="paragraph">
<p>Caused by: java.lang.ClassNotFoundException: javax.xml.bind.JAXBException</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>As Java 9 introduced a module system with https://www.baeldung.com/project-jigsaw-java-modularity[Jigsaw], the JDK that has been a monolithic mess is now a well-defined set of structured modules.
Some of the classes that used to come with the JDK moved to modules that where not available by default in Java 9 and have even been removed entirely in later versions of Java.
Therefore you should simply treat such code just like any other 3rd party component that you can add as a (maven) dependency.
The following table gives you the required hints to make your software work even with such classes / modules removed from the JDK (please note that the specified version is just a suggestion that worked, feel free to pick a more recent or more appropriate version):

.Dependencies for classes removed from Java 8 since 9+
[options="header"]
|=============================================
|*Class*              |*GroupId*           |*ArtifactId*           |*Version*
|`javax.xml.bind.*`   |`javax.xml.bind`    |`jaxb-api`             |`2.3.1`
|`com.sun.xml.bind.*` |`org.glassfish.jaxb`|`jaxb-runtime`         |`2.3.1`
|`java.activation.*`  |`javax.activation`  |`javax.activation-api` |`1.2.0`
|`java.transaction.*` |`javax.transaction` |`javax.transaction-api`|`1.2`
|`java.xml.ws.*`      |`javax.xml.ws`      |`jaxws-api`            |`2.3.1`
|`javax.jws.*`        |`javax.jws`         |`javax.jws-api`        |`1.1`
|`javax.annotation.*` |`javax.annotation`  |`javax.annotation-api` |`1.3.2`
|=============================================

[[devonfw-guide_devon4j.wiki_guide-jdk.asciidoc_3rd-party-updates]]
==== 3rd Party Updates
Further, internal and inofficial APIs (e.g. `sun.misc.Unsafe`) have been removed.
These are typically not used by your software directly but by low-level 3rd party libraries like `asm` that need to be updated.
Also simple things like the Java version have changed (from `1.8.x` to `9.x`, `10.x`, `11.x`, `12.x`, etc.).
Some 3rd party libraries were parsing the Java version in a very naive way making them unable to be used with Java 9+:</code></pre>
</div>
</div>
<div class="paragraph">
<p>Caused by: java.lang.NullPointerException
   at org.apache.maven.surefire.shade.org.apache.commons.lang3.SystemUtils.isJavaVersionAtLeast (SystemUtils.java:1626)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Therefore the following table gives an overview of common 3rd party libraries that have been affected by such breaking changes and need to be updated to at least the specified version:

.Minimum recommended versions of common 3rd party for Java 9+
[options="header"]
|=============================================
|*GroupId* |*ArtifactId* |*Version*|*Issue*
|`org.apache.commons`|`commons-lang3`|`3.7`|https://issues.apache.org/jira/browse/LANG-1365[LANG-1365]
|`cglib`|`cglib`|`3.2.9`|https://github.com/cglib/cglib/issues/102[102], https://github.com/cglib/cglib/issues/93[93], https://github.com/cglib/cglib/issues/133[133]
|`org.ow2.asm`|`asm`|`7.1`|https://github.com/eclipse/jetty.project/issues/2941[2941]
|`org.javassist`|`javassist`|`3.25.0-GA`|https://github.com/jboss-javassist/javassist/issues/194[194], https://github.com/jboss-javassist/javassist/issues/228[228], https://github.com/jboss-javassist/javassist/issues/246[246], https://github.com/jboss-javassist/javassist/issues/171[171]
|=============================================

[[devonfw-guide_devon4j.wiki_guide-jdk.asciidoc_resourcebundles]]
==== ResourceBundles
For internationalization (i18n) and localization (l10n) `ResourceBundle` is used for language and country specific texts and configurations as properties (e.g. `MyResourceBundle_de.properties`). With Java modules there are changes and impacts you need to know to get things working. The most important change is documented in the https://docs.oracle.com/javase/9/docs/api/java/util/ResourceBundle.html#bundleprovider[JavaDoc of ResourceBundle]. However, instead of using https://docs.oracle.com/javase/9/docs/api/java/util/spi/ResourceBundleProvider.html[ResourceBundleProvider] and refactoring your entire code causing incompatibilities, you can simply put the resource bundles in a regular JAR on the classpath rather than a named module (or into the lauching app).
If you want to implement (new) Java modules with i18n support, you can have a look at https://github.com/m-m-m/nls#mmm-nls[mmm-nls].

[[devonfw-guide_devon4j.wiki_guide-jdk.asciidoc_buildtime-changes]]
=== Buildtime Changes
If you also want to change your build to work with a recent JDK you also need to ensure that test frameworks and maven plugins properly support this.

[[devonfw-guide_devon4j.wiki_guide-jdk.asciidoc_findbugs]]
==== Findbugs
Findbugs does not work with Java 9+ and is actually a dead project.
The new findbugs is https://spotbugs.github.io/[SpotBugs].
For maven the new solution is https://spotbugs.github.io/spotbugs-maven-plugin/[spotbugs-maven-plugin]:</code></pre>
</div>
</div>
<div class="paragraph">
<p>&lt;plugin&gt;
  &lt;groupId&gt;com.github.spotbugs&lt;/groupId&gt;
  &lt;artifactId&gt;spotbugs-maven-plugin&lt;/artifactId&gt;
  &lt;version&gt;3.1.11&lt;/version&gt;
&lt;/plugin&gt;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[[devonfw-guide_devon4j.wiki_guide-jdk.asciidoc_test-frameworks]]
==== Test Frameworks



.Minimum recommended versions of common 3rd party test frameworks for Java 9+
[options="header"]
|=============================================
|*GroupId* |*ArtifactId* |*Version*|*Issue*
|`org.mockito`|`mockito-core`|`2.23.4`|https://github.com/mockito/mockito/issues/1419[1419], https://github.com/mockito/mockito/issues/1696[1696], https://github.com/mockito/mockito/issues/1607[1607], https://github.com/mockito/mockito/issues/1594[1594], https://github.com/mockito/mockito/issues/1577[1577], https://github.com/mockito/mockito/issues/1482[1482]
|=============================================

[[devonfw-guide_devon4j.wiki_guide-jdk.asciidoc_maven-plugins]]
==== Maven Plugins

.Minimum recommended versions of common maven plugins for Java 9+
[options="header"]
|=============================================
|*GroupId* |*ArtifactId* |*(min.) Version*|*Issue*
|`org.apache.maven.plugins`|`maven-compiler-plugin`|`3.8.1`|x
|`org.apache.maven.plugins`|`maven-surefire-plugin`|`2.22.2`|https://issues.apache.org/jira/browse/SUREFIRE-1439[SUREFIRE-1439]
|`org.apache.maven.plugins`|`maven-surefire-report-plugin`|`2.22.2`|https://issues.apache.org/jira/browse/SUREFIRE-1439[SUREFIRE-1439]
|`org.apache.maven.plugins`|`maven-archetype-plugin`|`3.1.0`|x
|`org.apache.maven.plugins`|`maven-javadoc-plugin`|`3.1.0`|x
|`org.jacoco`|`jacoco-maven-plugin`|`0.8.3`|https://github.com/jacoco/jacoco/issues/663[663]
|=============================================

[[devonfw-guide_devon4j.wiki_guide-jdk.asciidoc_maven-usage]]
==== Maven Usage

With Java modules you can not run Javadoc standalone anymore or you will get this error when running `mvn javadoc:javadoc`:</code></pre>
</div>
</div>
<div class="paragraph">
<p>[ERROR] Failed to execute goal org.apache.maven.plugins:maven-javadoc-plugin:3.1.1:javadoc (default-cli) on project mmm-base: An error has occurred in Javadoc report generation:
[ERROR] Exit code: 1 - error: module not found: io.github.mmm.base</p>
</div>
<div class="paragraph">
<p>[ERROR] Command line was: /projects/mmm/software/java/bin/javadoc @options @packages @argfile</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>As a solution or workaround you need to include the `compile` goal into your build lifecycle so the module-path is properly configured:</code></pre>
</div>
</div>
<div class="paragraph">
<p>mvn compile javadoc:javadoc</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[[devonfw-guide_devon4j.wiki_guide-jdk.asciidoc_sources-and-links]]
== Sources and Links
We want to give credits and say thanks to the following articles that have been there before and helped us on our way:

* https://blog.codefx.org/java/java-9-migration-guide/[Java 9 Migration Guide: The Seven Most Common Challenges]
* https://medium.com/criciumadev/its-time-migrating-to-java-11-5eb3868354f9[It’s time! Migrating to Java 11]
* https://winterbe.com/posts/2018/08/29/migrate-maven-projects-to-java-11-jigsaw/[Migrate Maven Projects to Java 11]
* https://www.jesperdj.com/2018/09/30/jaxb-on-java-9-10-11-and-beyond/[JAXB on Java 9, 10, 11 and beyond]
* https://stackoverflow.com/questions/26413431/which-artifacts-should-i-use-for-jaxb-ri-in-my-maven-project[JAXB Artifacts]

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-jee.asciidoc]]
= JEE

This section is about Java Enterprise Edition (JEE).
Regarding to our xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_key-principles[key principles] we focus on open standards.
For Java this means that we consider official standards from Java Standard and Enterprise Edition as first choice for considerations.
Therefore we also decided to recommend xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc_jax-rs[JAX-RS] over https://spring.io/guides/gs/rest-service/[SpringMVC] as the latter is proprietary.
Only if an existing Java standard is *not* suitable for current demands such as Java Server Faces (JSF), we do not officially recommend it (while you are still free to use it if you have good reasons to do so).
In all other cases we officially suggest the according standard and use it in our guides, code-samples, sample application, modules, templates, etc.
Examples for such standards are xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc[JPA], xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc_jax-rs[JAX-RS], xref:devonfw-guide_devon4j.wiki_guide-soap.asciidoc_jax-ws[JAX-WS], xref:devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc[JSR330], xref:devonfw-guide_devon4j.wiki_guide-access-control.asciidoc[JSR250], xref:devonfw-guide_devon4j.wiki_guide-xml.asciidoc_jaxb[JAX-B], etc.

[[devonfw-guide_devon4j.wiki_guide-jee.asciidoc_application-server]]
== Application-Server
We designed everything based on standards to work with different technology stacks and servlet containers.
However, we strongly encourage to use modern and leightweight frameworks such as xref:devonfw-guide_devon4j.wiki_spring.asciidoc[spring] or xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[quarkus].
You are free to decide for a JEE application server but here is a list of good reasons for our decision:

* *Up-to-date*
+
With spring or quarkus you easily keep up to date with evolving technologies (microservices, reactive, NoSQL, etc.).
Most application servers put you in a jail with old legacy technology.
In many cases you are even forced to use a totally outdated version of java (JVM/JDK).
This may even cause severe IT-Security vulnerabilities but with expensive support you might get updates.
Also with leightweight open-source frameworks you need to be aware that for IT-security you need to update recently what can cost quite a lot of additional maintenance effort.
* *Development speed*
+
With spring-boot you can implement and especially test your individual logic very fast. Starting the app in your IDE is very easy, fast, and realistic (close to production). You can easily write JUnit tests that startup your server application to e.g. test calls to your remote services via HTTP fast and easy. For application servers you need to bundle and deploy your app what takes more time and limits you in various ways. We are aware that this has improved in the past but also spring continuously improves and is always way ahead in this area. Further, with spring you have your configurations bundled together with the code in version control (still with ability to handle different environments) while with application servers these are configured externally and can not be easily tested during development.
* *Documentation*
+
Spring and also quarkus have an extremely open and active community.
There is documentation for everything available for free on the web.
You will find solutions to almost any problem on platforms like stackoverflow.
If you have a problem you are only a google search away from your solution.
This is very much different for proprietary application server products.
* *Helpful Exception Messages*
+
Especially spring is really great for developers on exception messages.
If you do something wrong you get detailed and helpful messages that guide you to the problem or even the solution.
This is not as great in application servers.
* *Future-proof*
+
Spring has evolved really awesome over time.
Since its 1.0 release in 2004 spring has continuously been improved and always caught up with important trends and innovations.
Even in critical situations, when the company behind it (interface21) was sold, spring went on perfectly.
Quarkus on the other hand is relatively new.
It does not have to carry a large legacy history and is therefore most state-of-the-art for modern projects esp. in cloud environments.
JEE went through a lot of trouble and crisis.
Just look at the EJB pain stories.
This happened often in the past and also recent.
See https://dzone.com/articles/java-ee-8-in-crisis[JEE 8 in crisis].
* *Free*
+
Spring and quarkus including their ecosystems are free and open-source.
It still perfectly integrates with commercial solutions for specific needs.
Most application servers are commercial and cost a lot of money.
As of today the ROI for this is of question.
* *Cloud-native*
+
Quarkus is designed for cloud-native projects from the start.
With spring this is also available via xref:devonfw-guide_devon4j.wiki_spring.asciidoc_spring-native[spring-native].
Using an application server will effectively prevent you from going to the cloud smoothly.
* *Fun*
+
If you go to conferences or ask developers you will see that spring or quarkus is popular and fun.
If new developers are forced to use an old application server product they will be less motivated or even get frustrated.
Especially in today's agile projects this is a very important aspect.
In the end you will get into trouble with maintenance on the long run if you rely on a proprietary application server.

Of course the vendors of application servers will tell you a different story.
This is simply because they still make a lot of money from their products.
We do not get paid from application servers nor from spring, quarkus or any other IT product company.
We are just developers who love to build great systems.
A good reason for application servers is that they combine a set of solutions to particular aspects to one product that helps to standardize your IT.
However, http://www.devonfw.com/[devonfw] fills exactly this gap for the spring and quarkus ecosystems in a very open and flexible way.
However, there is one important aspect that you need to understand and be aware of:

Some big companies decided for a specific application server as their IT strategy.
They may have hundreds of apps running with this application server.
All their operators and developers have learned a lot of specific skills for this product and are familiar with it.
If you are implementing yet another (small) app in this context it could make sense to stick with this application server.
However, also they have to be aware that with every additional app they increase their technical debt.
So actively help your customer and consult him to make the right choices for the future.

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-validation.asciidoc]]
= Validation

Validation is about checking syntax and semantics of input data. Invalid data is rejected by the application.
Therefore validation is required in multiple places of an application. E.g. the xref:devonfw-guide_devon4j.wiki_guide-client-layer.asciidoc[GUI] will do validation for usability reasons to assist the user, early feedback and to prevent unnecessary server requests.
On the server-side validation has to be done for consistency and xref:devonfw-guide_devon4j.wiki_guide-security.asciidoc[security].

In general we distinguish these forms of validation:

* _stateless validation_ will produce the same result for given input at any time (for the same code/release).
* _stateful validation_ is dependent on other states and can consider the same input data as valid in once case and as invalid in another.

[[devonfw-guide_devon4j.wiki_guide-validation.asciidoc_stateless-validation]]
== Stateless Validation
For regular, stateless validation we use the JSR303 standard that is also called bean validation (BV).
Details can be found in the http://beanvalidation.org/1.1/spec/[specification].
As implementation we recommend http://hibernate.org/validator/[hibernate-validator].

[[devonfw-guide_devon4j.wiki_guide-validation.asciidoc_example]]
=== Example

A description of how to enable BV for spring applications can be found in the relevant http://docs.spring.io/spring-framework/docs/current/spring-framework-reference/htmlsingle/#validation-beanvalidation[Spring documentation]. A guide you can use to integrate validation in Quarkus applications can be found https://quarkus.io/guides/validation[here]. For a quick summary follow these steps:

* Make sure that hibernate-validator is located in the classpath by adding a dependency to the pom.xml.

.*spring*
[source,xml]
----
    &lt;dependency&gt;
      &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
      &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;
    &lt;/dependency&gt;
----

.*quarkus*
[source,xml]
----
    &lt;dependency&gt;
      &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
      &lt;artifactId&gt;quarkus-hibernate-validator&lt;/artifactId&gt;
    &lt;/dependency&gt;
----

* For methods to validate go to their declaration and add constraint annotations to the method parameters.
+
__In spring applications you can add the `+@Validated+` annotation to the implementation (spring bean) to be validated (this is an annotation of the spring framework, so it`s not available in the Quarkus context). The standard use case is to annotate the logic layer implementation, i.e. the use case implementation or component facade in case of simple logic layer pattern. Thus, the validation will be executed for service requests as well as batch processing.__

** +@Valid+ annotation to the arguments to validate (if that class itself is annotated with constraints to check).
** +@NotNull+ for required arguments.
** Other constraints (e.g. +@Size+) for generic arguments (e.g. of type +String+ or +Integer+). However, consider to create xref:devonfw-guide_devon4j.wiki_guide-datatype.asciidoc[custom datatypes] and avoid adding too much validation logic (especially redundant in multiple places).

//Replaced old example with BookingmanagementRestServiceImpl
//com.devonfw.application.mtsj.bookingmanagement.service.rest
.*BookingmanagementRestServiceImpl.java*
[source,java]
----
@Validated
public class BookingmanagementRestServiceImpl implements BookingmanagementRestService {
  ...
  public BookingEto saveBooking(@Valid BookingCto booking) {
  ...
----

* Finally add appropriate validation constraint annotations to the fields of the ETO class.

//com.devonfw.application.mtsj.bookingmanagement.logic.api.to
.*BookingCto.java*
[source,java]
----
  @Valid
  private BookingEto booking;
----
//com.devonfw.application.mtsj.bookingmanagement.logic.api.to
//Added an extra example due to this one being the only one using the hibernate-validation
.*BookingEto.java*
[source,java]
----
  @NotNull
  @Future
  private Timestamp bookingDate;
----

A list with all bean validation constraint annotations available for hibernate-validator can be found http://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/#table-spec-constraints[here]. In addition it is possible to configure custom constraints. Therefore it is necessary to implement a annotation and a corresponding validator. A description can also be found in the http://docs.spring.io/spring-framework/docs/current/spring-framework-reference/htmlsingle/#validation-beanvalidation-spring-constraints[Spring documentation] or with more details in the http://docs.jboss.org/hibernate/validator/4.3/reference/en-US/html/validator-customconstraints.html[hibernate documentation].

NOTE: **Bean Validation in Wildfly &gt;v8:** Wildfly v8 is the first version of Wildfly implementing the JEE7 specification. It comes with bean validation based on https://samaxes.com/2014/04/jaxrs-beanvalidation-javaee7-wildfly/[hibernate-validator out of the box]. In case someone is running Spring in Wildfly for whatever reasons, the spring based annotation @Validated would duplicate bean validation at runtime and thus should be omitted.

[[devonfw-guide_devon4j.wiki_guide-validation.asciidoc_gui-integration]]
=== GUI-Integration
TODO

[[devonfw-guide_devon4j.wiki_guide-validation.asciidoc_cross-field-validation]]
=== Cross-Field Validation
BV has poor support for this. Best practice is to create and use beans for ranges, etc. that solve this. A bean for a range could look like so:

[source,java]
----
public class Range&lt;V extends Comparable&lt;V&gt;&gt; {

  private V min;
  private V max;

  public Range(V min, V max) {

    super();
    if ((min != null) &amp;&amp; (max != null)) {
      int delta = min.compareTo(max);
      if (delta &gt; 0) {
        throw new ValueOutOfRangeException(null, min, min, max);
      }
    }
    this.min = min;
    this.max = max;
  }

  public V getMin() ...
  public V getMax() ...
----

[[devonfw-guide_devon4j.wiki_guide-validation.asciidoc_stateful-validation]]
== Stateful Validation
For complex and stateful business validations we do not use BV (possible with groups and context, etc.) but follow KISS and just implement this on the server in a straight forward manner.
An example is the deletion of a table in the example application. Here the state of the table must be checked first:

//com.devonfw.application.mtsj.bookingmanagement.logic.impl
//Replaced the old example with is not stateful anymore -which I think is weird- with a new one
//Text needs adjustments as well
*BookingmanagementImpl.java*
[source,java]
----
  private void sendConfirmationEmails(BookingEntity booking) {

    if (!booking.getInvitedGuests().isEmpty()) {
      for (InvitedGuestEntity guest : booking.getInvitedGuests()) {
        sendInviteEmailToGuest(guest, booking);
      }
    }

    sendConfirmationEmailToHost(booking);
  }

----

Implementing this small check with BV would be a lot more effort.

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]
//Replaced old person examples with new User example
[[devonfw-guide_devon4j.wiki_guide-beanmapping.asciidoc]]
= Bean-Mapping

For decoupling, you sometimes need to create separate objects (beans) for a different view. E.g. for an external service, you will use a xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc[transfer-object] instead of the xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entity[persistence entity] so internal changes to the entity do not implicitly change or break the service.

Therefore you have the need to map similar objects what creates a copy. This also has the benefit that modifications to the copy have no side-effect on the original source object. However, to implement such mapping code by hand is very tedious and error-prone (if new properties are added to beans but not to mapping code):
//Just the example adjusted to our MTSJ
[source,java]
----
public UserEto mapUser(UserEntity source) {
  UserEto target = new UserEto();
  target.setUsername(source.getUsername());
  target.setEmail(source.getEmail());
  ...
  return target;
}
----

Therefore we are using a `BeanMapper` for this purpose that makes our lives a lot easier.
There are several bean mapping frameworks with different approaches.

For a xref:devonfw-guide_devon4j.wiki_spring.asciidoc[devon4j-spring] application we recommend Orika, follow xref:devonfw-guide_devon4j.wiki_spring_guide-beanmapping-spring.asciidoc[Spring Bean-Mapping] for an introduction to Orika and Dozer in a devon4j-spring context application.

NOTE: devon4j started with http://dozer.sourceforge.net/[Dozer] as framework for Spring applications and still supports it. However, we now recommend Orika (for new projects) as it is much faster (see https://www.baeldung.com/java-performance-mapping-frameworks#2-orika[Performance of Java Mapping Frameworks]).

For a xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[Quarkus] application we recommend Mapstruct, follow xref:devonfw-guide_devon4j.wiki_quarkus_guide-beanmapping-quarkus.asciidoc[Quarkus Bean-Mapping] for an introduction to Mapstruct in a quarkus context application.








:leveloffset: 2


:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-lombok.asciidoc]]
= Lombok

https://projectlombok.org/[Lombok] is a library that works with an annotation processor and will generate code for you to save you some time and reduce the amount of boilerplate code in your project. Lombok can generate getter and setter, equals methods, automate your logging variables for your classes, and more. Follow the https://projectlombok.org/features/all[list of all the features] provided by Lombok to get an overview.


[[devonfw-guide_devon4j.wiki_guide-lombok.asciidoc_lombok-dependency]]
== Lombok Dependency
To get access to the Lombok library just add the following dependency to the POM.xml.

The Lombok dependency:
[source, xml]
----
&lt;dependency&gt;
	&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
	&lt;artifactId&gt;lombok&lt;/artifactId&gt;
	&lt;version&gt;1.18.20&lt;/version&gt;
&lt;/dependency&gt;
----
To get Lombok working with your current IDE you should also install the Lombok addon. Follow the https://projectlombok.org/setup/eclipse[Eclipse installation guide], there are also guides for other supported IDEs.

[[devonfw-guide_devon4j.wiki_guide-lombok.asciidoc_lombok-with-mapstruct]]
== Lombok with Mapstruct
MapStruct takes advantage of generated getters, setters, and constructors from Lombok and uses them to
generate the mapper implementations. Lombok is also an annotation processor and since version 1.18.14 both frameworks are working together. Just add the `lombok-mapstruct-binding` to your POM.xml.

The Lombok annotation processor and the `lombok-mapstruct-binding`
[source, xml]
----
&lt;dependency&gt;
	&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
	&lt;artifactId&gt;lombok-mapstruct-binding&lt;/artifactId&gt;
	&lt;version&gt;0.2.0&lt;/version&gt;
&lt;/dependency&gt;

&lt;plugin&gt;
	&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
	&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
	&lt;version&gt;3.8.1&lt;/version&gt;
	&lt;configuration&gt;
		&lt;source&gt;1.8&lt;/source&gt;
		&lt;target&gt;1.8&lt;/target&gt;
		&lt;annotationProcessorPaths&gt;
			&lt;path&gt;
				&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
				&lt;artifactId&gt;lombok&lt;/artifactId&gt;
				&lt;version&gt;1.18.4&lt;/version&gt;
			&lt;/path&gt;
			&lt;path&gt;
				&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
				&lt;artifactId&gt;lombok-mapstruct-binding&lt;/artifactId&gt;
				&lt;version&gt;0.2.0&lt;/version&gt;
			&lt;/path&gt;
		&lt;/annotationProcessorPaths&gt;
	&lt;/configuration&gt;
&lt;/plugin&gt;

----
In our https://github.com/devonfw-sample/devon4quarkus-reference[quarkus reference project] you can get a look into the usage of both frameworks.

[[devonfw-guide_devon4j.wiki_guide-lombok.asciidoc_lombok-usage]]
== Lombok Usage
Lombok can be used like any other annotation processor and will be shown in the simple example below to generate getter and setter for a _Product_ Entity.

[source, java]
----
@Getter
@Setter
public class Product{

    private String title;
    private String description;
    private BigDecimal price;
}
----

For advanced Lombok usage follow the https://www.baeldung.com/intro-to-project-lombok[Baeldung Lombok guide] or just read the https://projectlombok.org/api/[Lombok javadoc]

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-openapi.asciidoc]]
= OpenAPI

The xref:devonfw-guide/devon4j.wiki_https://spec.openapis.org/oas/latest.html[OpenAPI Specification (OAS)] defines a standard for describing RESTful web services in a machine- and human-readable format. OpenAPI allows REST APIs to be defined in a uniform manner.
Technically, an OpenAPI document is written in YAML or JSON format. The specification defines the structure of a REST API by describing attributes such as path information, response codes, and return types. Some examples can be found xref:devonfw-guide/devon4j.wiki_https://github.com/OAI/OpenAPI-Specification/tree/main/examples/v3.0[here].
Apart from documenting the API, this schema then also acts as a contract between provider and consumers, guaranteeing interoperability between various technologies.

OpenAPI is often used in combination with xref:devonfw-guide/devon4j.wiki_https://swagger.io/[Swagger]. Swagger is a set of tools build around OpenAPI, that help developers to design and document their REST APIs.
The most common tool is the xref:devonfw-guide/devon4j.wiki_https://swagger.io/tools/swagger-ui/[Swagger UI], which uses the OpenAPI specification to create a graphical interface of the REST API that you can also interact with. Check out the xref:devonfw-guide/devon4j.wiki_https://editor.swagger.io/[Swagger online editor] to get a feeling for it.

[NOTE]
====
Swagger and OpenAPI: Swagger is a former specification, based on which the OpenAPI was created. Swagger 2.0 is still commonly used for describing APIs. OpenAPI is an open-source collaboration and it started from version 3.0.0(semver)
====

There are many tools that work with OpenAPI: code generators, documentation tools, validators etc.

[[devonfw-guide_devon4j.wiki_guide-openapi.asciidoc_openapi-generation]]
== OpenAPI generation

There are several extensions you can use in your project to automatically generate the OpenAPI specifications and Swagger UI from your REST API (code-first approach). devon4j recommends the following two extensions/plugins to use:

* Smallrye OpenAPI extension
* ServicedocGen maven plugin

[[devonfw-guide_devon4j.wiki_guide-openapi.asciidoc_smallrye-openapi]]
=== Smallrye OpenAPI

Quarkus provides OpenAPI support through Smallrye OpenAPI extension:

[source,xml]
--------
&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-smallrye-openapi&lt;/artifactId&gt;
&lt;/dependency&gt;
--------

After adding the extension to your project, you can access the Swagger UI by navigating to `/q/swagger-ui`.

The OpenAPI specification can be accessed by requesting `/q/openapi`.

Smallrye OpenAPI is compliant with xref:devonfw-guide/devon4j.wiki_https://github.com/eclipse/microprofile-open-api[MicroProfile OpenAPI]. You can add MicroProfile annotations to further describe your REST endpoints and extend the OpenAPI documentation.
More information for this can be found xref:devonfw-guide/devon4j.wiki_https://quarkus.io/blog/openapi-for-everyone/#openapi[here] or xref:devonfw-guide/devon4j.wiki_https://download.eclipse.org/microprofile/microprofile-open-api-1.0/microprofile-openapi-spec.html#_documentation_mechanisms[here].

[NOTE]
====
Quarkus recommends using this extension and you can document your APIs in great detail by using the MicroProfile annotations. The downside to this is that using these annotations will blow up your code and you will have some duplicate information in it.
If you don't want to specify the REST API again with all this annotation based information, we also recommend taking a look at the ServicedocGen Maven plugin for your Quarkus applications when implementing JAX-RS APIs.
====

[[devonfw-guide_devon4j.wiki_guide-openapi.asciidoc_servicedocgen-maven-plugin]]
=== ServicedocGen Maven Plugin

The xref:devonfw-guide/devon4j.wiki_https://github.com/mojohaus/servicedocgen-maven-plugin[ServicedocGen maven plugin] can be used within both Spring and Quarkus applications.
It works a bit different then the Smallrye extensions mentioned above. The plugin analysis the REST API and it's JavaDoc and then generate the OpenAPI specification and the Swagger UI as static files. So no Swagger or MicroProfile annotations have to be added.

The plugin can be configured in the pom.xml file of your application as follows:

[source,xml]
--------
&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
      &lt;artifactId&gt;servicedocgen-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;1.0.0&lt;/version&gt;
      &lt;executions&gt;
        &lt;execution&gt;
          &lt;goals&gt;
            &lt;goal&gt;generate&lt;/goal&gt;
          &lt;/goals&gt;
        &lt;/execution&gt;
      &lt;/executions&gt;
      &lt;configuration&gt;
        &lt;descriptor&gt;
          &lt;info&gt;
            &lt;title&gt;...&lt;/title&gt;
            &lt;description&gt;...&lt;/description&gt;
          &lt;/info&gt;
          &lt;host&gt;...&lt;/host&gt;
          &lt;port&gt;...&lt;/port&gt;
          &lt;basePath&gt;...&lt;/basePath&gt;
          &lt;schemes&gt;
            &lt;scheme&gt;...&lt;/scheme&gt;
          &lt;/schemes&gt;
        &lt;/descriptor&gt;
      &lt;/configuration&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;
--------

In the configuration section you have to define additional information to generate the OpenAPI specification correctly. An example can be found in our xref:devonfw-guide/devon4j.wiki_https://github.com/devonfw-sample/devon4quarkus-reference/blob/master/pom.xml[Quarkus reference application].
When building the application, an OpenApi.yaml and a SwaggerUI.html file are created in the `/target/site` folder. To make the Swagger UI available in the browser, the file must be served by some servlet.

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +1

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_spring.asciidoc]]
= Spring

https://spring.io[Spring] is the most famous and established Java framework.
It is fully supported by https://devonfw.com[devonfw] as an option and alternative to xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[quarkus].

[[devonfw-guide_devon4j.wiki_spring.asciidoc_guide-to-the-reader]]
== Guide to the Reader

Dependent on the intention you are reading this document, you might be most interested in the following chapters:

* If you are not yet familiar with Spring, you may be interested in xref:devonfw-guide_devon4j.wiki_spring.asciidoc_pros[pros] and xref:devonfw-guide_devon4j.wiki_spring.asciidoc_cons[cons] of Spring. Also take a look at the xref:devonfw-guide/devon4j.wiki_https://spring.io/why-spring[official Spring website].

* If you already have experience developing with Spring but are new to devon4j, take a look at devon4j's recommendations on general best practices. Check out the chapters on xref:devonfw-guide_devon4j.wiki_architecture.asciidoc[architecture design], xref:devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc[project structuring] and xref:devonfw-guide_devon4j.wiki_coding-conventions.asciidoc[coding conventions]. Follow the referenced links to go deeper into a topic.

* If you have already developed with devon4j and Spring and need more information on a specific topic, check out the xref:devonfw-guide/devon4j.wiki_https://devonfw.com/website/pages/docs/devon4j.wiki_devon4j_guides.html[devon4j guides for Spring]. If you don't find what you are looking for there, check out the xref:devonfw-guide/devon4j.wiki_https://devonfw.com/website/pages/docs/devon4j_general.html[general section]. devon4j uses general solutions for Java, so solutions for both Spring and Quarkus are documented there.

* If you want to get started or create your first Spring application using devon4j, check out the guide about xref:devonfw-guide_devon4j.wiki_tutorial-newapp.asciidoc[creating a new application] or the xref:devonfw-guide/devon4j.wiki_https://github.com/devonfw/jump-the-queue[Jump the Queue] and xref:devonfw-guide/devon4j.wiki_https://github.com/devonfw/my-thai-star[My Thai Star] reference applications.

[[asciidoc_devonfw-guide_devon4j.wiki_spring.asciidoc_pros]]
[[asciidoc_devonfw-guide_devon4j.wiki_spring.asciidoc_pros_2]]
== Pros

Spring offers the following benefits:

* *highly flexible* +
Spring is famous for its great flexibility. You can customize and integrate nearly everything.
* *well established* +
While xref:devonfw-guide_devon4j.wiki_guide-jee.asciidoc[JEE] application servers including very expensive commercial products turned out to be a dead-end, spring has guided projects through the changing trends of IT throughout decades. It may be the framework with the longest history track and popularity. As a result you can easily find developers, experts, books, articles, etc. about spring.
* *non-invasive and not biased* +
Spring became famous for its non-invasive coding based on patterns instead of hard dependencies. It gives you a lot of freedom and avoids tight coupling of your (business) code.

See https://spring.io/why-spring[Why Spring?] for details.

[[asciidoc_devonfw-guide_devon4j.wiki_spring.asciidoc_cons]]
[[asciidoc_devonfw-guide_devon4j.wiki_spring.asciidoc_cons_4]]
== Cons

Spring has the following drawbacks:

* *history and legacy* +
Due to the pro of its long established history, spring also carries a lot of legacy. As a result there are many ways to do the same thing while some options may be discouraged. Developers needs some guidance (e.g. via devon4j) as they may enter pitfalls and dead-ends when choosing the first solution they found on google or stackoverflow.
* *lost lead in cloud-native* +
While for the last decades spring was leading innovation in Java app development, it seems that with the latest trends and shift such as cloud-native, they have been overtaken by frameworks like xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[quarkus]. However, spring is trying to catch up with xref:devonfw-guide_devon4j.wiki_spring.asciidoc_spring-native[spring-native].

[[devonfw-guide_devon4j.wiki_spring.asciidoc_spring-boot]]
== Spring-Boot

https://spring.io/projects/spring-boot[Spring-boot] is a project and initiaitve within the spring-ecosystem that brought a lot of innovation and simplification into app development on top of spring.
As of today we typically use the terms _spring_ and _spring-boot_ rather synonymously as we always use spring together with spring-boot.

[[devonfw-guide_devon4j.wiki_spring.asciidoc_spring-native]]
== Spring-Native

https://github.com/spring-projects-experimental/spring-native[Spring-native] adds cloud-native support to the spring ecosystem and allows to build a spring app as cloud-native image via https://www.graalvm.org/[GraalVM].
You may also consider xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[Quarkus] if you are interested in building cloud-native images. For a comparison of both Spring Native and Quarkus, you may refer to our xref:devonfw-guide_devon4j.wiki_Spring-native-vs-Quarkus.asciidoc[Spring Native vs. Quarkus] guide.

:leveloffset: 2

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-component.asciidoc]]
= Components

Following xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_architecture-principles[separation-of-concerns] we divide an application into components using our xref:devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_packages[package-conventions] and xref:devonfw-guide_devon4j.wiki_guide-structure.asciidoc[project structure].
As described by the xref:devonfw-guide_devon4j.wiki_architecture.asciidoc[architecture] each component is divided into layers as described in the xref:devonfw-guide_devon4j.wiki_guide-structure.asciidoc[project structure].
Please note that a component will only have the required layers.
So a component may have any number from one to all layers.

[[devonfw-guide_devon4j.wiki_guide-component.asciidoc_general-component]]
== General Component
Cross-cutting aspects belong to the implicit component `general`. It contains technical configurations and very general code that is not business specific. Such code shall not have any dependencies to other components and therefore business related code.

[[devonfw-guide_devon4j.wiki_guide-component.asciidoc_business-component]]
== Business Component
The xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_business-architecture[business-architecture] defines the business components with their allowed dependencies. A small application (microservice) may just have one component and no dependencies making it simple while the same architecture can scale up to large and complex applications (from bigger microservice up to modulith).
Tailoring an business domain into applications and applications into components is a tricky task that needs the skills of an experienced architect.
Also, the tailoring should follow the business and not split by technical reasons or only by size.
Size is only an indicator but not a driver of tailoring.
Whatever hypes like microservices are telling you, never get misled in this regard:
If your system grows and reaches `MAX+1` lines of code, it is not the right motivation to split it into two microservices of `~MAX/2` lines of code - such approaches will waste huge amounts of money and lead to chaos.

[[devonfw-guide_devon4j.wiki_guide-component.asciidoc_app-component]]
== App Component
Only in case you need cross-cutting code that aggregates another component you may introduce the component `app`.
It is allowed to depend on all other components but no other component may depend on it.
With the modularity and flexibility of spring you typically do not need this.
However, when you need to have a class that registers all services or component-facades using direct code dependencies, you can introduce this component.

[[devonfw-guide_devon4j.wiki_guide-component.asciidoc_component-example]]
== Component Example
The following class diagram illustrates an example of the business component `Staffmanagement`:

image::images/guide-logic-layer.png["logic layer component pattern",scaledwidth="80%",align="center"]

In this scheme, you can see the structure and flow from the xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[service-layer] (REST service call) via the xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc[logic-layer] to the xref:devonfw-guide_devon4j.wiki_guide-dataaccess-layer.asciidoc[dataaccess-layer] (and back).

:leveloffset: 2

:leveloffset: +2

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc]]
= Classic project structure

In this section we describe the classic project structure as initially proposed for Java in devonfw.
It is still valid and fully supported.
However, if you want to start a new project, please consider using the xref:devonfw-guide_devon4j.wiki_guide-structure-modern.asciidoc[modern structure].

[[devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc_modules]]
== Modules

The structure of a `devon4j` application is divided into the following modules:

* `api`: module containing the API of your application. The API contains the required artifacts to interact with your application via remote services. This can be xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc_jax-rs[REST service interfaces], xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc[transfer-objects] with their interfaces and xref:devonfw-guide_devon4j.wiki_guide-datatype.asciidoc[datatypes] but also https://www.openapis.org/[OpenAPI] or https://grpc.io/[gRPC] contracts.
* `core`: maven module containing the core of the application with service implementation, as well as entire xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc[logic layer] and xref:devonfw-guide_devon4j.wiki_guide-dataaccess-layer.asciidoc[dataaccess layer].
* `batch`: optional module for xref:devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc[batch layer]
* `server`: module that bundles the entire app (`core` with optional `batch`) typically as a bootified WAR file.

[[devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc_deployment]]
== Deployment

[quote, Josh Long]
____
Make jar not war
____

First of all it is important to understand that the above defined modules aim to make `api`, `core`, and `batch` reusable artifacts, that can be used as a regular maven dependency.
On the other hand to build and deploy your application you want a final artifact that is containing all required 3rd party libraries.
This artifact is not reusable as a maven dependency.
That is exactly the purpose of the `server` module to build and package this final deployment artifact.
By default we first build a regular `WAR` file with maven in your `server/target` directory (`\*-server-«version».war`) and in a second step create a bootified `WAR` out of this (`*-server-bootified.war`).
The bootified `WAR` file can then be started standalone (`java -jar «filename».war`).
However, it is also possible to deploy the same `WAR` file to a servlet container like `tomcat` or `jetty`.
As application servers and externally provided servlet containers are not recommendet anymore for various reasons (see xref:devonfw-guide_devon4j.wiki_guide-jee.asciidoc[JEE]), you may also want to create a bootified `JAR` file instead.
All you need to do in that case is to change the `packaging` in your `server/pom.xml` from `war` to `jar`.

[[devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc_package-structure]]
== Package Structure

The package structure of your code inside `src/main/java` (and `src/test/java`) of your modules is described in our coding conventions in the sections xref:devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_packages[packages]. A full mapping of the architecture and the different code elements to the packaging is described in the following section.

[[devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc_layers]]
== Layers

The package structure of your code inside `src/main/java` (and `src/test/java`) of your app is described in our coding conventions in the sections xref:devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_packages[packages].
The following table describes our classic approach for packaging and layering:

.Traditional generic devon4j layers
[options="header"]
|=============================================
|*Layer* | *«layer»*
|xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[service]|`service`
|xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc[logic]|`logic`
|xref:devonfw-guide_devon4j.wiki_guide-dataaccess-layer.asciidoc[data-access]|`dataaccess`
|xref:devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc[batch] (optional)|`batch`
|xref:devonfw-guide_devon4j.wiki_guide-client-layer.asciidoc[client] (optional)|`client`
|xref:devonfw-guide_devon4j.wiki_guide-common.asciidoc[common]|`common`
|=============================================

[[devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc_architecture-mapping]]
== Architecture Mapping

In order to help you to map the architecture, packaging, layering, etc. to the code and see where different code elements should be placed,
we provide this architecture mapping:

[subs=+macros]
----
«root»
├──.xref:devonfw-guide_devon4j.wiki_guide-component.asciidoc_business-component[«component»]
|  ├──.xref:devonfw-guide_devon4j.wiki_guide-common.asciidoc[common]
|  |  ├──.api[.«detail»]
|  |  |  ├──.xref:devonfw-guide_devon4j.wiki_guide-datatype.asciidoc[datatype]
|  |  |  |  └──.xref:devonfw-guide_devon4j.wiki_guide-datatype.asciidoc[«Datatype»] (api)
|  |  |  └──.xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc_bo[«BusinessObject»] (api)
|  |  └──.impl[.«detail»]
|  |     ├──.xref:devonfw-guide_devon4j.wiki_guide-configuration-mapping.asciidoc_mapping-advanced-configuration[«Aspect»ConfigProperties] (core)
|  |     ├──.xref:devonfw-guide_devon4j.wiki_guide-json.asciidoc_custom-mapping[«Datatype»JsonSerializer] (core)
|  |     └──.xref:devonfw-guide_devon4j.wiki_guide-json.asciidoc_custom-mapping[«Datatype»JsonDeserializer] (core)
|  ├──.xref:devonfw-guide_devon4j.wiki_guide-dataaccess-layer.asciidoc[dataaccess]
|  |  ├──.api[.«detail»]
|  |  |  ├──.xref:devonfw-guide_devon4j.wiki_guide-repository.asciidoc[repo]
|  |  |  |  └──.xref:devonfw-guide_devon4j.wiki_guide-repository.asciidoc_repository[«BusinessObject»Repository] (core)
|  |  |  ├──.xref:devonfw-guide_devon4j.wiki_guide-dao.asciidoc[dao] (core) [alternative to repo]
|  |  |  |  └──.xref:devonfw-guide_devon4j.wiki_guide-dao.asciidoc[«BusinessObject»Dao] (core) [alternative to Repository]
|  |  |  └──.xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entity[«BusinessObject»Entity] (core)
|  |  └──.impl[.«detail»]
|  |     ├──.xref:devonfw-guide_devon4j.wiki_guide-dao.asciidoc[dao] (core) [alternative to repo]
|  |     |  └──.xref:devonfw-guide_devon4j.wiki_guide-dao.asciidoc[«BusinessObject»DaoImpl] (core) [alternative to Repository]
|  |     └──.xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entities-and-datatypes[«Datatype»AttributeConverter] (core)
|  ├──.xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc[logic]
|  |  ├──.api
|  |  |  ├──.[«detail».]xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc[to]
|  |  |  |   ├──.xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc_to[«MyCustom»«To] (api)
|  |  |  |   ├──.xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_embeddable[«DataStructure»Embeddable] (api)
|  |  |  |   ├──.xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc_eto[«BusinessObject»Eto] (api)
|  |  |  |   └──.xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc_cto[«BusinessObject»«Subset»Cto] (api)
|  |  |  ├──.[«detail».]xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc[usecase]
|  |  |  |   ├──.xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc_find[UcFind«BusinessObject»] (core)
|  |  |  |   ├──.xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc_manage[UcManage«BusinessObject»] (core)
|  |  |  |   └──.xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc_custom[Uc«Operation»«BusinessObject»] (core)
|  |  |  └──.xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc_component[«Component»] (core)
|  |  ├──.base
|  |  |  └──.[«detail».]xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc[usecase]
|  |  |     └──.xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc[Abstract«BusinessObject»Uc] (core)
|  |  └──.impl
|  |     ├──.[«detail».]xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc[usecase]
|  |     |   ├──.xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc_find[UcFind«BusinessObject»Impl] (core)
|  |     |   ├──.xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc_manage[UcManage«BusinessObject»Impl] (core)
|  |     |   └──.xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc_custom[Uc«Operation»«BusinessObject»Impl] (core)
|  |     └──.xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc_component[«Component»Impl] (core)
|  └──.xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[service]
|     ├──.api[.«detail»]
|     |  ├──.xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc[rest]
|     |  |  └──.xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc_rest-service-api[«Component»RestService] (api)
|     |  └──.xref:devonfw-guide_devon4j.wiki_guide-soap.asciidoc[ws]
|     |     └──.xref:devonfw-guide_devon4j.wiki_guide-soap.asciidoc_web-service-api[«Component»WebService] (api)
|     └──.impl[.«detail»]
|        ├──.xref:devonfw-guide_devon4j.wiki_guide-jms.asciidoc[jms]
|        |  └──.xref:devonfw-guide_devon4j.wiki_guide-jms.asciidoc_jms-listener[«BusinessObject»JmsListener] (core)
|        ├──.xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc[rest]
|        |  └──.xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc_rest-service-implementation[«Component»RestServiceImpl] (core)
|        └──.xref:devonfw-guide_devon4j.wiki_guide-soap.asciidoc[ws]
|           └──.xref:devonfw-guide_devon4j.wiki_guide-soap.asciidoc_web-service-implementation[«Component»WebServiceImpl] (core)
├──.xref:devonfw-guide_devon4j.wiki_guide-component.asciidoc_general-component[general]
│  ├──.xref:devonfw-guide_devon4j.wiki_guide-common.asciidoc[common]
│  |  ├──.api
|  |  |  ├──.to
|  |  |  |  ├──.AbstractSearchCriteriaTo (api)
|  |  |  └──.ApplicationEntity
│  |  ├──.base
|  |  |  └──.AbstractBeanMapperSupport (core)
│  |  └──.impl
│  |     ├──.config
│  |     |  └──.ApplicationObjectMapperFactory (core)
│  |     └──.security
│  |        └──.ApplicationWebSecurityConfig (core)
│  ├──.dataaccess
│  |  └──.api
|  |     └──.ApplicationPersistenceEntity (core)
│  ├──.logic
│  |  └──.base
|  |     ├──.AbstractComponentFacade (core)
|  |     ├──.AbstractLogic (core)
|  |     └──.AbstractUc (core)
|  └──.service
|     └──...
└──.SpringBootApp (core)
----

:leveloffset: 2

&lt;&lt;&lt;&lt;


[[devonfw-guide_devon4j.wiki_devon4j.asciidoc_layers]]
=== Layers

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-client-layer.asciidoc]]
= Client Layer

There are various technical approaches to building GUI clients. The devonfw proposes rich clients that connect to the server via data-oriented services (e.g. using REST with JSON).
In general, we have to distinguish among the following types of clients:

* web clients
* native desktop clients
* (native) mobile clients

Our main focus is on web-clients. In our sample application https://github.com/devonfw/my-thai-star/[my-thai-star] we offer a responsive web-client based on Angular following https://github.com/devonfw/devon4ng/[devon4ng] that integrates seamlessly with the back ends of my-thai-star available for Java using devon4j as well as .NET/C# using https://github.com/devonfw/devon4net/[devon4net]. For building angular clients read the separate https://github.com/devonfw/devon4ng/wiki[devon4ng guide].

[[devonfw-guide_devon4j.wiki_guide-client-layer.asciidoc_javascript-for-java-developers]]
== JavaScript for Java Developers

In order to get started with client development as a Java developer we give you some hints to get started. Also if you are an experienced JavaScript developer and want to learn Java this can be helpful. First, you need to understand that the JavaScript ecosystem is as large as the Java ecosystem and developing a modern web client requires a lot of knowledge. The following table helps you as experienced developer to get an overview of the tools, configuration-files, and other related aspects from the new world to learn. Also it helps you to map concepts between the ecosystems. Please note that we list the tools recommended by devonfw here (and we know that there are alternatives not listed here such as gradle, grunt, bower, etc.).

.Aspects in JavaScript and Java ecosystem
[options="header"]
|=======================
|*Topic*                |*Aspect*  |*JavaScript*|*Java*
|Programming            |Language  |https://www.typescriptlang.org/[TypeScript] (extends https://www.javascript.com/[JavaScript])|https://docs.oracle.com/javase/tutorial/[Java]
|Runtime                |VM        |https://nodejs.org/[nodejs] (or web-browser)|http://www.oracle.com/technetwork/java/javase/[jvm]
.5+|Build- &amp; Dependency-Management
|Tool      |https://github.com/npm/npm[npm] or http://yarnpkg.com/[yarn]|https://maven.apache.org/[maven]
|Config    |https://docs.npmjs.com/files/package.json[package.json]|https://maven.apache.org/pom.html[pom.xml]
|Repository|https://www.npmjs.com/[npm repo]|http://repo.maven.apache.org/maven2[maven central] (https://mvnrepository.com/[repo search])
|Build cmd |`https://angular.io/cli[ng] build` or `npm run build` (goals are not standardized in npm) |mvn https://maven.apache.org/plugins/maven-install-plugin/usage.html[install] (see https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html[lifecycle])
|Test cmd  |`https://angular.io/cli[ng] test`|mvn http://maven.apache.org/components/surefire/maven-surefire-plugin/[test]

.3+|xref:devonfw-guide_devon4j.wiki_guide-testing.asciidoc[Testing]
|Test-Tool |http://jasmine.github.io/[jasmine]|http://junit.org/[junit]
|Test-Runner|https://karma-runner.github.io/[karma]|http://junit.org/[junit] / http://maven.apache.org/components/surefire/maven-surefire-plugin/[surefire]
|E2E Testing|https://www.protractortest.org/[Protractor]|http://www.seleniumhq.org/[Selenium]

.1+|Code Analysis

|Code Coverage|`https://angular.io/guide/testing-code-coverage[ng test --no-watch --code-coverage]`|http://www.eclemma.org/jacoco/[JaCoCo]

.2+|Development

|IDE  |https://code.visualstudio.com/[MS VS Code] or https://www.jetbrains.com/idea/[IntelliJ]|https://eclipse.org/downloads/[Eclipse] or https://www.jetbrains.com/idea/[IntelliJ]

|Framework  |https://angularjs.org/[Angular] (etc.)|xref:devonfw-guide_devon4j.wiki_spring.asciidoc[Spring] or xref:devonfw-guide_devon4j.wiki_quarkus.asciidoc[Quarkus]
|=======================


:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc]]
= Service Layer

The service layer is responsible for exposing functionality made available by the xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc[logical layer] to external consumers over a network via xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc_protocol[technical protocols].

[[devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc_types-of-services]]
== Types of Services

Before you start creating your services you should consider some general design aspects:

* Do you want to create a https://en.wikipedia.org/wiki/Remote_procedure_call[RPC] service?
* Or is your problem better addressed by messaging or eventing?
* Who will consume your service?
** Do you have one or multiple consumers?
** Do web-browsers have to use your service?
** Will apps from other vendors or parties have to consume your service that you can not influence if the service may have to change or be extended?

For RPC a common choice is xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc[REST] but there are also interesting alternatives like https://grpc.io/[gRPC]. We also have a guide for xref:devonfw-guide_devon4j.wiki_guide-soap.asciidoc[SOAP] but this technology should rather be considered as legacy and is not recommended for new services.

When it comes to messaging in Java the typical answer will be xref:devonfw-guide_devon4j.wiki_guide-jms.asciidoc[JMS]. However, a very promising alternative is xref:devonfw-guide_devon4j.wiki_guide-kafka.asciidoc[Kafka].

[[devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc_versioning]]
== Versioning
For RPC services consumed by other applications we use versioning to prevent incompatibilities between applications when deploying updates. This is done by the following conventions:

* We define a version number and prefix it with `v` (e.g. `v1`).
* If we support previous versions we use that version numbers as part of the Java package defining the service API (e.g. `com.foo.application.component.service.api.v1`)
* We use the version number as part of the service name in the remote URL (e.g. `https://application.foo.com/services/rest/component/v1/resource`)
* Whenever breaking changes are made to the API, create a separate version of the service and increment the version (e.g. `v1` -&gt; `v2`) . The implementations of the different versions of the service contain compatibility code and delegate to the same unversioned use-case of the logic layer whenever possible.
* For maintenance and simplicity, avoid keeping more than one previous version.

[[devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc_interoperability]]
== Interoperability
For services that are consumed by clients with different technology, _interoperability_ is required. This is addressed by selecting the right protocol, following protocol-specific best practices and following our considerations especially _simplicity_.

[[devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc_service-considerations]]
== Service Considerations
The term _service_ is quite generic and therefore easily misunderstood. It is a unit exposing coherent functionality via a well-defined interface over a network. For the design of a service, we consider the following aspects:

* *self-contained* +
The entire API of the service shall be self-contained and have no dependencies on other parts of the application (other services, implementations, etc.).
* *idempotence* +
E.g. creation of the same master-data entity has no effect (no error)
* *loosely coupled* +
Service consumers have minimum knowledge and dependencies on the service provider.
* *normalized* +
Complete, no redundancy, minimal
* *coarse-grained* +
Service provides rather large operations (save entire entity or set of entities rather than individual attributes)
* *atomic* +
Process individual entities (for processing large sets of data, use a xref:devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc[batch] instead of a service)
* *simplicity* +
Avoid polymorphism, RPC methods with unique name per signature and no overloading, avoid attachments (consider separate download service), etc.

[[devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc_security]]
== Security
Your services are the major entry point to your application. Hence, security considerations are important here.

See xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc_security[REST Security].

:leveloffset: 2

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-service-versioning.asciidoc]]
= Service-Versioning

This guide describes the aspect and details about versioning of xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[services]

[[devonfw-guide_devon4j.wiki_guide-service-versioning.asciidoc_motivation]]
== Motivation
Why versioning of services? First of all, you should only care about this topic if you really have to. Service versioning is complex and requires effort (time and budget). The best way to avoid this is to be smart in the first place when designing the service API.
Further, if you are creating services where the only consumer is e.g. the web-client that you deploy together with the consumed services then you can change your service without the overhead to create new service versions and keeping old service versions for compatibility.

However, if the following indicators are given you typically need to do service versioning:

* Your service is part of a complex and distributed IT landscape
* Your service requires incompatible changes
* There are many consumers or there is at least one (relevant) consumer that can not be updated at the same time or is entirely out of control (unknown or totally different party/company)

What are incompatible changes?

* Almost any change when xref:devonfw-guide_devon4j.wiki_guide-soap.asciidoc[SOAP] is used (as it changes the WSDL and breaks the contract). Therefore, we recommend to use xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc[REST] instead. Then, only the following changes are critical.
* A change where existing properties (attributes) have to change their name
* A change where existing features (properties, operations, etc.) have to change their semantics (meaning)

What changes do not cause incompatibilities?

* Adding new service operations is entirely uncritical with xref:devonfw-guide_devon4j.wiki_guide-rest.asciidoc[REST].
* Adding new properties is only a problem in the following cases:
** Adding new mandatory properties to the input of a service is causing incompatibilities. This problem can be avoided by contract-design.
** If a consumer is using a service to read data, modify it and then save it back via a service and a property is added to the data, then this property might be lost. This is not a problem with dynamic languages such as JavaScript/TypeScript but with strictly typed languages such as Java. In Java you will typically use structured typed transfer-objects (and not `Map&lt;String, Object&gt;`) so new properties that have been added but are not known to the consumer can not be mapped to the transfer-object and will be lost. When saving that transfer-object later the property will be gone. It might be impossible to determine the difference between a lost property and a property that was removed on purpose. This is a general problem that you need to be aware of and that you have to consider by your design in such situations.

Even if you hit an indicator for incompatible changes you can still think about adding a new service operation instead of changing an existing one (and deprecating the old one). Be creative to simplify and avoid extra effort.

[[devonfw-guide_devon4j.wiki_guide-service-versioning.asciidoc_procedure]]
== Procedure
The procedure when rolling out incompatible changes is illustrated by the following example:

[source]
----
+------+  +------+
| App1 |  | App2 |
+---+--+  +--+---+
    |        |
    +---+----+
        |
+-------+--------+
|      Sv1       |
|                |
|      App3      |
+----------------+
----

So, here we see a simple example where `App3` provides a Service `S` in Version `v1` that is consumed both by `App1` and `App2`.

Now for some reason the service `S` has to be changed in an incompatible way to make it future-proof for demands. However, upgrading all 3 applications at the same time is not possible in this case for whatever reason. Therefore, service versioning is applied for the changes of `S`.

[source]
----
+------+  +------+
| App1 |  | App2 |
+---+--+  +--+---+
    |        |
    +--------+
    |
+---+------------+
|  Sv1  |  Sv2   |
|                |
|      App3*     |
+----------------+
----

Now, `App3` has been upgraded and the new release was deployed. A new version `v2` of `S` has been added while `v1` is still kept for compatibility reasons and that version is still used by `App1` and `App2`.

[source]
----
+------+  +------+
| App1 |  | App2*|
+---+--+  +--+---+
    |        |
    |        |
    |        |
+---+--------+---+
|  Sv1  |  Sv2   |
|                |
|      App3      |
+----------------+
----

Now, `App2` has been updated and deployed and it is using the new version `v2` of `S`.

[source]
----
+------+  +------+
| App1*|  | App2 |
+---+--+  +--+---+
    |        |
    +--------+
             |
+------------+---+
|  Sv1  |  Sv2   |
|                |
|      App3      |
+----------------+
----

Now, also `App1` has been updated and deployed and it is using the new version `v2` of `S`. The version `v1` of `S` is not used anymore. This can be verified via logging and monitoring.

[source]
----
+------+  +------+
| App1 |  | App2 |
+---+--+  +--+---+
    |        |
    +--------+
             |
+------------+---+
|          Sv2   |
|                |
|      App3*     |
+----------------+
----

Finally, version `v1` of the service `S` was removed from `App3` and the new release has been deployed.

[[devonfw-guide_devon4j.wiki_guide-service-versioning.asciidoc_versioning-schema]]
== Versioning Schema
In general anything can be used to differentiate versions of a service. Possibilities are:

* Code names (e.g. `Strawberry`, `Blueberry`, `Grapefruit`)
* Timestamps (`YYYYMMDD-HHmmSS`)
* Sequential version numbers (e.g. `v1`, `v2`, `v3`)
* Composed version numbers (e.g. `1.0.48-pre-alpha-3-20171231-235959-Strawberry`)

As we are following the KISS principle (see xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_key-principles[key principles]) we propose to use sequential version numbers. These are short, clear, and easy while still allowing to see what version is after another one. Especially composed version numbers (even `1.1` vs. `2.0`) lead to decisions and discussions that easily waste more time than adding value. It is still very easy to maintain an Excel sheet or release-notes document that is explaining the changes for each version (`v1`, `v2`, `v3`) of a particular service.

We suggest to always add the version schema to the service URL to be prepared for service versioning even if service versioning is not (yet) actively used. For simplicity it is explicitly stated that you may even do incompatible changes to the current version (typically `v1`) of your service if you can update the according consumers within the same deployment.

[[devonfw-guide_devon4j.wiki_guide-service-versioning.asciidoc_practice]]
== Practice
So assuming you know that you have to do service versioning, the question is how to do it practically in the code.
The approach for your devon4j project in case of code-first should be as described below:

* Determine which types in the code need to be changed. It is likely to be the API and implementation of the according service but it may also impact transfer objects and potentially even datatypes.
* Create new packages for all these concerned types containing the current version number (e.g. `v1`).
* Copy all these types to that new packages.
* Rename these copies so they carry the version number as suffix (e.g. `V1`).
* Increase the version of the service in the unversioned package (e.g. from `v1` to `v2`).
* Now you have two versions of the same service (e.g. `v1` and `v2`) but so far they behave exactly the same.
* You start with your actual changes and modify the original files that have been copied before.
* You will also ensure the links (import statements) of the copied types point to the copies with the version number
* This will cause incompatibilities (and compile errors) in the copied service. Therefore, you need to fix that service implementation to map from the old API to the new API and behavior. In some cases, this may be easy (e.g. mapping `x.y.z.v1.FooTo` to `x.y.z.FooTo` using xref:devonfw-guide_devon4j.wiki_guide-beanmapping.asciidoc[bean-mapping] with some custom mapping for the incompatible changes), in other cases this can get very complex. Be aware of this complexity from the start before you make your decision about service versioning.
* As far as possible this mapping should be done in the service-layer, not to pollute your business code in the core-layer with versioning-aspects. If there is no way to handle it in the service layer, e.g. you need some data from the persistence-layer, implement the "mapping" in the core-layer then, but don't forget to remove this code, when removing the old service version.
* Finally, ensure that both the old service behaves as before as well as the new service works as planned.

[[devonfw-guide_devon4j.wiki_guide-service-versioning.asciidoc_modularization]]
=== Modularization
For modularization, we also follow the KISS principle (see xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_key-principles[key principles]):
we suggest to have one `api` module per application that will contain the most recent version of your service and get released with every release-version of the application. The compatibility code with the versioned packages will be added to the `core` module and therefore is not exposed via the `api` module (because it has already been exposed in the previous release of the app). This way, you can always determine for sure which version of a service is used by another application just by its maven dependencies.

The KISS approach with only a single module that may contain multiple services (e.g. one for each business component) will cause problems when you want to have mixed usages of service versions: You can not use an old version of one service and a new version of another service from the same APP as then you would need to have its API module twice as a dependency on different versions, which is not possible. However, to avoid complicated overhead we always suggest to follow this easy approach. Only if you come to the point that you really need this complexity you can still solve it (even afterwards by publishing another maven artefact). As we are all on our way to build more but smaller applications (SOA, microservices, etc.) we should always start simple and only add complexity when really needed.

The following example gives an idea of the structure:

[source]
----
/«my-app»
├──/api
|  └──/src/main/java/
|     └──/«rootpackage»/«application»/«component»
|        ├──/common/api/to
|        |  └──FooTo
|        └──/service/api/rest
|           └──FooRestService
└──/core
   └──/src/main/java/
      └──«rootpackage»/«application»/«component»
         ├──/common/api/to/v1
         |  └──FooToV1
         └──/service
            ├──/api/rest/v1
            |  └──FooRestServiceV1
            └──impl/rest
               ├──/v1
               |  └── FooRestServiceImplV1
               └──FooRestServiceImpl
----

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc]]
= Logic Layer

The logic layer is the heart of the application and contains the main business logic.
According to our xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_business-architecture[business architecture], we divide an application into xref:devonfw-guide_devon4j.wiki_guide-component.asciidoc[components].
For each component, the logic layer defines different xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc[use-cases]. Another approach is to define a xref:devonfw-guide_devon4j.wiki_guide-component-facade.asciidoc[component-facade], which we do not recommend for future application. Especially for quarkus application, we want to simplify things and highly suggest omitting component-facade completely and using use-cases only.
It is very important that you follow the links to understand the concept of use-case in order to properly implement your business logic.

[[devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc_responsibility]]
== Responsibility
The logic layer is responsible to implement the business logic according to the specified functional demands and requirements.
Therefore, it creates the actual value of the application. The logic layer is responsible for invoking business logic in external systems.
The following additional aspects are also included in its responsibility:

* xref:devonfw-guide_devon4j.wiki_guide-validation.asciidoc[validation]
* xref:devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_authorization[authorization]
* xref:devonfw-guide_devon4j.wiki_guide-transactions.asciidoc[transaction-handling] (in addition to xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[service layer]).

[[devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc_security]]
== Security
The logic layer is the heart of the application. It is also responsible for authorization and hence security is important in this current case. Every method exposed in an interface needs to be annotated with an authorization check, stating what role(s) a caller must provide in order to be allowed to make the call. The authorization concept is described xref:devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_authorization[here].

[[devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc_direct-object-references]]
=== Direct Object References
A security threat are https://www.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References[Insecure Direct Object References]. This simply gives you two options:

* avoid direct object references
* ensure that direct object references are secure

Especially when using REST, direct object references via technical IDs are common sense. This implies that you have a proper xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc_authorization[authorization] in place. This is especially tricky when your authorization does not only rely on the type of the data and according to static permissions but also on the data itself. Vulnerabilities for this threat can easily happen by design flaws and inadvertence. Here is an example from our sample application:

We have a generic use-case to manage BLOBs. In the first place, it makes sense to write a generic REST service to load and save these BLOBs. However, the permission to read or even update such BLOB depends on the business object hosting the BLOB. Therefore, such a generic REST service would open the door for this OWASP A4 vulnerability. To solve this in a secure way, you need individual services for each hosting business object to manage the linked BLOB and have to check permissions based on the parent business object. In this example the ID of the BLOB would be the direct object reference and the ID of the business object (and a BLOB property indicator) would be the indirect object reference.

:leveloffset: 2

:leveloffset: +4

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-component-facade.asciidoc]]
= Component Facade
[NOTE]
Our recommended approach for implementing the logic layer is xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc[use-cases]

For each component of the application, the xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc[logic layer] defines a component facade.
This is an interface defining all business operations of the component.
It carries the name of the component (`«Component»`) and has an implementation named `«Component»Impl` (see xref:devonfw-guide_devon4j.wiki_guide-component-facade.asciidoc_implementation[implementation]).

[[devonfw-guide_devon4j.wiki_guide-component-facade.asciidoc_api]]
== API
The component facade interface defines the logic API of the component and has to be business oriented.
This means that all parameters and return types of all methods from this API have to be business xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc[transfer-objects], xref:devonfw-guide_devon4j.wiki_guide-datatype.asciidoc[datatypes] (`String`, `Integer`, `MyCustomerNumber`, etc.), or collections of these.
The API may also only access objects of other business components listed in the (transitive) dependencies of the xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_business-architecture[business-architecture].

Here is an example how such an API may look like:
[source,java]
----
public interface Bookingmanagement {

  BookingEto findBooking(Long id);

  BookingCto findBookingCto(Long id);

  Page&lt;BookingEto&gt; findBookingEtos(BookingSearchCriteriaTo criteria);

  void approveBooking(BookingEto booking);

}
----

[[devonfw-guide_devon4j.wiki_guide-component-facade.asciidoc_implementation]]
== Implementation
The implementation of an interface from the xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc[logic layer] (a component facade or a xref:devonfw-guide_devon4j.wiki_guide-usecase.asciidoc[use-case]) carries the name of that interface with the suffix `Impl` and is annotated with `@Named`.
An implementation typically needs access to the persistent data.
This is done by xref:devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc[injecting] the corresponding xref:devonfw-guide_devon4j.wiki_guide-repository.asciidoc[repository] (or xref:devonfw-guide_devon4j.wiki_guide-dao.asciidoc[DAO]).
According to xref:devonfw-guide_devon4j.wiki_architecture.asciidoc_architecture-principles[data-sovereignty], only repositories of the same business component may be accessed directly.
For accessing data from other components the implementation has to use the corresponding API of the logic layer (the component facade). Further, it shall not expose persistent entities from the xref:devonfw-guide_devon4j.wiki_guide-domain-layer.asciidoc[domain layer] and has to map them to xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc[transfer objects] using the xref:devonfw-guide_devon4j.wiki_guide-beanmapping.asciidoc[bean-mapper].

[source,java]
----

@Named
@Transactional
public class BookingmanagementImpl extends AbstractComponentFacade implements Bookingmanagement {

  @Inject
  private BookingRepository bookingRepository;

  @Override
  public BookingEto findBooking(Long id) {

    LOG.debug("Get Booking with id {} from database.", id);
    BookingEntity entity = this.bookingRepository.findOne(id);
    return getBeanMapper().map(entity, BookingEto.class));
  }
}
----

As you can see, xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entity[entities] (`BookingEntity`) are mapped to corresponding xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc_eto[ETOs] (`BookingEto`).
Further details about this can be found in xref:devonfw-guide_devon4j.wiki_guide-beanmapping.asciidoc[bean-mapping].

:leveloffset: 2

:leveloffset: +4

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-usecase.asciidoc]]
= UseCase
A use-case is a small unit of the xref:devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc[logic layer] responsible for an operation on a particular xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entity[entity] (business object).
We leave it up to you to decide whether you want to define an interface (API) for each use-case or provide an implementation directly.

Following our architecture-mapping (for xref:devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc_architecture-mapping[classic] and xref:devonfw-guide_devon4j.wiki_guide-structure-modern.asciidoc_architecture-mapping[modern] project), use-cases are named `Uc«Operation»«BusinessObject»[Impl]`. The prefix `Uc` stands for use-case and allows to easily find and identify them in your IDE. The `«Operation»` stands for a verb that is operated on the entity identified by `«BusinessObject»`.
For https://en.wikipedia.org/wiki/Create,_read,_update_and_delete[CRUD] we use the standard operations `Find` and `Manage` that can be generated by https://github.com/devonfw/cobigen[CobiGen]. This also separates read and write operations (e.g. if you want to do CQSR, or to configure read-only transactions for read operations).

In our example, we choose to define an interface for each use-case. We also use `*To` to refer to any type of transfer object. Please follow our xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc[guide] to understand more about different types of transfer object e.g. Eto, Dto, Cto

[[devonfw-guide_devon4j.wiki_guide-usecase.asciidoc_find]]
== Find
The `UcFind«BusinessObject»` defines all read operations to retrieve and search the `«BusinessObject»`.
Here is an example:
[source,java]
----
public interface UcFindBooking {
  //*To = Eto, Dto or Cto
  Booking*To findBooking(Long id);
}
----

[[devonfw-guide_devon4j.wiki_guide-usecase.asciidoc_manage]]
== Manage
The `UcManage«BusinessObject»` defines all CRUD write operations (create, update and delete) for the `«BusinessObject»`.
Here is an example:
[source,java]
----
public interface UcManageBooking {

  //*To = Eto, Dto or Cto
  Booking*To saveBooking(Booking*To booking);

  void deleteBooking(Long id);

}
----

[[devonfw-guide_devon4j.wiki_guide-usecase.asciidoc_custom]]
== Custom
Any other non CRUD operation `Uc«Operation»«BusinessObject»` uses any other custom verb for `«Operation»`.
Typically, such custom use-cases only define a single method.
Here is an example:
[source,java]
----
public interface UcApproveBooking {

  //*To = Eto, Dto or Cto
  void approveBooking(Booking*To booking);

}
----

[[devonfw-guide_devon4j.wiki_guide-usecase.asciidoc_implementation]]
== Implementation
The implementation should carry its own name and the suffix `Impl` and is annotated with `@Named` and `@ApplicationScoped`. It will need access to the persistent data which is done by injecting the corresponding repository (or DAO). Furthermore, it shall not expose persistent entities from the data access layer and has to map them to transfer objects using the bean-mapper. Please refer to our xref:devonfw-guide_devon4j.wiki_guide-beanmapping.asciidoc[bean mapping], xref:devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc[transfer object] and xref:devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc[dependency injection] documentation for more information.
Here is an example:
[source,java]
----
@ApplicationScoped
@Named
public class UcManageBookingImpl implements UcManageBooking {

  @Inject
  private BookingRepository bookingRepository;

  @Override
  public void deleteBooking(Long id) {

    LOG.debug("Delete Booking with id {} from database.", id);
    this.bookingRepository.deleteById(id);
  }
}
----

The use-cases can then be injected directly into the service.

[source,java]
----
@Named("BookingmanagementRestService")
@Validated
public class BookingmanagementRestServiceImpl implements BookingmanagementRestService {

  @Inject
  private UcFindBooking ucFindBooking;

  @Inject
  private UcManageBooking ucManageBooking;

  @Inject
  private UcApproveBooking ucApproveBooking;
}
----

[[devonfw-guide_devon4j.wiki_guide-usecase.asciidoc_internal-use-case]]
== Internal use case
Sometimes, a component with multiple related entities and many use-cases needs to reuse business logic internally.
Of course, this can be exposed as an official use-case API but this will imply using transfer-objects (ETOs) instead of entities. In some cases, this is undesired e.g. for better performance to prevent unnecessary mapping of entire collections of entities.
In the first place, you should try to use abstract base implementations providing reusable methods the actual use-case implementations can inherit from.
If your business logic is even more complex and you have multiple aspects of business logic to share and reuse but also run into multi-inheritance issues, you may also just create use-cases that have their interface located in the `impl` scope package right next to the implementation (or you may just skip the interface). In such a case, you may define methods that directly take or return entity objects.
To avoid confusion with regular use-cases, we recommend to add the `Internal` suffix to the type name leading to `Uc«Operation»«BusinessObject»Internal[Impl]`.

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-dataaccess-layer.asciidoc]]
= Data-Access Layer

The data-access layer is responsible for all outgoing connections to access and process data. This is mainly about accessing data from a persistent data-store. External system could also be accessed from the data-access layer if they match this definition, e.g. a mongo-db via rest services.

Note: In the xref:devonfw-guide_devon4j.wiki_guide-structure-modern.asciidoc[modern project structure], this layer is replaced by the xref:devonfw-guide_devon4j.wiki_guide-domain-layer.asciidoc[domain layer].

[[devonfw-guide_devon4j.wiki_guide-dataaccess-layer.asciidoc_database]]
== Database

You need to make your choice for a database. Options are documented https://github.com/devonfw/devonfw-guide/blob/master/general/db/guide-database.asciidoc[here].

The classical approach is to use a Relational Database Management System (RDMS). In such a case, we strongly recommend to follow our xref:devonfw-guide_devon4j.wiki_guide-jpa.asciidoc[JPA Guide]. Some NoSQL databases are supported by https://spring.io/projects/spring-data[spring-data] so you can consider the xref:devonfw-guide_devon4j.wiki_guide-repository.asciidoc[repository guide].

:leveloffset: 2

&lt;&lt;&lt;&lt;

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc]]
= Batch Layer

We understand batch processing as a bulk-oriented, non-interactive, typically long running execution of tasks. For simplicity, we use the term "batch" or "batch job" for such tasks in the following documentation.

devonfw uses xref:devonfw-guide/devon4j.wiki_http://projects.spring.io/spring-batch/[Spring Batch] as a batch framework.

This guide explains how Spring Batch is used in devonfw applications. It focuses on aspects which are special to devonfw. If you want to learn about spring-batch you should adhere to springs references documentation.

There is an example of a simple batch implementation in the https://github.com/devonfw/my-thai-star/tree/develop/java/mtsj/batch[my-thai-star batch module].


In this chapter, we will describe the overall architecture (especially concerning layering) and how to administer batches.

[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_layering]]
== Layering

Batches are implemented in the batch layer. The batch layer is responsible for batch processes, whereas the business logic is implemented in the logic layer. Compared to the xref:devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc[service layer], you may understand the batch layer just as a different way of accessing the business logic.
From a component point of view, each batch is implemented as a subcomponent in the corresponding business component.
The business component is defined by the xref:devonfw-guide_devon4j.wiki_architecture.asciidoc[business architecture].

Let's make an example for that. The sample application implements a batch for exporting ingredients. This ingredientExportJob belongs to the dishmanagement business component.
So the ingredientExportJob is implemented in the following package:
//Example doesn't exist anymore and I didn't find any other used batches.
[source]
&lt;basepackage&gt;.dishmanagement.batch.impl.*

Batches should invoke use cases in the logic layer for doing their work.
Only "batch specific" technical aspects should be implemented in the batch layer.

==========================
Example:
For a batch, which imports product data from a CSV file, this means that all code for actually reading and parsing the CSV input file is implemented in the batch layer.
The batch calls the use case "create product" in the logic layer for actually creating the products for each line read from the CSV input file.
==========================


[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_-directly-accessing-data-access-layer]]
===  Directly accessing data access layer
In practice, it is not always appropriate to create use cases for every bit of work a batch should do. Instead, the data access layer can be used directly.
An example for that is a typical batch for data retention which deletes out-of-time data.
Often deleting, out-dated data is done by invoking a single SQL statement. It is appropriate to implement that SQL in a xref:devonfw-guide_devon4j.wiki_guide-repository.asciidoc[Repository] or xref:devonfw-guide_devon4j.wiki_guide-dao.asciidoc[DAO] method and call this method directly from the batch.
But be careful: this pattern is a simplification which could lead to business logic cluttered in different layers, which reduces the maintainability of your application.
It is a typical design decision you have to make when designing your specific batches.

[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_project-structure-and-packaging]]
== Project structure and packaging

Batches will be implemented in a separate Maven module to keep the application core free of batch dependencies. The batch module includes a dependency on the application core-module to allow the reuse of the use cases, DAOs etc.
Additionally the batch module has dependencies on the required spring batch jars:

[source,xml]
----
  &lt;dependencies&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;${project.groupId}&lt;/groupId&gt;
      &lt;artifactId&gt;mtsj-core&lt;/artifactId&gt;
      &lt;version&gt;dev-SNAPSHOT&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-batch&lt;/artifactId&gt;
    &lt;/dependency&gt;

  &lt;/dependencies&gt;
----

To allow an easy xref:devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_start-batch[start of the batches] from the command line it is advised to create a bootified jar for the batch module by adding the following to the `pom.xml` of the batch module:

[source,xml]
----
  &lt;build&gt;
    &lt;resources&gt;
      &lt;resource&gt;
        &lt;directory&gt;src/main/resources&lt;/directory&gt;
        &lt;filtering&gt;true&lt;/filtering&gt;
      &lt;/resource&gt;
    &lt;/resources&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
          &lt;excludes&gt;
            &lt;exclude&gt;config/application.properties&lt;/exclude&gt;
          &lt;/excludes&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      &lt;!-- Create bootified jar for batch execution via command line.
           Your applications spring boot app is used as main-class.
       --&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
          &lt;mainClass&gt;com.devonfw.application.mtsj.SpringBootApp&lt;/mainClass&gt;
          &lt;classifier&gt;bootified&lt;/classifier&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;repackage&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
----

[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_implementation]]
== Implementation

Most of the details about implementation of batches is described in the https://spring.io/projects/spring-batch[spring batch documentation].
There is nothing special about implementing batches in devonfw. You will find an easy https://github.com/devonfw/my-thai-star/tree/develop/java/mtsj/batch[example in my-thai-star].

[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_start-batch]]
[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_starting-from-command-line]]
== Starting from command line

Devonfw advises to start batches via command line. This is most common to many ops teams and allows easy integration in existing xref:devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_scheduling[schedulers]. In general batches are started with the following command:

----
java -jar &lt;app&gt;-batch-&lt;version&gt;-bootified.jar --spring.main.web-application-type=none --spring.batch.job.enabled=true --spring.batch.job.names=&lt;myJob&gt; &lt;params&gt;
----

[%header]
|===
|Parameter |Explanation
|`--spring.main.web-application-type=none`| This disables the web app (e.g. Tomcat)
|`--spring.batch.job.names=&lt;myJob&gt;`| This specifies the name of the job to run. If you leave this out ALL jobs will be executed. Which probably does not make to much sense.
|`&lt;params&gt;`| (Optional) additional parameters which are passed to your job
|===

This will launch your normal spring boot app, disables the web application part and runs the designated job via Spring Boots `org.springframework.boot.autoconfigure.batch.JobLauncherCommandLineRunner`.

[scheduling]
[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_scheduling]]
== Scheduling

In real world scheduling of batches is not as simple as it first might look like.

* Multiple batches have to be executed in order to achieve complex tasks. If one of those batches fails the further execution has to be stopped and operations should be notified for example.
* Input files or those created by batches have to be copied from one node to another.
* Scheduling batch executing could get complex easily (quarterly jobs, run job on first workday of a month, ...)

For devonfw we propose the batches themselves should not mess around with details of scheduling.
Likewise your application should not do so. This complexity should be externalized to a dedicated batch administration service or scheduler.
This service could be a complex product or a simple tool like cron. We propose xref:devonfw-guide/devon4j.wiki_http://rundeck.org[Rundeck] as an open source job scheduler.

This gives full control to operations to choose the solution which fits best into existing administration procedures.

[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_handling-restarts]]
== Handling restarts

If you start a job with the same parameters set after a failed run (BatchStatus.FAILED) a restart will occur.
In many cases your batch should then not reprocess all items it processed in the previous runs.
For that you need some logic to start at the desired offset. There different ways to implement such logic:

* Marking processed items in the database in a dedicated column
* Write all IDs of items to process in a separate table as an initialization step of your batch. You can then delete IDs of already processed items from that table during the batch execution.
* Storing restart information in springs ExecutionContext (see below)

[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_using-spring-batch-executioncontext-for-restarts]]
=== Using spring batch ExecutionContext for restarts

By implementing the `ItemStream` interface in your `ItemReader` or `ItemWriter` you may store information about the batch progress in the `ExecutionContext`. You will find an example for that in the CountJob in My Thai Star.

Additional hint: It is important that bean definition method of your `ItemReader`/`ItemWriter` return types implementing `ItemStream`(and not just `ItemReader` or `ItemWriter` alone). For that the `ItemStreamReader` and `ItemStreamWriter` interfaces are provided.

[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_exit-codes]]
== Exit codes

Your batches should create a meaningful exit code to allow reaction to batch errors e.g. in a xref:devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_scheduling[scheduler].
For that spring batch automatically registers an `org.springframework.boot.autoconfigure.batch.JobExecutionExitCodeGenerator`. To make this mechanism work your spring boot app main class as to populate this exit code to the JVM:

[source,java]
----
@SpringBootApplication
public class SpringBootApp {

  public static void main(String[] args) {
    if (Arrays.stream(args).anyMatch((String e) -&gt; e.contains("--spring.batch.job.names"))) {
      // if executing batch job, explicitly exit jvm to report error code from batch
      System.exit(SpringApplication.exit(SpringApplication.run(SpringBootApp.class, args)));
    } else {
      // normal web application start
      SpringApplication.run(SpringBootApp.class, args);
    }
  }
}

----

[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_stop-batches-and-manage-batch-status]]
== Stop batches and manage batch status

Spring batch uses several database tables to store the status of batch executions.
Each execution may have xref:devonfw-guide/devon4j.wiki_https://docs.spring.io/spring-batch/docs/current/reference/html/index-single.html#jobexecution[different status].
You may use this mechanism to xref:devonfw-guide/devon4j.wiki_https://docs.spring.io/spring-batch/docs/current/reference/html/index-single.html#stoppingAJob[gracefully stop batches].
Additionally in some edge cases (batch process crashed) the execution status may be in an undesired state.
E.g. the state will be running, despite the process crashed sometime ago.
For that cases you have to change the status of the execution in the database.

[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_cli-tool]]
=== CLI-Tool
Devonfw provides a easy to use cli-tool to manage the executing status of your jobs.
The tool is implemented in the devonfw module `devon4j-batch-tool`. It will provide a runnable jar, which may be used as follows:

List names of all previous executed jobs::
`java -D\'spring.datasource.url=jdbc:h2:~/mts;AUTO_SERVER=TRUE' -jar devon4j-batch-tool.jar jobs list`

Stop job named 'countJob'::
`java -D\'spring.datasource.url=jdbc:h2:~/mts;AUTO_SERVER=TRUE' -jar devon4j-batch-tool.jar jobs stop countJob`

Show help::
`java -D\'spring.datasource.url=jdbc:h2:~/mts;AUTO_SERVER=TRUE' -jar devon4j-batch-tool.jar`

As you can the each invocation includes the JDBC connection string to your database.
This means that you have to make sure that the corresponding DB driver is in the classpath (the prepared jar only contains H2).

[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_authentication]]
== Authentication

Most business application incorporate authentication and authorization.
Your spring boot application will implement some kind of security, e.g. integrated login with username+password or in many cases authentication via an existing IAM.
For security reasons your batch should also implement an authentication mechanism and obey the authorization implemented in your application (e.g. via @RolesAllowed).

Since there are many different authentication mechanism we cannot provide an out-of-the-box solution in devonfw, but we describe a pattern how this can be implemented in devonfw batches.

We suggest to implement the authentication in a Spring Batch tasklet, which runs as the first step in your batch. This tasklet will do all of the work which is required to authenticate the batch. A simple example which authenticates the batch "locally" via username and password could be implemented like this:

[source,java]
----
@Named
public class SimpleAuthenticationTasklet implements Tasklet {

  @Override
  public RepeatStatus execute(StepContribution contribution, ChunkContext chunkContext) throws Exception {

    String username = chunkContext.getStepContext().getStepExecution().getJobParameters().getString("username");
    String password = chunkContext.getStepContext().getStepExecution().getJobParameters().getString("password");
    Authentication authentication = new UsernamePasswordAuthenticationToken(username, password);

    SecurityContextHolder.getContext().setAuthentication(authentication);
    return RepeatStatus.FINISHED;
  }

}
----

The username and password have to be supplied via two cli parameters `-username` and `-password`. This implementation creates an "authenticated" `Authentication` and sets in the Spring Security context. This is just for demonstration normally you should not provide passwords via command line. The actual authentication will be done automatically via Spring Security as in your "normal" application.
If you have a more complex authentication mechanism in your application e.g. via OpenID connect just call this in the tasklet. Naturally you may read authentication parameters (e.g. secrets) from the command line or more securely from a configuration file.

In your Job Configuration set this tasklet as the first step:

[source,java]
----
@Configuration
@EnableBatchProcessing
public class BookingsExportBatchConfig {
  @Inject
  private JobBuilderFactory jobBuilderFactory;

  @Inject
  private StepBuilderFactory stepBuilderFactory;

  @Bean
  public Job myBatchJob() {
    return this.jobBuilderFactory.get("myJob").start(myAuthenticationStep()).next(...).build();
  }

  @Bean
  public Step myAuthenticationStep() {
    return this.stepBuilderFactory.get("myAuthenticationStep").tasklet(myAuthenticatonTasklet()).build();
  }

  @Bean
  public Tasklet myAuthenticatonTasklet() {
    return new SimpleAuthenticationTasklet();
  }
...
----

[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_tipps--tricks]]
== Tipps &amp; tricks

[[devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc_identifying-job-parameters]]
=== Identifying job parameters

Spring uses a jobs parameters to identify https://docs.spring.io/spring-batch/docs/current/reference/html/domain.html#jobexecution[job executions]. Parameters starting with "-" are not considered for identifying a job execution.

:leveloffset: 2

&lt;&lt;&lt;&lt;

[[asciidoc_devonfw-guide_devon4j.wiki_devon4j.asciidoc_guides]]
=== Guides

:leveloffset: +3

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc]]
= Configuration

[[devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_internal-application-configuration]]
== Internal Application Configuration
There usually is a main configuration registered with main Spring Boot App, but differing configurations to support automated test of the application can be defined using profiles (not detailed in this guide).

[[devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_spring-boot-application]]
=== Spring Boot Application
For a complete documentation, see the http://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle/[Spring Boot Reference Guide].

With spring-boot you provide a simple _main class_ (also called starter class) like this:
com.devonfw.mtsj.application
[source, java]
----
@SpringBootApplication(exclude = { EndpointAutoConfiguration.class })
@EntityScan(basePackages = { "com.devonfw.mtsj.application" }, basePackageClasses = { AdvancedRevisionEntity.class })
@EnableGlobalMethodSecurity(jsr250Enabled = true)
@ComponentScan(basePackages = { "com.devonfw.mtsj.application.general", "com.devonfw.mtsj.application" })
public class SpringBootApp {

  /**
   * Entry point for spring-boot based app
   *
   * @param args - arguments
   */
  public static void main(String[] args) {

    SpringApplication.run(SpringBootApp.class, args);
  }
}
----

In an devonfw application this main class is always located in the `&lt;basepackage&gt;` of the application package namespace (see xref:devonfw-guide_devon4j.wiki_spring_coding-conventions.asciidoc_packages[package-conventions]). This is because a spring boot application will automatically do a classpath scan for components (spring-beans) and entities in the package where the application main class is located including all sub-packages. You can use the `@ComponentScan` and `@EntityScan` annotations to customize this behaviour.

If you want to map spring configuration properties into your custom code please see xref:devonfw-guide_devon4j.wiki_spring_guide-configuration-mapping.asciidoc[configuration mapping].

[[devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_standard-beans-configuration]]
=== Standard beans configuration

For basic bean configuration we rely on spring boot using mainly configuration classes and only occasionally XML configuration files. Some key principle to understand Spring Boot auto-configuration features:

* Spring Boot auto-configuration attempts to automatically configure your Spring application based on the jar dependencies and annotated components found in your source code.
* Auto-configuration is non-invasive, at any point you can start to define your own configuration to replace specific parts of the auto-configuration by redefining your identically named bean (see also `exclude` attribute of `@SpringBootApplication` in example code above).

Beans are configured via annotations in your java code (see xref:devonfw-guide_devon4j.wiki_spring_guide-dependency-injection.asciidoc[dependency-injection]).

For technical configuration you will typically write additional spring config classes annotated with `@Configuration` that provide bean implementations via methods annotated with `@Bean`. See http://docs.spring.io/spring-javaconfig/docs/1.0.0.M4/reference/html/ch02s02.html[spring @Bean documentation] for further details. Like in XML you can also use `@Import` to make a `@Configuration` class include other configurations.

More specific configuration files (as required) reside in an adequately named subfolder of:

`src/main/resources/app`

[[devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_beanmapper-configuration]]
=== BeanMapper Configuration
In case you are still using dozer, you will find further details in xref:devonfw-guide_devon4j.wiki_spring_guide-beanmapping-spring.asciidoc_bean-mapper-configuration[bean-mapper configuration].

[[devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_security-configuration]]
=== Security configuration
The abstract base class `BaseWebSecurityConfig` should be extended to configure web application security thoroughly.
A basic and secure configuration is provided which can be overridden or extended by subclasses.
Subclasses must use the `@Profile` annotation to further discriminate between beans used in production and testing scenarios. See the following example:

.How to extend `BaseWebSecurityConfig` for Production and Test
[source,java]
----
@Configuration
@EnableWebSecurity
@Profile(SpringProfileConstants.JUNIT)
public class TestWebSecurityConfig extends BaseWebSecurityConfig {...}

@Configuration
@EnableWebSecurity
@Profile(SpringProfileConstants.NOT_JUNIT)
public class WebSecurityConfig extends BaseWebSecurityConfig {...}
----

See https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/java/com/devonfw/application/mtsj/general/service/impl/config/WebSecurityConfig.java[WebSecurityConfig].


[[devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_websocket-configuration]]
=== WebSocket configuration
A websocket endpoint is configured within the business package as a Spring configuration class. The annotation `@EnableWebSocketMessageBroker` makes Spring Boot registering this endpoint.
//Changed path due to non existent configuration in the example project
[source, java]
----
package your.path.to.the.websocket.config;
...
@Configuration
@EnableWebSocketMessageBroker
public class WebSocketConfig extends AbstractWebSocketMessageBrokerConfigurer {
...
----

[[devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_external-application-configuration]]
== External Application Configuration
[[devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_application.properties-files]]
=== application.properties files
https://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html[Here] is a list of common properties provided by the Spring framework.

For a general understanding how spring-boot is loading and boostrapping your `application.properties` see https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html[spring-boot external configuration].

The following properties files are used in devonfw application:

* `src/main/resources/application.properties` providing a default configuration - bundled and deployed with the application package. It further acts as a template to derive a tailored minimal environment-specific configuration.
* `src/main/resources/config/application.properties` providing additional properties only used at development time (for all local deployment scenarios). This property file is excluded from all packaging.
* `src/test/resources/config/application.properties` providing additional properties only used for testing (JUnits based on xref:devonfw-guide_devon4j.wiki_spring_guide-testing.asciidoc[spring test]).

For other environments where the software gets deployed such as `test`, `acceptance` and `production` you need to provide a tailored copy of `application.properties`. The location depends on the deployment strategy:

* standalone run-able Spring Boot App using embedded tomcat: `config/application.properties` under the installation directory of the spring boot application.
* dedicated tomcat (one tomcat per app): `$CATALINA_BASE/lib/config/application.properties`
* tomcat serving a number of apps (requires expanding the wars): `$CATALINA_BASE/webapps/&lt;app&gt;/WEB-INF/classes/config`

In this `application.properties` you only define the minimum properties that are environment specific and inherit everything else from the bundled `src/main/resources/application.properties`. In any case, make very sure that the classloader will find the file.

[[devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_database-configuration]]
=== Database Configuration

The configuration for spring and Hibernate is already provided by devonfw in our sample application and the application template. So you only need to worry about a few things to customize.

[[devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_database-system-and-access]]
==== Database System and Access
Obviously you need to configure which type of database you want to use as well as the location and credentials to access it. The defaults are configured in `application.properties` that is bundled and deployed with the release of the software. The files should therefore contain the properties as in the given example:

[source, properties]
----
  database.url=jdbc:postgresql://database.enterprise.com/app
  database.user.login=appuser01
  database.user.password=************
  database.hibernate.dialect = org.hibernate.dialect.PostgreSQLDialect
  database.hibernate.hbm2ddl.auto=validate
----

For further details about `database.hibernate.hbm2ddl.auto` please see http://docs.jboss.org/hibernate/orm/5.0/manual/en-US/html/ch03.html#configuration-misc-properties[here]. For production and acceptance environments we use the value `validate` that should be set as default. In case you want to use Oracle RDBMS you can find additional hints xref:devonfw-guide_devon4j.wiki_spring_guide-oracle.asciidoc_driver[here].

If your application supports multiples database types, set `spring.profiles.active=XXX` in `src/main/resources/config/application.properties` choose database of your choice. Also, one has to set all the active spring profiles in this `application.properties` and not in any of the other `application.properties`.

[[devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_database-logging]]
==== Database Logging
Add the following properties to `application.properties` to enable logging of database queries for debugging purposes.

[source, properties]
----
spring.jpa.properties.hibernate.show_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true
spring.jpa.properties.hibernate.format_sql=true
----

[[devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_security]]
== Security

[[devonfw-guide_devon4j.wiki_spring_guide-spring-configuration.asciidoc_password-encryption]]
=== Password Encryption
In order to support encrypted passwords in spring-boot `application.properties` all you need to do is to add https://github.com/ulisesbocchio/jasypt-spring-boot#jasypt-spring-boot[jasypt-spring-boot] as dependency in your `pom.xml` (please check for recent version xref:devonfw-guide/devon4j.wiki/spring_https://mvnrepository.com/artifact/com.github.ulisesbocchio/jasypt-spring-boot-starter[here]):
[source, xml]
----
&lt;dependency&gt;
  &lt;groupId&gt;com.github.ulisesbocchio&lt;/groupId&gt;
  &lt;artifactId&gt;jasypt-spring-boot-starter&lt;/artifactId&gt;
  &lt;version&gt;3.0.3&lt;/version&gt;
&lt;/dependency&gt;
----
This will smoothly integrate http://jasypt.org/[jasypt] into your https://projects.spring.io/spring-boot/[spring-boot] application. Read this https://apereo.atlassian.net/wiki/spaces/CASUM/pages/103261428/HOWTO+Use+Jasypt+to+encrypt+passwords+in+configuration+files[HOWTO] to learn how to encrypt and decrypt passwords using jasypt.

Next, we give a simple example how to encypt and configure a secret value.
We use the algorithm `PBEWITHHMACSHA512ANDAES_256` that provides strong encryption and is the default of `jasypt-spring-boot-starter`.
However, different algorithms can be used if perferred (e.g. `PBEWITHMD5ANDTRIPLEDES`).
----
java -cp ${M2_REPO}/org/jasypt/jasypt/1.9.3/jasypt-1.9.3.jar org.jasypt.intf.cli.JasyptPBEStringEncryptionCLI password=masterpassword algorithm=PBEWITHHMACSHA512ANDAES_256 input=secret ivGeneratorClassName=org.jasypt.iv.RandomIvGenerator

----ENVIRONMENT-----------------

Runtime: AdoptOpenJDK OpenJDK 64-Bit Server VM 11.0.5+10



----ARGUMENTS-------------------

input: secret
password: masterpassword
ivGeneratorClassName: org.jasypt.iv.RandomIvGenerator
algorithm: PBEWITHHMACSHA512ANDAES_256



----OUTPUT----------------------

PoUxkNjY2juQMCyPu6ic5KJy1XfK+bX9vu2/mPj3pmcO4iydG6mhgZRZSw50z/oC

----
Of course the master-password (`masterpassword`) and the actual password to encrypt (`secret`) are just examples.
Please replace them with reasonable strong passwords for your environment.
Further, if you are using https://github.com/devonfw/ide[devonfw-ide] you can make your life much easier and just type:</code></pre>
</div>
</div>
<div class="paragraph">
<p>devon jasypt encrypt</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>See xref:devonfw-guide/devon4j.wiki/spring_https://github.com/devonfw/ide/blob/master/documentation/jasypt[jasypt commandlet] for details.

Now the entire line after the `OUTPUT` block is your encrypted secret.
It even contains some random salt so that multiple encryption invocations with the same parameters (`ARGUMENTS`) will produce a different `OUTPUT`.

The master-password can be configured on your target environment via the property `jasypt.encryptor.password`. As system properties given on the command-line are visible in the process list, we recommend to use an `config/application.yml` file only for this purpose (as we recommended to use `application.properties` for regular configs):</code></pre>
</div>
</div>
<div class="paragraph">
<p>jasypt:
    encryptor:
        password: masterpassword</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Again `masterpassword` is just an example that your replace with your actual master password.
Now you are able to put encrypted passwords into your `application.properties` and specify the algorithm.</code></pre>
</div>
</div>
<div class="paragraph">
<p>spring.datasource.password=ENC(PoUxkNjY2juQMCyPu6ic5KJy1XfK+bX9vu2/mPj3pmcO4iydG6mhgZRZSw50z/oC)
jasypt.encryptor.algorithm=PBEWITHHMACSHA512ANDAES_256</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>This `application.properties` file can be version controlled (git-opts) and without knowing the masterpassword nobody is able to decrypt this to get the actual secret back.

To prevent jasypt to throw an exception in dev or test scenarios you can simply put this in your local config (`src/main/config/application.properties` and same for `test`, see above for details):</code></pre>
</div>
</div>
<div class="paragraph">
<p>jasypt.encryptor.password=none</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>:leveloffset: 2

:leveloffset: +4

:toc: macro
toc::[]

[[devonfw-guide_devon4j.wiki_guide-configuration-mapping.asciidoc]]
= Mapping configuration to your code

If you are using `spring-boot` as suggested by `devon4j` your application can be configured by `application.properties` file as described in xref:devonfw-guide_devon4j.wiki_guide-configuration.asciidoc[configuration].
To get a single configuration option into your code for flexibility, you can use

```java
@Value("${my.property.name}")
private String myConfigurableField;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, in your <code>application.properties</code> you can add the property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>my.property.name=my-property-value</code></pre>
</div>
</div>
<div class="paragraph">
<p>You may even use <code>@Value("${my.property.name:my-default-value}")</code> to make the property optional.</p>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4j.wiki_guide-configuration-mapping.asciidoc_naming-conventions-for-configuration-properties">Naming conventions for configuration properties</h4>
<div class="paragraph">
<p>As a best practice your configruation properties should follow these naming conventions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>build the property-name as a path of segments separated by the dot character (<code>.</code>)</p>
</li>
<li>
<p>segments should get more specific from left to right</p>
</li>
<li>
<p>a property-name should either be a leaf value or a tree node (prefix of other property-names) but never both! So never have something like <code>foo.bar=value</code> and <code>foo.bar.child=value2</code>.</p>
</li>
<li>
<p>start with a segment namespace unique to your context or application</p>
</li>
<li>
<p>a good example would be <code>«myapp».billing.service.email.sender</code> for the sender address of billing service emails send by <code>«myapp»</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4j.wiki_guide-configuration-mapping.asciidoc_mapping-advanced-configuration">Mapping advanced configuration</h4>
<div class="paragraph">
<p>However, in many scenarios you will have features that require more than just one property.
Injecting those via <code>@Value</code> is not leading to good code quality.
Instead we create a class with the suffix <code>ConfigProperties</code> containing all configuration properties for our aspect that is annotated with <code>@ConfigurationProperties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ConfigurationProperties(prefix = "myapp.billing.service")
public class BillingServiceConfigProperties {

  private final Email email = new Email();
  private final Smtp smtp = new Smtp();

  public Email getEmail() { return this.email; }
  public Email getSmtp() { return this.smtp; }

  public static class Email {

    private String sender;
    private String subject;

    public String getSender() { return this.sender; }
    public void setSender(String sender) { this.sender = sender; }
    public String getSubject() { return this.subject; }
    public void setSubject(String subject) { this.subject = subject; }
  }

  public static class Smtp {

    private String host;
    private int port = 25;

    public String getHost() { return this.host; }
    public void setHost(String host) { this.host = host; }
    public int getPort() { return this.port; }
    public void setPort(int port) { this.port = port; }
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course this is just an example to demonstrate this feature of <code>spring-boot</code>.
In order to send emails you would typically use the existing <a href="https://www.baeldung.com/spring-email">spring-email</a> feature.
But as you can see this allows us to define and access our configuration in a very structured and comfortable way.
The annotation <code>@ConfigurationProperties(prefix = "myapp.billing.service")</code> will automatically map spring configuration properties starting with <code>myapp.billing.service</code> via the according getters and setters into our <code>BillingServiceConfigProperties</code>.
We can easily define defaults (e.g. <code>25</code> as default value for <code>myapp.billing.service.smtp.port</code>).
Also <code>Email</code> or <code>Smtp</code> could be top-level classes to be reused in multiple configurations.
Of course you would also add helpful <code>JavaDoc</code> comments to the <code>getters</code> and classes to document your configuration options.
Further to access this configuration, we can use standard <a href="#devonfw-guide_devon4j.wiki_guide-dependency-injection.asciidoc">dependency-injection</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Inject
private BillingServiceConfigProperties config;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For very generic cases you may also use <code>Map&lt;String, String&gt;</code> to map any kind of property in an untyped way.
An example for generic configuration from <code>devon4j</code> can be found in
<a href="https://github.com/devonfw/devon4j/blob/9b8f9461997bb5d8048a9fec42bec3625652eec3/modules/service/src/main/java/com/devonfw/module/service/common/base/config/ServiceConfigProperties.java">ServiceConfigProperties</a>.</p>
</div>
<div class="paragraph">
<p>For further details about this feature also consult <a href="https://www.baeldung.com/configuration-properties-in-spring-boot">Guide to @ConfigurationProperties in Spring Boot</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4j.wiki_guide-configuration-mapping.asciidoc_generate-configuration-metadata">Generate configuration metadata</h4>
<div class="paragraph">
<p>You should further add this <code>dependency</code> to your module containing the <code>*ConfigProperties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;
      &lt;optional&gt;true&lt;/optional&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will generate configuration metadata so projects using your code can benefit from autocompletion and getting your JavaDoc as tooltip when editing <code>application.properites</code> what makes this approach very powerful.
For further details about this please read <a href="https://www.baeldung.com/spring-boot-configuration-metadata">A Guide to Spring Boot Configuration Metadata</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-auditing.asciidoc">Auditing</h6>
<div class="paragraph">
<p>For database auditing we use <a href="http://envers.jboss.org/">hibernate envers</a>. If you want to use auditing ensure you have the following dependency in your pom.xml:</p>
</div>
<div class="listingblock">
<div class="title">Listing 6. <strong>spring</strong></div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.devonfw.java.modules&lt;/groupId&gt;
  &lt;artifactId&gt;devon4j-jpa-envers&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 7. <strong>quarkus</strong></div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-hibernate-envers&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The following part applies only to spring applications. At this point, the Quarkus extension does not provide any additional configurations. For Quarkus applications, simply use the <code>@Audited</code> annotation to enable auditing for an entity class, as described a few lines below or seen <a href="https://hibernate.org/orm/envers/">here</a>.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Make sure that entity manager also scans the package from the devon4j-jpa[-envers] module in order to work properly. And make sure that correct Repository Factory Bean Class is chosen.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@EntityScan(basePackages = { "«my.base.package»" }, basePackageClasses = { AdvancedRevisionEntity.class })
...
@EnableJpaRepositories(repositoryFactoryBeanClass = GenericRevisionedRepositoryFactoryBean.class)
...
public class SpringBootApp {
  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now let your [Entity]Repository extend from DefaultRevisionedRepository instead of DefaultRepository.</p>
</div>
<div class="paragraph">
<p>The repository now has a method getRevisionHistoryMetadata(id) and getRevisionHistoryMetadata(id, boolean lazy) available to get a list of revisions for a given entity and a method find(id, revision) to load a specific revision of an entity with the given ID or getLastRevisionHistoryMetadata(id) to load last revision.
To enable auditing for a entity simply place the @Audited annotation to your entity and all entity classes it extends from.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Entity(name = "Drink")
@Audited
public class DrinkEntity extends ProductEntity implements Drink {
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>When auditing is enabled for an entity an additional database table is used to store all changes to the entity table and a corresponding revision number. This table is called &lt;ENTITY_NAME&gt;_AUD per default. Another table called REVINFO is used to store all revisions. Make sure that these tables are available. They can be generated by hibernate with the following property (only for development environments).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">  database.hibernate.hbm2ddl.auto=create</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another possibility is to put them in your <a href="#devonfw-guide_devon4j.wiki_guide-database-migration.asciidoc">database migration</a> scripts like so.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">CREATE CACHED TABLE PUBLIC.REVINFO(
  id BIGINT NOT NULL generated by default as identity (start with 1),
  timestamp BIGINT NOT NULL,
  user VARCHAR(255)
);
...
CREATE CACHED TABLE PUBLIC.&lt;TABLE_NAME&gt;_AUD(
    &lt;ALL_TABLE_ATTRIBUTES&gt;,
    revtype TINYINT,
    rev BIGINT NOT NULL
);</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc">Access-Control</h6>
<div class="paragraph">
<p>Access-Control is a central and important aspect of <a href="#devonfw-guide_devon4j.wiki_guide-security.asciidoc">Security</a>. It consists of two major aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_Authentication">devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_Authentication</a> (Who tries to access?)</p>
</li>
<li>
<p><a href="#devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_Authorization">devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_Authorization</a> (Is the one accessing allowed to do what he wants to do?)</p>
</li>
</ul>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_authentication">Authentication</h7>
<div class="paragraph">
<p>Definition:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Authentication is the verification that somebody interacting with the system is the actual subject for whom he claims to be.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The one authenticated is properly called <em>subject</em> or <a href="http://docs.oracle.com/javase/7/docs/api/java/security/Principal.html"><em>principal</em></a>. There are two forms of principals you need to distinguish while designing your authentication: <code>human users</code> and <code>autonomous systems</code>. While e.g. a Kerberos/SPNEGO Single-Sign-On makes sense for human users, it is pointless for authenticating autonomous systems.  For simplicity, we use the common term <em>user</em> to refer to any principal even though it may not be a human (e.g. in case of a service call from an external system).</p>
</div>
<div class="paragraph">
<p>To prove the authenticity, the user provides some secret called <em>credentials</em>. The most simple form of credentials is a password.</p>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_implementations">Implementations</h8>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please never implement your own authentication mechanism or credential store. You have to be aware of implicit demands such as salting and hashing credentials, password life-cycle with recovery, expiry, and renewal including email notification confirmation tokens, central password policies, etc. This is the domain of access managers and identity management systems. In a business context you will typically already find a system for this purpose that you have to integrate (e.g. via LDAP). Otherwise you should consider establishing such a system e.g. using <a href="http://keycloak.org">keycloak</a>.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>We recommend using <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-jwt.asciidoc">JWT</a> when possible. For KISS, also try to avoid combining multiple authentication mechanisms (form based, basic-auth, SAMLv2, OAuth, etc.) within the same application (for different URLs).</p>
</div>
<div class="paragraph">
<p>For <a href="#devonfw-guide_devon4j.wiki_spring.asciidoc">spring</a>, check the <a href="#devonfw-guide_devon4j.wiki_spring_guide-authentication-spring.asciidoc">Spring Security</a></p>
</div>
<div class="paragraph">
<p>For <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus.asciidoc">quarkus</a>, check the <a href="#devonfw-guide_devon4j.wiki_quarkus_guide-authentication-quarkus.asciidoc">Quarkus Authentication</a></p>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_authorization">Authorization</h7>
<div class="paragraph">
<p><strong>Definition:</strong></p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Authorization is the verification that an authenticated user is allowed to perform the operation he intends to invoke.</p>
</div>
</blockquote>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_clarification-of-terms">Clarification of terms</h8>
<div class="paragraph">
<p>For clarification we also want to give a common understanding of related terms that have no unique definition and consistent usage in the wild.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 28. Security terms related to authorization</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 85%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Term</strong></th>
<th class="tableblock halign-left valign-top"><strong>Meaning and comment</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permission</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A permission is an object that allows a principal to perform an operation in the system. This permission can be <em>granted</em> (give) or <em>revoked</em> (taken away). Sometimes people also use the term <em>right</em> what is actually wrong as a right (such as the right to be free) can not be revoked.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">We use the term group in this context for an object that contains permissions. A group may also contain other groups. Then the group represents the set of all recursively contained permissions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Role</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">We consider a role as a specific form of group that also contains permissions. A role identifies a specific function of a principal. A user can act in a role.</p>
<p class="tableblock">For simple scenarios a principal has a single role associated. In more complex situations a principal can have multiple roles but has only one active role at a time that he can choose out of his assigned roles. For KISS it is sometimes sufficient to avoid this by creating multiple accounts for the few users with multiple roles. Otherwise at least avoid switching roles at run-time in clients as this may cause problems with related states. Simply restart the client with the new role as parameter in case the user wants to switch his role.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access Control</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any permission, group, role, etc., which declares a control for access management.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_suggestions-on-the-access-model">Suggestions on the access model</h8>
<div class="paragraph">
<p>For the access model we give the following suggestions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each Access Control (permission, group, role, …​) is uniquely identified by a human readable string.</p>
</li>
<li>
<p>We create a unique permission for each use-case.</p>
</li>
<li>
<p>We define groups that combine permissions to typical and useful sets for the users.</p>
</li>
<li>
<p>We define roles as specific groups as required by our business demands.</p>
</li>
<li>
<p>We allow to associate users with a list of Access Controls.</p>
</li>
<li>
<p>For authorization of an implemented use case we determine the required permission. Furthermore, we determine the current user and verify that the required permission is contained in the tree spanned by all his associated Access Controls. If the user does not have the permission we throw a security exception and thus abort the operation and transaction.</p>
</li>
<li>
<p>We avoid negative permissions, that is a user has no permission by default and only those granted to him explicitly give him additional permission for specific things. Permissions granted can not be reduced by other permissions.</p>
</li>
<li>
<p>Technically we consider permissions as a secret of the application. Administrators shall not fiddle with individual permissions but grant them via groups. So the access management provides a list of strings identifying the Access Controls of a user. The individual application itself contains these Access Controls in a structured way, whereas each group forms a permission tree.</p>
</li>
</ul>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_naming-conventions">Naming conventions</h8>
<div class="paragraph">
<p>As stated above each Access Control is uniquely identified by a human readable string. This string should follow the naming convention:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>«app-id».«local-name»</code></pre>
</div>
</div>
<div class="paragraph">
<p>For Access Control Permissions the <code>«local-name»</code> again follows the convention:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>«verb»«object»</code></pre>
</div>
</div>
<div class="paragraph">
<p>The segments are defined by the following table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 29. Segments of Access Control Permission ID</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Segment</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Example</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«app-id»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is a unique technical but human readable string of the application (or microservice). It shall not contain special characters and especially no dot or whitespace. We recommend to use <code>lower-train-case-ascii-syntax</code>. The identity and access management should be organized on enterprise level rather than application level. Therefore permissions of different apps might easily clash (e.g. two apps might both define a group <code>ReadMasterData</code> but some user shall get this group for only one of these two apps). Using the <code>«app-id».</code> prefix is a simple but powerful namespacing concept that allows you to scale and grow. You may also reserve specific «app-id»s for cross-cutting concerns that do not actually reflect a single app e.g to grant access to a geographic region.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>shop</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«verb»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The action that is to be performed on «object». We use <code>Find</code> for searching and reading data. <code>Save</code> shall be used both for create and update. Only if you really have demands to separate these two you may use <code>Create</code> in addition to <code>Save</code>. Finally, <code>Delete</code> is used for deletions. For non CRUD actions you are free to use additional verbs such as <code>Approve</code> or <code>Reject</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Find</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«object»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The affected object or entity. Shall be named according to your data-model</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Product</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>So as an example <code>shop.FindProduct</code> will reflect the permission to search and retrieve a <code>Product</code> in the <code>shop</code> application. The group <code>shop.ReadMasterData</code> may combine all permissions to read master-data from the <code>shop</code>. However, also a group <code>shop.Admin</code> may exist for the <code>Admin</code> role of the <code>shop</code> application. Here the <code>«local-name»</code> is <code>Admin</code> that does not follow the <code>«verb»«object»</code> schema.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_devon4j-security">devon4j-security</h8>
<div class="paragraph">
<p>The module <code>devon4j-security</code> provides ready-to-use code based on <a href="http://projects.spring.io/spring-security/">spring-security</a> that makes your life a lot easier.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<a class="image" href="images/Security-AccessControl.png"><img src="images/Security-AccessControl.png" alt="access-control"></a>
</div>
<div class="title">Figure 5. devon4j Security Model</div>
</div>
<div class="paragraph">
<p>The diagram shows the model of <code>devon4j-security</code> that separates two different aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <em>Identity- and Access-Management</em> is provided by according products and typically already available in the enterprise landscape (e.g. an active directory). It provides a hierarchy of <em>primary access control objects</em> (roles and groups) of a user. An administrator can grant and revoke permissions (indirectly) via this way.</p>
</li>
<li>
<p>The application security defines a hierarchy of <em>secondary access control objects</em> (groups and permissions). This is done by configuration owned by the application (see following section). The "API" is defined by the IDs of the primary access control objects that will be referenced from the <em>Identity- and Access-Management</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_access-control-config">Access Control Config</h8>
<div class="paragraph">
<p>In your application simply extend <code>AccessControlConfig</code> to configure your access control objects as code and reference it from your use-cases. An example config may look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Named
public class ApplicationAccessControlConfig extends AccessControlConfig {

  public static final String APP_ID = "MyApp";

  private static final String PREFIX = APP_ID + ".";

  public static final String PERMISSION_FIND_OFFER = PREFIX + "FindOffer";

  public static final String PERMISSION_SAVE_OFFER = PREFIX + "SaveOffer";

  public static final String PERMISSION_DELETE_OFFER = PREFIX + "DeleteOffer";

  public static final String PERMISSION_FIND_PRODUCT = PREFIX + "FindProduct";

  public static final String PERMISSION_SAVE_PRODUCT = PREFIX + "SaveProduct";

  public static final String PERMISSION_DELETE_PRODUCT = PREFIX + "DeleteProduct";

  public static final String GROUP_READ_MASTER_DATA = PREFIX + "ReadMasterData";

  public static final String GROUP_MANAGER = PREFIX + "Manager";

  public static final String GROUP_ADMIN = PREFIX + "Admin";

  public ApplicationAccessControlConfig() {

    super();
    AccessControlGroup readMasterData = group(GROUP_READ_MASTER_DATA, PERMISSION_FIND_OFFER, PERMISSION_FIND_PRODUCT);
    AccessControlGroup manager = group(GROUP_MANAGER, readMasterData, PERMISSION_SAVE_OFFER, PERMISSION_SAVE_PRODUCT);
    AccessControlGroup admin = group(GROUP_ADMIN, manager, PERMISSION_DELETE_OFFER, PERMISSION_DELETE_PRODUCT);
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_configuration-on-java-method-level">Configuration on Java Method level</h8>
<div class="paragraph">
<p>In your use-case you can now reference a permission like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Named
public class UcSafeOfferImpl extends ApplicationUc implements UcSafeOffer {

  @Override
  @RolesAllowed(ApplicationAccessControlConfig.PERMISSION_SAVE_OFFER)
  public OfferEto save(OfferEto offer) { ... }
  ...
}</code></pre>
</div>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_jee-standard">JEE Standard</h8>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/Role-based_access_control">Role-based Access Control (RBAC)</a> is commonly used for authorization.
JSR 250 defines a number of common annotations to secure your application.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>javax.annotation.security.PermitAll</code> specifies that no access control is required to invoke the specified method(s).</p>
</li>
<li>
<p><code>javax.annotation.security.DenyAll</code> specifies that no access controls are allowed to invoke the specified method(s).</p>
</li>
<li>
<p><code>javax.annotation.security.RolesAllowed</code> specifies that only a list of access controls are allowed to invoke the specified method(s).</p>
</li>
<li>
<p><code>javax.annotation.security.DeclareRoles</code> defines roles for security checking.</p>
</li>
<li>
<p><code>javax.annotation.security.RunAs</code> specifies the RunAs role for the given components.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>@PermitAll</code>, <code>@Denyall</code>, and <code>@RolesAllowed</code> annotations can be applied to both class and method.
A method-level annotation will override the behaviour of class-level annotation. Using multiple annotations of those 3 is not valid.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// invalid
@PermitAll
@DenyAll
public String foo()

// invalid and compilation fails
@RolesAllowed("admin")
@RolesAllowed("user")
public String bar()

// OK
@RolesAllowed("admin", "user")
public String bar()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that when specifying multiple arguments to <code>@RolesAllowed</code> those are combined with OR (and not with AND).
So if the user has any of the specified access controls, he will be able to access the method.</p>
</div>
<div class="paragraph">
<p>As a best practice avoid specifying string literals to <code>@RolesAllowed</code>.
Instead define a class with all access controls as constants and reference them from there.
This class is typically called <code>ApplicationAccessControlConfig</code> in devonfw.</p>
</div>
<div class="paragraph">
<p>In many complicated cases where <code>@PermitAll</code> <code>@DenyAll</code> <code>@RolesAllowed</code> are insufficient e.g. a method should be accessed by a user in role A and not in role B at the same time, you have to verify the user role directly in the method. You can use <code>SecurityContext</code> class to get further needed information.</p>
</div>
<div class="sect8">
<h9 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_spring">Spring</h9>
<div class="paragraph">
<p>Spring Security also supports authorization on method level. To use it, you need to add the <code>spring-security-config</code> dependency. If you use Spring Boot, the dependency <code>spring-boot-starter-security</code> already includes <code>spring-security-config</code>. Then you can configure as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>prePostEnabled</code> property enables Spring Security pre/post annotations. <code>@PreAuthorize</code> and <code>@PostAuthorize</code> annotations provide expression-based access control. See more <a href="https://docs.spring.io/spring-security/site/docs/4.2.x/reference/html/el-access.html">here</a></p>
</li>
<li>
<p><code>securedEnabled</code> property determines if the <code>@Secured</code> annotation should be enabled. <code>@Secured</code> can be used similarly as <code>@RollesAllowed</code>.</p>
</li>
<li>
<p><code>jsr250Enabled</code> property allows us to use the JSR-250 annotations such as <code>@RolesAllowed</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableGlobalMethodSecurity(
  prePostEnabled = true,
  securedEnabled = true,
  jsr250Enabled = true)
public class MethodSecurityConfig
  extends GlobalMethodSecurityConfiguration {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A further read about the whole concept of Spring Security Authorization can be found <a href="https://docs.spring.io/spring-security/site/docs/current/reference/html5/#servlet-authorization">here</a>.</p>
</div>
</div>
<div class="sect8">
<h9 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_quarkus">Quarkus</h9>
<div class="paragraph">
<p>Quarkus comes with built-in security to allow for RBAC based on the common security annotations <code>@RolesAllowed</code>, <code>@DenyAll</code>, <code>@PermitAll</code> on REST endpoints and CDI beans. Quarkus also provides the <code>io.quarkus.security.Authenticated</code> annotation that will permit any authenticated user to access the resource (equivalent to @RolesAllowed("**")).</p>
</div>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_data-based-permissions">Data-based Permissions</h8>
<div class="paragraph">
<p>See <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-data-permission.asciidoc">data permissions</a></p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_access-control-schema-deprecated">Access Control Schema (deprecated)</h8>
<div class="paragraph">
<p>The <code>access-control-schema.xml</code> approach is deprecated. The documentation can still be found in <a href="#devonfw-guide_devon4j.wiki_guide-access-control-schema.asciidoc">access control schema</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-data-permission.asciidoc">Data-permissions</h7>
<div class="paragraph">
<p>In some projects there are demands for permissions and authorization that is dependent on the processed data. E.g. a user may only be allowed to read or write data for a specific region. This is adding some additional complexity to your authorization. If you can avoid this it is always best to keep things simple. However, in various cases this is a requirement. Therefore the following sections give you guidance and patterns how to solve this properly.</p>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-data-permission.asciidoc_structuring-your-data">Structuring your data</h8>
<div class="paragraph">
<p>For all your business objects (entities) that have to be secured regarding to data permissions we recommend that you create a separate interface that provides access to the relevant data required to decide about the permission. Here is a simple example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface SecurityDataPermissionCountry {

  /**
   * @return the 2-letter ISO code of the country this object is associated with. Users need
   *         a data-permission for this country in order to read and write this object.
   */
  String getCountry();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now related business objects (entities) can implement this interface. Often such data-permissions have to be applied to an entire object-hierarchy. For security reasons we recommend that also all child-objects implement this interface. For performance reasons we recommend that the child-objects redundantly store the data-permission properties (such as <code>country</code> in the example above) and this gets simply propagated from the parent, when a child object is created.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-data-permission.asciidoc_permissions-for-processing-data">Permissions for processing data</h8>
<div class="paragraph">
<p>When saving or processing objects with a data-permission, we recommend to provide dedicated methods to verify the permission in an abstract base-class such as <code>AbstractUc</code> and simply call this explicitly from your business code. This makes it easy to understand and debug the code. Here is a simple example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">protected void verifyPermission(SecurityDataPermissionCountry entity) throws AccessDeniedException;</code></pre>
</div>
</div>
<div class="sect8">
<h9 id="devonfw-guide_devon4j.wiki_guide-data-permission.asciidoc_beware-of-aop">Beware of AOP</h9>
<div class="paragraph">
<p>For simple but cross-cutting data-permissions you may also use <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-aop.asciidoc">AOP</a>. This leads to programming aspects that reflectively scan method arguments and magically decide what to do. Be aware that this quickly gets tricky:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What if multiple of your method arguments have data-permissions (e.g. implement <code>SecurityDataPermission*</code>)?</p>
</li>
<li>
<p>What if the object to authorize is only provided as reference (e.g. <code>Long</code> or <code>IdRef</code>) and only loaded and processed inside the implementation where the AOP aspect does not apply?</p>
</li>
<li>
<p>How to express advanced data-permissions in annotations?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>What we have learned is that annotations like <code>@PreAuthorize</code> from <code>spring-security</code> easily lead to the "programming in string literals" anti-pattern. We strongly discourage to use this anti-pattern. In such case writing your own <code>verifyPermission</code> methods that you manually call in the right places of your business-logic is much better to understand, debug and maintain.</p>
</div>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-data-permission.asciidoc_permissions-for-reading-data">Permissions for reading data</h8>
<div class="paragraph">
<p>When it comes to restrictions on the data to read it becomes even more tricky. In the context of a user only entities shall be loaded from the database he is permitted to read. This is simple for loading a single entity (e.g. by its ID) as you can load it and then if not permitted throw an exception to secure your code. But what if the user is performing a search query to find many entities? For performance reasons we should only find data the user is permitted to read and filter all the rest already via the database query. But what if this is not a requirement for a single query but needs to be applied cross-cutting to tons of queries? Therefore we have the following pattern that solves your problem:</p>
</div>
<div class="paragraph">
<p>For each data-permission attribute (or set of such) we create an abstract base entity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@MappedSuperclass
@EntityListeners(PermissionCheckListener.class)
@FilterDef(name = "country", parameters = {@ParamDef(name = "countries", type = "string")})
@Filter(name = "country", condition = "country in (:countries)")
public abstract class SecurityDataPermissionCountryEntity extends ApplicationPersistenceEntity
    implements SecurityDataPermissionCountry {

  private String country;

  @Override
  public String getCountry() {
    return this.country;
  }

  public void setCountry(String country) {
    this.country = country;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are some special hibernate annotations <code>@EntityListeners</code>, <code>@FilterDef</code>, and <code>@Filter</code> used here allowing to apply a filter on the <code>country</code> for any (non-native) query performed by hibernate. The entity listener may look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class PermissionCheckListener {

  @PostLoad
  public void read(SecurityDataPermissionCountryEntity entity) {
    PermissionChecker.getInstance().requireReadPermission(entity);
  }

  @PrePersist
  @PreUpdate
  public void write(SecurityDataPermissionCountryEntity entity) {
    PermissionChecker.getInstance().requireWritePermission(entity);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will ensure that hibernate implicitly will call these checks for every such entity when it is read from or written to the database. Further to avoid reading entities from the database the user is not permitted to (and ending up with exceptions), we create an AOP aspect that automatically activates the above declared hibernate filter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Named
public class PermissionCheckerAdvice implements MethodBeforeAdvice {

  @Inject
  private PermissionChecker permissionChecker;

  @PersistenceContext
  private EntityManager entityManager;

  @Override
  public void before(Method method, Object[] args, Object target) {

    Collection&lt;String&gt; permittedCountries = this.permissionChecker.getPermittedCountriesForReading();
    if (permittedCountries != null) { // null is returned for admins that may access all countries
      if (permittedCountries.isEmpty()) {
        throw new AccessDeniedException("Not permitted for any country!");
      }
      Session session = this.entityManager.unwrap(Session.class);
      session.enableFilter("country").setParameterList("countries", permittedCountries.toArray());
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally to apply this aspect to all Repositories (can easily be changed to DAOs) implement the following advisor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Named
public class PermissionCheckerAdvisor implements PointcutAdvisor, Pointcut, ClassFilter, MethodMatcher {

  @Inject
  private PermissionCheckerAdvice advice;

  @Override
  public Advice getAdvice() {
    return this.advice;
  }

  @Override
  public boolean isPerInstance() {
    return false;
  }

  @Override
  public Pointcut getPointcut() {
    return this;
  }

  @Override
  public ClassFilter getClassFilter() {
    return this;
  }

  @Override
  public MethodMatcher getMethodMatcher() {
    return this;
  }

  @Override
  public boolean matches(Method method, Class&lt;?&gt; targetClass) {
    return true; // apply to all methods
  }

  @Override
  public boolean isRuntime() {
    return false;
  }

  @Override
  public boolean matches(Method method, Class&lt;?&gt; targetClass, Object... args) {
    throw new IllegalStateException("isRuntime()==false");
  }

  @Override
  public boolean matches(Class&lt;?&gt; clazz) {
    // when using DAOs simply change to some class like ApplicationDao
    return DefaultRepository.class.isAssignableFrom(clazz);
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-data-permission.asciidoc_managing-and-granting-the-data-permissions">Managing and granting the data-permissions</h8>
<div class="paragraph">
<p>Following our <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_authorization">authorization guide</a> we can simply create a permission for each country. We might simply reserve a prefix (as virtual <code>«app-id»</code>) for each data-permission to allow granting data-permissions to end-users across all applications of the IT landscape. In our example we could create access controls <code>country.DE</code>, <code>country.US</code>, <code>country.ES</code>, etc. and assign those to the users. The method <code>permissionChecker.getPermittedCountriesForReading()</code> would then scan for these access controls and only return the 2-letter country code from it.</p>
</div>
<div class="admonitionblock caution">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Before you make your decisions how to design your access controls please clarify the following questions:
</td>
</tr>
</tbody></table>
</div>
<div class="ulist">
<ul>
<li>
<p>Do you need to separate data-permissions independent of the functional permissions? E.g. may it be required to express that a user can read data from the countries <code>ES</code> and <code>PL</code> but is only permitted to modify data from <code>PL</code>? In such case a single assignment of "country-permissions" to users is insufficient.</p>
</li>
<li>
<p>Do you want to grant data-permissions individually for each application (higher flexibility and complexity) or for the entire application landscape (simplicity, better maintenance for administrators)? In case of the first approach you would rather have access controls like <code>app1.country.GB</code> and <code>app2.country.GB</code>.</p>
</li>
<li>
<p>Do your data-permissions depend on objects that can be created dynamically inside your application?</p>
</li>
<li>
<p>If you want to grant data-permissions on other business objects (entities), how do you want to reference them (primary keys, business keys, etc.)? What reference is most stable? Which is most readable?</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-jwt.asciidoc">JWT</h6>
<div class="paragraph">
<p><a href="https://jwt.io">JWT</a> (JSON Web Token) is an open standard (see <a href="https://tools.ietf.org/html/rfc7519">RFC 7519</a>) for creating <a href="#devonfw-guide_devon4j.wiki_guide-json.asciidoc">JSON</a> based access tokens that assert some number of claims.
With an IT landscape divided into multiple smaller apps you want to avoid coupling all those apps or services tightly with your IAM (Identity &amp; Access Management).
Instead your apps simply expects a JWT as <a href="https://oauth.net/2/bearer-tokens/">bearer-token</a> in the <code>Authorization</code> HTTP header field.
All it needs to do for authentication is validating this JWT.
The actual authentication is done centrally by an access system (IAM) that authors those JWTs.
Therefore we recommend to use strong asymmetric cryptography to sign the JWT when it is authored.
Create a keypair per environment and keep the private key as a secret only known to the access system authorizing the JWTs.
Your apps only need to know the public key in order to validate the JWT.
Any request without a JWT or with an invalid JWT will be rejected (with status code <code>401</code>).</p>
</div>
<div class="paragraph">
<p>When using <a href="#devonfw-guide_devon4j.wiki_spring.asciidoc">spring</a> check the <a href="#devonfw-guide_devon4j.wiki_spring_guide-jwt-spring.asciidoc">JWT Spring-Starter</a>.
For <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus.asciidoc">quarkus</a> follow <a href="https://quarkus.io/guides/security-jwt">Using JWT RBAC</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-csrf.asciidoc">Cross-site request forgery (CSRF)</h6>
<div class="paragraph">
<p>CSRF is a type of malicious exploit of a web application that allows an attacker to induce users to perform actions that they do not intend to perform.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/jwt_flow.png"><img src="images/csrf.png" alt="csrf" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>More details about csrf can be found at <a href="https://owasp.org/www-community/attacks/csrf" class="bare">https://owasp.org/www-community/attacks/csrf</a>.</p>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-csrf.asciidoc_secure-devon4j-server-against-csrf">Secure devon4j server against CSRF</h7>
<div class="paragraph">
<p>In case your devon4j server application is not accessed by browsers or the web-client is using <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-jwt.asciidoc">JWT based authentication</a>, you are already safe according to CSRF.
However, if your application is accessed from a browser and you are using <em>form based authentication</em> (with session coockie) or <em>basic authentication</em>, you need to enable CSRF protection.
This guide will tell you how to do this.</p>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-csrf.asciidoc_dependency">Dependency</h8>
<div class="paragraph">
<p>To secure your devon4j application against CSRF attacks, you only need to add the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.devonfw.java.starters&lt;/groupId&gt;
  &lt;artifactId&gt;devon4j-starter-security-csrf&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Starting with devon4j version <code>2020.12.001</code> application template, this is all you need to do.
However, if you have started from an older version or you want to understand more, please read on.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-csrf.asciidoc_pluggable-web-security">Pluggable web-security</h8>
<div class="paragraph">
<p>To enable pluggable security via devon4j security starters you need to apply <code>WebSecurityConfigurer</code> to your <code>BaseWebSecurityConfig</code> (your class extending spring-boot’s <code>WebSecurityConfigurerAdapter</code>) as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">  @Inject
  private WebSecurityConfigurer webSecurityConfigurer;

  public void configure(HttpSecurity http) throws Exception {
    // disable CSRF protection by default, use csrf starter to override.
	  http = http.csrf().disable();
	  // apply pluggable web-security from devon4j security starters
    http = this.webSecurityConfigurer.configure(http);
    .....
  }</code></pre>
</div>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-csrf.asciidoc_custom-csrfrequestmatcher">Custom CsrfRequestMatcher</h8>
<div class="paragraph">
<p>If you want to customize which HTTP requests will require a CSRF token, you can implement your own <code>CsrfRequestMatcher</code> and provide it to the devon4j CSRF protection via qualified injection as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Named("CsrfRequestMatcher")
public class CsrfRequestMatcher implements RequestMatcher {
  @Override
  public boolean matches(HttpServletRequest request) {
    .....
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that the exact name (<code>@Named("CsrfRequestMatcher")</code>) is required here to ensure your custom implementation will be injected properly.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-csrf.asciidoc_csrfrestservice">CsrfRestService</h8>
<div class="paragraph">
<p>With the <code>devon4j-starter-security-csrf</code> the <code>CsrfRestService</code> gets integrated into your app.
It provides an operation to get the CSRF token via an HTTP <code>GET</code> request.
The URL path to retrieve this CSRF token is <code>services/rest/csrf/v1/token</code>.
As a result you will get a JSON like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">{
  "token":"3a8a5f66-c9eb-4494-81e1-7cc58bc3a519",
  "parameterName":"_csrf",
  "headerName":"X-CSRF-TOKEN"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>token</code> value is a strong random value that will differ for each user session.
It has to be send with subsequent HTTP requests (when method is other than <code>GET</code>) in the specified header (<code>X-CSRF-TOKEN</code>).</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-csrf.asciidoc_how-it-works">How it works</h8>
<div class="paragraph">
<p>Putting it all together, a browser client should call the <code>CsrfRestService</code> after successfull login to receive the current CSRF token.
With every subsequent HTTP request (other than <code>GET</code>) the client has to send this token in the according HTTP header.
Otherwise the server will reject the request to prevent CSRF attacks.
Therefore, an attacker might make your browser perform HTTP requests towards your devon4j application backend via <code>&lt;image&gt;</code> elements, <code>&lt;iframes&gt;</code>, etc.
Your browser will then still include your session coockie if you are already logged in (e.g. from another tab).
However, in case he wants to trigger <code>DELETE</code> or <code>POST</code> requests trying your browser to make changes in the application (delete or update data, etc.) this will fail without CSRF token.
The attacker may make your browser retrieve the CSRF token but he will not be able to retrieve the result and put it into the header of other requests due to the same-origin-policy.
This way your application will be secured against CSRF attacks.</p>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-csrf.asciidoc_configure-devon4ng-client-for-csrf">Configure devon4ng client for CSRF</h7>
<div class="paragraph">
<p>Devon4ng client configuration for CSRF is described <a href="#devonfw-guide/devon4j.wiki_https://github.com/devonfw/devon4ng/blob/develop/documentation/guide-consuming-rest-services">here</a></p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-aop.asciidoc">Aspect Oriented Programming (AOP)</h6>
<div class="paragraph">
<p><a href="http://en.wikipedia.org/wiki/Aspect-oriented_programming">AOP</a> is a powerful feature for cross-cutting concerns. However, if used extensive and for the wrong things an application can get unmaintainable. Therefore we give you the best practices where and how to use AOP properly.</p>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-aop.asciidoc_aop-key-principles">AOP Key Principles</h7>
<div class="paragraph">
<p>We follow these principles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We use <a href="http://docs.spring.io/spring/docs/2.5.4/reference/aop.html">spring AOP</a> based on dynamic proxies (and fallback to cglib).</p>
</li>
<li>
<p>We avoid AspectJ and other mighty and complex AOP frameworks whenever possible</p>
</li>
<li>
<p>We only use AOP where we consider it as necessary (see below).</p>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-aop.asciidoc_aop-usage">AOP Usage</h7>
<div class="paragraph">
<p>We recommend to use AOP with care but we consider it established for the following cross cutting concerns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#devonfw-guide_devon4j.wiki_guide-transactions.asciidoc">Transaction-Handling</a></p>
</li>
<li>
<p><a href="#devonfw-guide_devon4j.wiki_guide-security.asciidoc_method-authorization">Authorization</a></p>
</li>
<li>
<p><a href="#devonfw-guide_devon4j.wiki_guide-validation.asciidoc">Validation</a></p>
</li>
<li>
<p><a href="#devonfw-guide_devon4j.wiki_guide-logging.asciidoc_tracing">Trace-Logging</a> (for testing and debugging)</p>
</li>
<li>
<p>Exception facades for <a href="#devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc">services</a> but only if no other solution is possible (use alternatives such as <a href="#devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc_rest-exception-handling">JAX-RS provider</a> instead).</p>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-aop.asciidoc_aop-debugging">AOP Debugging</h7>
<div class="paragraph">
<p>When using AOP with dynamic proxies the debugging of your code can get nasty. As you can see by the red boxes in the call stack in the debugger there is a lot of magic happening while you often just want to step directly into the implementation skipping all the AOP clutter. When using Eclipse this can easily be archived by enabling <em>step filters</em>. Therefore you have to enable the feature in the Eclipse tool bar (highlighted in read).</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<a class="image" href="images/eclipse-debug-aop.png"><img src="images/eclipse-debug-aop.png" alt="AOP debugging"></a>
</div>
</div>
<div class="paragraph">
<p>In order to properly make this work you need to ensure that the step filters are properly configured:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<a class="image" href="images/eclipse-debug-step-filters.png"><img src="images/eclipse-debug-step-filters.png" alt="Step Filter Configuration"></a>
</div>
</div>
<div class="paragraph">
<p>Ensure you have at least the following step-filters configured and active:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>ch.qos.logback.*
com.devonfw.module.security.*
java.lang.reflect.*
java.security.*
javax.persistence.*
org.apache.commons.logging.*
org.apache.cxf.jaxrs.client.*
org.apache.tomcat.*
org.h2.*
org.springframework.*</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-exceptions.asciidoc">Exception Handling</h6>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-exceptions.asciidoc_exception-principles">Exception Principles</h7>
<div class="paragraph">
<p>For exceptions we follow these principles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We only use exceptions for <em>exceptional</em> situations and not for programming control flows, etc. Creating an exception in Java is expensive and hence should not be done for simply testing whether something is present, valid or permitted. In the latter case design your API to return this as a regular result.</p>
</li>
<li>
<p>We use unchecked exceptions (RuntimeException) <sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</li>
<li>
<p>We distinguish <em>internal exceptions</em> and <em>user exceptions</em>:</p>
<div class="ulist">
<ul>
<li>
<p>Internal exceptions have technical reasons. For unexpected and exotic situations, it is sufficient to throw existing exceptions such as IllegalStateException. For common scenarios a own exception class is reasonable.</p>
</li>
<li>
<p>User exceptions contain a message explaining the problem for end users. Therefore, we always define our own exception classes with a clear, brief, but detailed message.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Our own exceptions derive from an exception base class supporting</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://m-m-m.sourceforge.net/apidocs/net/sf/mmm/util/exception/api/NlsRuntimeException.html#getUuid%28%29">unique ID per instance</a></p>
</li>
<li>
<p><a href="http://m-m-m.sourceforge.net/apidocs/net/sf/mmm/util/exception/api/NlsRuntimeException.html#getCode%28%29">Error code per class</a></p>
</li>
<li>
<p><a href="http://m-m-m.sourceforge.net/apidocs/net/sf/mmm/util/exception/api/NlsThrowable.html#getNlsMessage%28%29">message templating</a> (see <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-i18n.asciidoc">I18N</a>)</p>
</li>
<li>
<p><a href="http://m-m-m.sourceforge.net/apidocs/net/sf/mmm/util/exception/api/NlsRuntimeException.html#isForUser%28%29">distinguish between <em>user exceptions</em> and <em>internal exceptions</em></a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>All this is offered by <a href="http://m-m-m.sourceforge.net/apidocs/net/sf/mmm/util/exception/api/package-summary.html#documentation">mmm-util-core</a>, which we propose as a solution.
If you use the <a href="https://github.com/devonfw/devon4j/tree/master/modules/rest">devon4j-rest module</a>, this is already included. For Quarkus applications, you need to add the dependency manually.</p>
</div>
<div class="paragraph">
<p>If you want to avoid additional dependencies, you can implement your own solution for this by creating an abstract exception class <code>ApplicationBusinessException</code> extending from <code>RuntimeException</code>. For an example of this, see our <a href="https://github.com/devonfw-sample/devon4quarkus-reference">Quarkus reference application</a>.</p>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-exceptions.asciidoc_exception-example">Exception Example</h7>
<div class="paragraph">
<p>Here is an exception class from our sample application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class IllegalEntityStateException extends ApplicationBusinessException {

  private static final long serialVersionUID = 1L;

  public IllegalEntityStateException(Object entity, Object state) {

    this((Throwable) null, entity, state);
  }


  public IllegalEntityStateException(Object entity, Object currentState, Object newState) {

    this(null, entity, currentState, newState);
  }

  public IllegalEntityStateException(Throwable cause, Object entity, Object state) {

    super(cause, createBundle(NlsBundleApplicationRoot.class).errorIllegalEntityState(entity, state));
  }

  public IllegalEntityStateException(Throwable cause, Object entity, Object currentState, Object newState) {

    super(cause, createBundle(NlsBundleApplicationRoot.class).errorIllegalEntityStateChange(entity, currentState,
        newState));
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The message templates are defined in the interface NlsBundleRestaurantRoot as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface NlsBundleApplicationRoot extends NlsBundle {


  @NlsBundleMessage("The entity {entity} is in state {state}!")
  NlsMessage errorIllegalEntityState(@Named("entity") Object entity, @Named("state") Object state);


  @NlsBundleMessage("The entity {entity} in state {currentState} can not be changed to state {newState}!")
  NlsMessage errorIllegalEntityStateChange(@Named("entity") Object entity, @Named("currentState") Object currentState,
      @Named("newState") Object newState);


  @NlsBundleMessage("The property {property} of object {object} can not be changed!")
  NlsMessage errorIllegalPropertyChange(@Named("object") Object object, @Named("property") Object property);

  @NlsBundleMessage("There is currently no user logged in")
  NlsMessage errorNoActiveUser();</code></pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-exceptions.asciidoc_handling-exceptions">Handling Exceptions</h7>
<div class="paragraph">
<p>For catching and handling exceptions we follow these rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We do not catch exceptions just to wrap or to re-throw them.</p>
</li>
<li>
<p>If we catch an exception and throw a new one, we always <strong>have</strong> to provide the original exception as <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html#getCause%28%29">cause</a> to the constructor of the new exception.</p>
</li>
<li>
<p>At the entry points of the application (e.g. a service operation) we have to catch and handle all throwables. This is done via the <em>exception-facade-pattern</em> via an explicit facade or aspect. The <code>devon4j-rest</code> module already provides ready-to-use implementations for this such as <a href="https://github.com/devonfw/devon4j/blob/develop/modules/rest/src/main/java/com/devonfw/module/rest/service/impl/RestServiceExceptionFacade.java">RestServiceExceptionFacade</a> that you can use in your Spring application. For Quarkus, follow the <a href="#devonfw-guide_devon4j.wiki_quarkus_guide-exception-handling.asciidoc">Quarkus guide on exception handling</a>.<br>
The exception facade has to …​</p>
<div class="ulist">
<ul>
<li>
<p>log all errors (user errors on info and technical errors on error level)</p>
</li>
<li>
<p>ensure that the entire exception is passed to the logger (not only the message) so that the logger can capture the entire stacktrace and the root cause is not lost.</p>
</li>
<li>
<p>convert the error to a result appropriable for the client and secure for <a href="https://www.owasp.org/index.php/Top_10_2013-A6-Sensitive_Data_Exposure">Sensitive Data Exposure</a>. Especially for security exceptions only a generic security error code or message may be revealed but the details shall only be logged but <strong>not</strong> be exposed to the client. All <em>internal exceptions</em> are converted to a generic error with a message like:</p>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>An unexpected technical error has occurred. We apologize any inconvenience. Please try again later.</p>
</div>
</blockquote>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-exceptions.asciidoc_common-errors">Common Errors</h7>
<div class="paragraph">
<p>The following errors may occur in any devon application:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 30. Common Exceptions</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Code</strong></th>
<th class="tableblock halign-left valign-top"><strong>Message</strong></th>
<th class="tableblock halign-left valign-top"><strong>Link</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TechnicalError</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An unexpected error has occurred! We apologize any inconvenience. Please try again later.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/m-m-m/util/blob/master/exception/src/main/java/net/sf/mmm/util/exception/api/TechnicalErrorUserException.java">TechnicalErrorUserException.java</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ServiceInvoke</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">«original message of the cause»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/m-m-m/util/blob/master/exception/src/main/java/net/sf/mmm/util/exception/api/ServiceInvocationFailedException.java">ServiceInvocationFailedException.java</a></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-i18n.asciidoc">Internationalization</h6>
<div class="paragraph">
<p>Internationalization (I18N) is about writing code independent from locale-specific information.
For I18N of text messages we are suggesting
<a href="http://m-m-m.sourceforge.net/apidocs/net/sf/mmm/util/nls/api/package-summary.html#documentation">mmm native-language-support</a>.</p>
</div>
<div class="paragraph">
<p>In devonfw we have developed a solution to manage text internationalization. devonfw solution comes into two aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bind locale information to the user.</p>
</li>
<li>
<p>Get the messages in the current user locale.</p>
</li>
</ul>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-i18n.asciidoc_binding-locale-information-to-the-user">Binding locale information to the user</h7>
<div class="paragraph">
<p>We have defined two different points to bind locale information to user, depending on user is authenticated or not.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User not authenticated: devonfw intercepts unsecured request and extract locale from it. At first, we try to extract a <code>language</code> parameter from the request and if it is not possible, we extract locale from Àccept-language` header.</p>
</li>
<li>
<p>User authenticated. During login process, applications developers are responsible to fill <code>language</code> parameter in the UserProfile class. This <code>language</code> parameter could be obtain from DB, LDAP, request, etc. In devonfw sample we get the locale information from database.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This image shows the entire process:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/i18n.png" alt="Internationalization">
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-i18n.asciidoc_getting-internationalizated-messages">Getting internationalizated messages</h7>
<div class="paragraph">
<p>devonfw has a bean that manage i18n message resolution, the <code>ApplicationLocaleResolver.</code> This bean is responsible to get the current user and extract locale information from it and read the correct properties file to get the message.</p>
</div>
<div class="paragraph">
<p>The i18n properties file must be called <code>ApplicationMessages_la_CO.properties</code> where la=language and CO=country. This is an example of a i18n properties file for English language to translate devonfw sample user roles:</p>
</div>
<div class="paragraph">
<p>ApplicationMessages_en_US.properties</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>admin=Admin</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should define an ApplicationMessages_la_CO.properties file for every language that your application needs.</p>
</div>
<div class="paragraph">
<p><code>ApplicationLocaleResolver</code> bean is injected in <code>AbstractComponentFacade</code> class so you have available this bean in logic layer so you only need to put this code to get an internationalized message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String msg = getApplicationLocaleResolver().getMessage("mymessage");</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-service-client.asciidoc">Service Client</h6>
<div class="paragraph">
<p>This guide is about consuming (calling) services from other applications (micro-services). For providing services, see the <a href="#devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc">Service-Layer Guide</a>. Services can be consumed by the <a href="#devonfw-guide_devon4j.wiki_guide-client-layer.asciidoc">client</a> or the server. As the client is typically not written in Java, you should consult the according guide for your client technology. In case you want to call a service within your Java code, this guide is the right place to get help.</p>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-service-client.asciidoc_motivation">Motivation</h7>
<div class="paragraph">
<p>Various solutions already exist for calling services, such as <code>RestTemplate</code> from spring or the JAX-RS client API. Furthermore, each and every service framework offers its own API as well. These solutions might be suitable for very small and simple projects (with one or two such invocations). However, with the trend of microservices, the invocation of a service becomes a very common use-case that occurs all over the place. You typically need a solution that is very easy to use but supports flexible configuration, adding headers for authentication, mapping of errors from the server, logging success/errors with duration for performance analysis, support for synchronous and asynchronous invocations, etc. This is exactly what this <code>devon4j</code> service-client solution brings to you.</p>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-service-client.asciidoc_usage">Usage</h7>
<div class="paragraph">
<p><strong>Spring</strong></p>
</div>
<div class="paragraph">
<p>For Spring, follow the <a href="#devonfw-guide_devon4j.wiki_spring_guide-service-client-spring.asciidoc">Spring rest-client guide</a>.</p>
</div>
<div class="paragraph">
<p><strong>Quarkus</strong></p>
</div>
<div class="paragraph">
<p>For Quarkus, we recommend to follow the official <a href="#devonfw-guide/devon4j.wiki_https://quarkus.io/guides/rest-client">Quarkus rest-client guide</a></p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc">Testing</h6>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_general-best-practices">General best practices</h7>
<div class="paragraph">
<p>For testing please follow our general best practices:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tests should have a clear goal that should also be documented.</p>
</li>
<li>
<p>Tests have to be classified into different <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-testing.asciidoc_integration-levels">integration levels</a>.</p>
</li>
<li>
<p>Tests should follow a clear naming convention.</p>
</li>
<li>
<p>Automated tests need to properly assert the result of the tested operation(s) in a reliable way. E.g. avoid stuff like <code>assertThat(service.getAllEntities()).hasSize(42)</code> or even worse tests that have no assertion at all.</p>
</li>
<li>
<p>Tests need to be independent of each other. Never write test-cases or tests (in Java @Test methods) that depend on another test to be executed before.</p>
</li>
<li>
<p>Use <a href="http://joel-costigliola.github.io/assertj/">AssertJ</a> to write good readable and maintainable tests that also provide valuable feedback in case a test fails. Do not use legacy JUnit methods like <code>assertEquals</code> anymore!</p>
</li>
<li>
<p>For easy understanding divide your test in three commented sections:</p>
<div class="ulist">
<ul>
<li>
<p><code>//given</code></p>
</li>
<li>
<p><code>//when</code></p>
</li>
<li>
<p><code>//then</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Plan your tests and test data management properly before implementing.</p>
</li>
<li>
<p>Instead of having a too strong focus on test coverage better ensure you have covered your critical core functionality properly and review the code including tests.</p>
</li>
<li>
<p>Test code shall NOT be seen as second class code. You shall consider design, architecture and code-style also for your test code but do not over-engineer it.</p>
</li>
<li>
<p>Test automation is good but should be considered in relation to cost per use. Creating full coverage via <em>automated system tests</em> can cause a massive amount of test-code that can turn out as a huge maintenance hell. Always consider all aspects including product life-cycle, criticality of use-cases to test, and variability of the aspect to test (e.g. UI, test-data).</p>
</li>
<li>
<p>Use continuous integration and establish that the entire team wants to have clean builds and running tests.</p>
</li>
<li>
<p>Prefer delegation over inheritance for cross-cutting testing functionality. Good places to put this kind of code can be realized and reused via the JUnit @Rule mechanism.</p>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_test-automation-technology-stack">Test Automation Technology Stack</h7>
<div class="paragraph">
<p>For test automation we use <a href="http://junit.org/">JUnit</a>. However, we are strictly doing all assertions with <a href="http://joel-costigliola.github.io/assertj/">AssertJ</a>. For <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-testing.asciidoc_test-doubles">mocking</a> we use <a href="http://mockito.org/">Mockito</a>.
In order to mock remote connections we use <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-testing.asciidoc_wiremock">WireMock</a>.</p>
</div>
<div class="paragraph">
<p>For testing entire components or sub-systems we recommend to use for Spring stack <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-testing.html">spring-boot-starter-test</a> as lightweight and fast testing infrastructure that is already shipped with <code>devon4j-test</code>. For Quarkus, you can add the necessary extensions manually such as <code>quarkus-junit5</code>, <code>quarkus-junit5-mockito</code>, <code>assertj-core</code> etc.</p>
</div>
<div class="paragraph">
<p>In case you have to use a full blown JEE application server, we recommend to use <a href="http://arquillian.org/">arquillian</a>. To get started with arquillian, look <a href="http://arquillian.org/guides/getting_started/index.html#add_the_arquillian_apis">here</a>.</p>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_test-doubles">Test Doubles</h7>
<div class="paragraph">
<p>We use <a href="http://xunitpatterns.com/Using%20Test%20Doubles.html">test doubles</a> as generic term for mocks, stubs, fakes, dummies, or spys to avoid confusion. Here is a short summary from <a href="http://martinfowler.com/articles/mocksArentStubs.html">stubs VS mocks</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Dummy</strong> objects specifying no logic at all. May declare data in a POJO style to be used as boiler plate code to parameter lists or even influence the control flow towards the test’s needs.</p>
</li>
<li>
<p><strong>Fake</strong> objects actually have working implementations, but usually take some shortcut which makes them not suitable for production (an in memory database is a good example).</p>
</li>
<li>
<p><strong>Stubs</strong> provide canned answers to calls made during the test, usually not responding at all to anything outside what’s programmed in for the test. Stubs may also record information about calls, such as an email gateway stub that remembers the messages it 'sent', or maybe only how many messages it 'sent'.</p>
</li>
<li>
<p><strong>Mocks</strong> are objects pre-programmed with expectations, which form a specification of the calls they are expected to receive.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We try to give some examples, which should make it somehow clearer:</p>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_stubs">Stubs</h8>
<div class="paragraph">
<p>Best Practices for applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A good way to replace small to medium large boundary systems, whose impact (e.g. latency) should be ignored during load and performance tests of the application under development.</p>
</li>
<li>
<p>As stub implementation will rely on state-based verification, there is the threat, that test developers will partially reimplement the state transitions based on the replaced code. This will immediately lead to a black maintenance whole, so better use mocks to assure the certain behavior on interface level.</p>
</li>
<li>
<p>Do NOT use stubs as basis of a large amount of test cases as due to state-based verification of stubs, test developers will enrich the stub implementation to become a large monster with its own hunger after maintenance efforts.</p>
</li>
</ul>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_mocks">Mocks</h8>
<div class="paragraph">
<p>Best Practices for applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Replace not-needed dependencies of your system-under-test (SUT) to minimize the application context to start of your component framework.</p>
</li>
<li>
<p>Replace dependencies of your SUT to impact the control flow under test without establishing all the context parameters needed to match the control flow.</p>
</li>
<li>
<p>Remember: Not everything has to be mocked! Especially on lower levels of tests like isolated module tests you can be betrayed into a mocking delusion, where you end up in a hundred lines of code mocking the whole context and five lines executing the test and verifying the mocks behavior. Always keep in mind the benefit-cost ratio, when implementing tests using mocks.</p>
</li>
</ul>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_wiremock">WireMock</h8>
<div class="paragraph">
<p>If you need to mock remote connections such as HTTP-Servers, WireMock offers easy to use functionality. For a full description see the <a href="http://wiremock.org/">homepage</a> or the <a href="https://github.com/tomakehurst/wiremock">github repository</a>. Wiremock can be used either as a JUnit Rule, in Java outside of JUnit or as a standalone process. The mocked server can be configured to respond to specific requests in a given way via a fluent Java API, JSON files and JSON over HTTP. An example as an integration to JUnit can look as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import static com.github.tomakehurst.wiremock.core.WireMockConfiguration.wireMockConfig;
import com.github.tomakehurst.wiremock.junit.WireMockRule;

public class WireMockOfferImport{

  @Rule
  public WireMockRule mockServer = new WireMockRule(wireMockConfig().dynamicPort());

  @Test
  public void requestDataTest() throws Exception {
  int port = this.mockServer.port();
  ...}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This creates a server on a randomly chosen free port on the running machine. You can also specify the port to be used if wanted. Other than that there are several options to further configure the server. This includes HTTPs, proxy settings, file locations, logging and extensions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">  @Test
  public void requestDataTest() throws Exception {
      this.mockServer.stubFor(get(urlEqualTo("/new/offers")).withHeader("Accept", equalTo("application/json"))
      .withHeader("Authorization", containing("Basic")).willReturn(aResponse().withStatus(200).withFixedDelay(1000)
      .withHeader("Content-Type", "application/json").withBodyFile("/wireMockTest/jsonBodyFile.json")));
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will stub the URL <code>localhost:port/new/offers</code> to respond with a status 200 message containing a header (<code>Content-Type: application/json</code>) and a body with content given in <code>jsonBodyFile.json</code> if the request matches several conditions.
It has to be a GET request to <code>../new/offers</code> with the two given header properties.</p>
</div>
<div class="paragraph">
<p>Note that by default files are located in <code>src/test/resources/__files/</code>. When using only one WireMock server one can omit the <code>this.mockServer</code> in before the <code>stubFor</code> call (static method).
You can also add a fixed delay to the response or processing delay with <code>WireMock.addRequestProcessingDelay(time)</code> in order to test for timeouts.</p>
</div>
<div class="paragraph">
<p>WireMock can also respond with different corrupted messages to simulate faulty behaviour.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test(expected = ResourceAccessException.class)
public void faultTest() {

    this.mockServer.stubFor(get(urlEqualTo("/fault")).willReturn(aResponse()
    .withFault(Fault.MALFORMED_RESPONSE_CHUNK)));
...}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A GET request to <code>../fault</code> returns an OK status header, then garbage, and then closes the connection.</p>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_integration-levels">Integration Levels</h7>
<div class="paragraph">
<p>There are many discussions about the right level of integration for test automation. Sometimes it is better to focus on small, isolated modules of the system - whatever a "module" may be. In other cases it makes more sense to test integrated groups of modules. Because there is no universal answer to this question, devonfw only defines a common terminology for what could be tested. Each project must make its own decision where to put the focus of test automation. There is no worldwide accepted terminology for the integration levels of testing. In general we consider <a href="http://istqbexamcertification.com/what-are-software-testing-levels/">ISTQB</a>. However, with a technical focus on test automation we want to get more precise.</p>
</div>
<div class="paragraph">
<p>The following picture shows a simplified view of an application based on the <a href="#devonfw-guide_devon4j.wiki_architecture.asciidoc_technical-architecture">devonfw reference architecture</a>. We define four integration levels that are explained in detail below.
The boxes in the picture contain parenthesized numbers. These numbers depict the lowest integration level, a box belongs to. Higher integration levels also contain all boxes of lower integration levels. When writing tests for a given integration level, related boxes with a lower integration level must be replaced by test <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-testing.asciidoc_test-doubles">doubles</a> or drivers.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/integration-levels.png" alt="Integration Levels">
</div>
</div>
<div class="paragraph">
<p>The main difference between the integration levels is the amount of infrastructure needed to test them. The more infrastructure you need, the more bugs you will find, but the more instable and the slower your tests will be. So each project has to make a trade-off between pros and contras of including much infrastructure in tests and has to select the integration levels that fit best to the project.</p>
</div>
<div class="paragraph">
<p>Consider, that more infrastructure does not automatically lead to a better bug-detection. There may be bugs in your software that are masked by bugs in the infrastructure. The best way to find those bugs is to test with very few infrastructure.</p>
</div>
<div class="paragraph">
<p>External systems do not belong to any of the integration levels defined here. devonfw does not recommend involving real external systems in test automation. This means, they have to be replaced by test <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-testing.asciidoc_test-doubles">doubles</a> in automated tests. An exception may be external systems that are fully under control of the own development team.</p>
</div>
<div class="paragraph">
<p>The following chapters describe the four integration levels.</p>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_level-1-module-test">Level 1 Module Test</h8>
<div class="paragraph">
<p>The goal of a <em>isolated module test</em> is to provide fast feedback to the developer. Consequently, isolated module tests must not have any interaction with the client, the database, the file system, the network, etc.</p>
</div>
<div class="paragraph">
<p>An isolated module test is testing a single classes or at least a small set of classes in isolation. If such classes depend on other components or external resources, etc. these shall be replaced with a <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-testing.asciidoc_test-doubles">test double</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class MyClassTest extends ModuleTest {

  @Test
  public void testMyClass() {

    // given
    MyClass myClass = new MyClass();
    // when
    String value = myClass.doSomething();
    // then
    assertThat(value).isEqualTo("expected value");
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For an advanced example see <a href="https://github.com/devonfw/devon4j/blob/develop/modules/rest/src/test/java/com/devonfw/module/rest/service/impl/RestServiceExceptionFacadeTest.java">here</a>.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_level-2-component-test">Level 2 Component Test</h8>
<div class="paragraph">
<p>A <a href="http://istqbexamcertification.com/what-is-component-testing/"><em>component test</em></a> aims to test components or component parts as a unit.
These tests can access resources such as a database (e.g. for DAO tests).
Further, no remote communication is intended here. Access to external systems shall be replaced by a <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-testing.asciidoc_test-doubles">test double</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Spring stack, they are typically run with a (light-weight) infrastructure such as spring-boot-starter-test. A component-test is illustrated in the following example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@SpringBootTest(classes = { MySpringBootApp.class }, webEnvironment = WebEnvironment.NONE)
public class UcFindCountryTest extends ComponentTest {
  @Inject
  private UcFindCountry ucFindCountry;

  @Test
  public void testFindCountry() {

    // given
    String countryCode = "de";

    // when
    TestUtil.login("user", MyAccessControlConfig.FIND_COUNTRY);
    CountryEto country = this.ucFindCountry.findCountry(countryCode);

    // then
    assertThat(country).isNotNull();
    assertThat(country.getCountryCode()).isEqualTo(countryCode);
    assertThat(country.getName()).isEqualTo("Germany");
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This test will start the entire spring-context of your app (<code>MySpringBootApp</code>). Within the test spring will inject according spring-beans into all your fields annotated with <code>@Inject</code>. In the test methods you can use these spring-beans and perform your actual tests. This pattern can be used for testing DAOs/Repositories, Use-Cases, or any other spring-bean with its entire configuration including database and transactions.</p>
</div>
</li>
<li>
<p>For Quarkus, you can similarly inject the CDI beans and perform tests. An example is shown below:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@QuarkusTest
public class UcFindCountryTest {
  @Inject
  private UcFindCountry ucFindCountry;
  ...</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you are testing use-cases your <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-access-control.asciidoc_configuration-on-java-method-level">authorization</a> will also be in place. Therefore, you have to simulate a logon in advance what is done via the <code>login</code> method in the above Spring example.  The test-infrastructure will automatically do a <code>logout</code> for you after each test method in <code>doTearDown</code>.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_level-3-subsystem-test">Level 3 Subsystem Test</h8>
<div class="paragraph">
<p>A <em>subsystem test</em> runs against the external interfaces (e.g. HTTP service) of the integrated subsystem. Subsystem tests of the client subsystem are described in the <a href="#devonfw-guide/devon4j.wiki_https://github.com/devonfw/devon4ng/blob/master/documentation/guide-testing">devon4ng testing guide</a>. In devon4j the server (JEE application) is the subsystem under test. The tests act as a client (e.g. service consumer) and the server has to be integrated and started in a container.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>With devon4j and Spring you can write a subsystem-test as easy as illustrated in the following example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@SpringBootTest(classes = { MySpringBootApp.class }, webEnvironment = WebEnvironment.RANDOM_PORT)
public class CountryRestServiceTest extends SubsystemTest {

  @Inject
  private ServiceClientFactory serviceClientFactory;

  @Test
  public void testFindCountry() {

    // given
    String countryCode = "de";

    // when
    CountryRestService service = this.serviceClientFactory.create(CountryRestService.class);
    CountryEto country = service.findCountry(countryCode);

    // then
    assertThat(country).isNotNull();
    assertThat(country.getCountryCode()).isEqualTo(countryCode);
    assertThat(country.getName()).isEqualTo("Germany");
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Even though not obvious on the first look this test will start your entire application as a server on a free random port (so that it works in CI with parallel builds for different branches) and tests the invocation of a (REST) service including (un)marshalling of data (e.g. as JSON) and transport via HTTP (all in the invocation of the <code>findCountry</code> method).</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Do not confuse a <em>subsystem test</em> with a <a href="http://istqbexamcertification.com/what-is-system-integration-testing/">system integration test</a>. A system integration test validates the interaction of several systems where we do not recommend test automation.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_level-4-system-test">Level 4 System Test</h8>
<div class="paragraph">
<p>A <a href="http://istqbexamcertification.com/what-is-system-testing/"><em>system test</em></a> has the goal to test the system as a whole against its official interfaces such as its UI or batches. The system itself runs as a separate process in a way close to a regular deployment. Only external systems are simulated by <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-testing.asciidoc_test-doubles">test doubles</a>.</p>
</div>
<div class="paragraph">
<p>The devonfw only gives advice for automated system test (TODO see allure testing framework). In nearly every project there must be manual system tests, too. This manual system tests are out of scope here.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_classifying-integration-levels">Classifying Integration-Levels</h8>
<div class="paragraph">
<p>For Spring stack, devon4j defines <a href="https://github.com/devonfw/devon4j/tree/develop/modules/test/src/main/java/com/devonfw/module/test/common/api/category">Category-Interfaces</a> that shall be used as <a href="https://github.com/junit-team/junit/wiki/Categories">JUnit Categories</a>.
Also devon4j provides <a href="https://github.com/devonfw/devon4j/tree/develop/modules/test/src/main/java/com/devonfw/module/test/common/base">abstract base classes</a> that you may extend in your test-cases if you like.</p>
</div>
<div class="paragraph">
<p>devon4j further pre-configures the maven build to only run integration levels 1-2 by default (e.g. for fast feedback in continuous integration). It offers the profiles subsystemtest (1-3) and systemtest (1-4). In your nightly build you can simply add -Psystemtest to run all tests.</p>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_implementation">Implementation</h7>
<div class="paragraph">
<p>This section introduces how to implement tests on the different levels with the given devonfw infrastructure and the proposed frameworks.
For Spring, see <a href="#devonfw-guide_devon4j.wiki_spring_guide-spring-testing.asciidoc_implementation">Spring Test Implementation</a></p>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_regression-testing">Regression testing</h7>
<div class="paragraph">
<p>When it comes to complex output (even binary) that you want to regression test by comparing with an expected result, you sould consider <a href="https://approvaltests.com/">Approval Tests</a> using <a href="https://github.com/approvals/approvaltests.java">ApprovalTests.Java</a>.
If applied for the right problems, it can be very helpful.</p>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_deployment-pipeline">Deployment Pipeline</h7>
<div class="paragraph">
<p>A deployment pipeline is a semi-automated process that gets software-changes from version control into production. It contains several validation steps, e.g. automated tests of all integration levels.
Because devon4j should fit to different project types - from agile to waterfall - it does not define a standard deployment pipeline. But we recommend to define such a deployment pipeline explicitly for each project and to find the right place in it for each type of test.</p>
</div>
<div class="paragraph">
<p>For that purpose, it is advisable to have fast running test suite that gives as much confidence as possible without needing too much time and too much infrastructure. This test suite should run in an early stage of your deployment pipeline. Maybe the developer should run it even before he/she checked in the code. Usually lower integration levels are more suitable for this test suite than higher integration levels.</p>
</div>
<div class="paragraph">
<p>Note, that the deployment pipeline always should contain manual validation steps, at least manual acceptance testing. There also may be manual validation steps that have to be executed for special changes only, e.g. usability testing. Management and execution processes of those manual validation steps are currently not in the scope of devonfw.</p>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_test-coverage">Test Coverage</h7>
<div class="paragraph">
<p>We are using tools (SonarQube/Jacoco) to measure the coverage of the tests. Please always keep in mind that the only reliable message of a code coverage of X% is that (100-X)% of the code is entirely untested. It does not say anything about the quality of the tests or the software though it often relates to it.</p>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_test-configuration">Test Configuration</h7>
<div class="paragraph">
<p>This section covers test configuration in general without focusing on integration levels as in the first chapter.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Spring, see <a href="#devonfw-guide_devon4j.wiki_spring_guide-spring-testing.asciidoc_configure-test-specific-beans">Configure Test Specific Beans</a></p>
</li>
<li>
<p>For Quarkus, see <a href="#devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-testing.asciidoc_configuration">here</a></p>
</li>
</ul>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_configure-test-specific-beans">Configure Test Specific Beans</h8>
<div class="paragraph">
<p>Sometimes it can become handy to provide other or differently configured bean implementations via CDI than those available in production. For example, when creating beans using <code>@Bean</code>-annotated methods they are usually configured within those methods. <a href="https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/java/com/devonfw/application/mtsj/general/service/impl/config/WebSecurityBeansConfig.java">WebSecurityBeansConfig</a> shows an example of such methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
public class WebSecurityBeansConfig {
  //...
  @Bean
  public AccessControlSchemaProvider accessControlSchemaProvider() {
    // actually no additional configuration is shown here
    return new AccessControlSchemaProviderImpl();
  }
  //...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>AccessControlSchemaProvider</code> allows to programmatically access data defined in some XML file, e.g. <code>access-control-schema.xml</code>. Now, one can imagine that it would be helpful if <code>AccessControlSchemaProvider</code> would point to some other file than the default within a test class. That file could provide content that differs from the default.
The question is: how can I change resource path of <code>AccessControlSchemaProviderImpl</code> within a test?</p>
</div>
<div class="paragraph">
<p>One very helpful solution is to use <strong>static inner classes</strong>.
Static inner classes can contain <code>@Bean</code> -annotated methods, and by placing them in the <code>classes</code> parameter in <code>@SpringBootTest(classes = { /* place class here*/ })</code> annotation the beans returned by these methods are placed in the application context during test execution. Combining this feature with inheritance allows to override methods defined in other configuration classes as shown in the following listing where <code>TempWebSecurityConfig</code> extends <code>WebSecurityBeansConfig</code>. This relationship allows to override <code>public AccessControlSchemaProvider accessControlSchemaProvider()</code>. Here we are able to configure the instance of type <code>AccessControlSchemaProviderImpl</code> before returning it (and, of course, we could also have used a completely different implementation of the <code>AccessControlSchemaProvider</code> interface). By overriding the method the implementation of the super class is ignored, hence, only the new implementation is called at runtime. Other methods defined in <code>WebSecurityBeansConfig</code> which are not overridden by the subclass are still dispatched to <code>WebSecurityBeansConfig</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">//... Other testing related annotations
@SpringBootTest(classes = { TempWebSecurityConfig.class })
public class SomeTestClass {

  public static class TempWebSecurityConfig extends WebSecurityBeansConfig {

    @Override
    @Bean
    public AccessControlSchemaProvider accessControlSchemaProvider() {

      ClassPathResource resource = new ClassPathResource(locationPrefix + "access-control-schema3.xml");
      AccessControlSchemaProviderImpl accessControlSchemaProvider = new AccessControlSchemaProviderImpl();
      accessControlSchemaProvider.setAccessControlSchema(resource);
      return accessControlSchemaProvider;
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#testcontext-ctx-management-javaconfig">chapter of the Spring framework documentation</a> explains issue, but uses a slightly different way to obtain the configuration.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_test-data">Test Data</h8>
<div class="paragraph">
<p>It is possible to obtain test data in two different ways depending on your test’s integration level.</p>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_debugging-tests">Debugging Tests</h7>
<div class="paragraph">
<p>The following two sections describe two debugging approaches for tests. Tests are either run from within the IDE or from the command line using Maven.</p>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_debugging-with-the-ide">Debugging with the IDE</h8>
<div class="paragraph">
<p>Debugging with the IDE is as easy as always. Even if you want to execute a <code>SubsystemTest</code> which needs a Spring context and a server infrastructure to run properly, you just set your breakpoints and click on Debug As → JUnit Test. The test infrastructure will take care of initializing the necessary infrastructure - if everything is configured properly.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-testing.asciidoc_debugging-with-maven">Debugging with Maven</h8>
<div class="paragraph">
<p>Please refer to the following two links to find a guide for debugging tests when running them from Maven.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://maven.apache.org/surefire/maven-surefire-plugin/examples/debugging.html" class="bare">http://maven.apache.org/surefire/maven-surefire-plugin/examples/debugging.html</a></p>
</li>
<li>
<p><a href="https://www.eclipse.org/jetty/documentation/jetty-9/index.html#debugging-with-eclipse" class="bare">https://www.eclipse.org/jetty/documentation/jetty-9/index.html#debugging-with-eclipse</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In essence, you first have to start execute a test using the command line. Maven will halt just before the test execution and wait for your IDE to connect to the process. When receiving a connection the test will start and then pause at any breakpoint set in advance.
The first link states that tests are started through the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mvn -Dmaven.surefire.debug test</code></pre>
</div>
</div>
<div class="paragraph">
<p>Although this is correct, it will run <em>every</em> test class in your project and - which is time consuming and mostly unnecessary - halt before each of these tests.
To counter this problem you can simply execute a single test class through the following command (here we execute the <code>TablemanagementRestServiceTest</code> from the restaurant sample application):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mvn test -Dmaven.surefire.debug test -Dtest=TablemanagementRestServiceTest</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is important to notice that you first have to execute the Maven command in the according submodule, e.g. to execute the <code>TablemanagementRestServiceTest</code> you have first to navigate to the core module’s directory.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-transferobject.asciidoc">Transfer-Objects</h6>
<div class="paragraph">
<p>The technical data model is defined in form of <a href="#devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entity">persistent entities</a>.
However, passing persistent entities via <em>call-by-reference</em> across the entire application will soon cause problems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Changes to a persistent entity are directly written back to the persistent store when the transaction is committed. When the entity is send across the application also changes tend to take place in multiple places endangering data sovereignty and leading to inconsistency.</p>
</li>
<li>
<p>You want to send and receive data via services across the network and have to define what section of your data is actually transferred. If you have relations in your technical model you quickly end up loading and transferring way too much data.</p>
</li>
<li>
<p>Modifications to your technical data model shall not automatically have impact on your external services causing incompatibilities.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To prevent such problems transfer-objects are used leading to a <em>call-by-value</em> model and decoupling changes to persistent entities.</p>
</div>
<div class="paragraph">
<p>In the following sections the different types of transfer-objects are explained.
You will find all according naming-conventions in the <a href="#devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc_architecture-mapping">architecture-mapping</a></p>
</div>
<div class="paragraph">
<p>To structure your transfer objects, we recommend the following approaches:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#devonfw-guide_devon4j.wiki_guide-eto-cto.asciidoc">ETO and CTO</a></p>
</li>
<li>
<p><a href="#devonfw-guide_devon4j.wiki_guide-dto.asciidoc">DTO</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also considering the following transfer objects in specific cases:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">SearchCriteriaTo</dt>
<dd>
<p>For searching we create or generate a <code>«BusinessObject»SearchCriteriaTo</code> representing a query to find instances of <code>«BusinessObject»</code>.</p>
</dd>
<dt class="hdlist1">TO</dt>
<dd>
<p>There are typically transfer-objects for data that is never persistent.
For very generic cases these just carry the suffix <code>To</code>.</p>
</dd>
<dt class="hdlist1">STO</dt>
<dd>
<p>We can potentially create separate <em>service transfer objects</em> (STO) (if possible named <code>«BusinessObject»Sto</code>) to keep the <a href="#devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc">service</a> API stable and independent of the actual data-model.
However, we usually do not need this and want to keep our architecture simple.
Only create STOs if you need <a href="#devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc_versioning">service versioning</a> and support previous APIs or to provide legacy service technologies that require their own isolated data-model.
In such case you also need <a href="#devonfw-guide_devon4j.wiki_guide-beanmapping.asciidoc">beanmapping</a> between STOs and ETOs/DTOs what means extra effort and complexity that should be avoided.</p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_spring_guide-beanmapping-spring.asciidoc">Bean Mapping in devon4j-spring</h6>
<div class="paragraph">
<p>We have developed a solution that uses a <code>BeanMapper</code> that allows to abstract from the underlying implementation. As mentioned in the <a href="#devonfw-guide/devon4j.wiki/spring_../guide-beanmapping.asccidoc">general bean mapping guide</a>, we started with <a href="http://dozer.sourceforge.net/documentation/about.html">Dozer</a> a Java Bean to Java Bean mapper that recursively copies data from one object to another. Now we recommend using <a href="https://orika-mapper.github.io/orika-docs/">Orika</a>. This guide will show an introduction to Orika and Dozer bean-mapper.</p>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_spring_guide-beanmapping-spring.asciidoc_bean-mapper-dependency">Bean-Mapper Dependency</h7>
<div class="paragraph">
<p>To get access to the <code>BeanMapper</code> we have to use either of the below dependency in our POM:</p>
</div>
<div class="listingblock">
<div class="title">Listing 8. <strong>Orika</strong></div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.devonfw.java.modules&lt;/groupId&gt;
    &lt;artifactId&gt;devon4j-beanmapping-orika&lt;/artifactId&gt;
    &lt;version&gt;2020.12.002&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 9. <strong>Dozer</strong></div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.devonfw.java.modules&lt;/groupId&gt;
    &lt;artifactId&gt;devon4j-beanmapping-dozer&lt;/artifactId&gt;
    &lt;version&gt;2020.12.002&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_spring_guide-beanmapping-spring.asciidoc_bean-mapper-configuration">Bean-Mapper Configuration</h7>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_spring_guide-beanmapping-spring.asciidoc_bean-mapper-configuration-using-dozer">Bean-Mapper Configuration using Dozer</h8>
<div class="paragraph">
<p>The <code>BeanMapper</code> implementation is based on an existing open-source bean-mapping framework.
In case of Dozer the mapping is configured <code>src/main/resources/config/app/common/dozer-mapping.xml</code>.</p>
</div>
<div class="paragraph">
<p>See the my-thai-star <a href="https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/resources/config/app/common/dozer-mapping.xml">dozer-mapping.xml</a> as an example.
Important is that you configure all your custom datatypes as <code>&lt;copy-by-reference&gt;</code> tags and have the mapping from <code>PersistenceEntity</code> (<code>ApplicationPersistenceEntity</code>) to <code>AbstractEto</code> configured properly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;mapping type="one-way"&gt;
    &lt;class-a&gt;com.devonfw.module.basic.common.api.entity.PersistenceEntity&lt;/class-a&gt;
    &lt;class-b&gt;com.devonfw.module.basic.common.api.to.AbstractEto&lt;/class-b&gt;
    &lt;field custom-converter="com.devonfw.module.beanmapping.common.impl.dozer.IdentityConverter"&gt;
      &lt;a&gt;this&lt;/a&gt;
      &lt;b is-accessible="true"&gt;persistentEntity&lt;/b&gt;
    &lt;/field&gt;
&lt;/mapping&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_spring_guide-beanmapping-spring.asciidoc_bean-mapper-configuration-using-orika">Bean-Mapper Configuration using Orika</h7>
<div class="paragraph">
<p>Orika with devonfw is configured by default and sets some custom mappings for <em>GenericEntity.java</em> to <em>GenericEntityDto.java</em>. To specify and customize the mappings you can create the class <em>BeansOrikaConfig.java</em> that extends the class <em>BaseOrikaConfig.java</em> from the <strong>devon4j.orika</strong> package. To register a basic mapping, register a <strong>ClassMap</strong> for the <strong>mapperFactory</strong> with your custom mapping. Watch the example below and follow the <a href="https://orika-mapper.github.io/orika-docs/mappings-via-classmapbuilder.html">basic Orika mapping configuration guide</a> and the <a href="https://orika-mapper.github.io/orika-docs/advanced-mappings.html">Orika advanced mapping guide</a>.</p>
</div>
<div class="paragraph">
<p>Register Mappings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">mapperFactory.classMap(UserEntity.class, UserEto.class)
			.field("email", "email")
			.field("username", "name")
			.byDefault()
			.register();</code></pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_spring_guide-beanmapping-spring.asciidoc_bean-mapper-usage">Bean-Mapper Usage</h7>
<div class="paragraph">
<p>Then we can get the <code>BeanMapper</code> via <a href="#devonfw-guide_devon4j.wiki_spring_guide-dependency-injection.asciidoc">dependency-injection</a> what we typically already provide by an abstract base class (e.g. <code>AbstractUc</code>). Now we can solve our problem very easy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...
UserEntity resultEntity = ...;
...
return getBeanMapper().map(resultEntity, UserEto.class);</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-datatype.asciidoc">Datatypes</h6>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A datatype is an object representing a value of a specific type with the following aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It has a technical or business specific semantic.</p>
</li>
<li>
<p>Its JavaDoc explains the meaning and semantic of the value.</p>
</li>
<li>
<p>It is immutable and therefore stateless (its value assigned at construction time and can not be modified).</p>
</li>
<li>
<p>It is serializable.</p>
</li>
<li>
<p>It properly implements #equals(Object) and #hashCode() (two different instances with the same value are equal and have the same hash).</p>
</li>
<li>
<p>It shall ensure syntactical validation so it is NOT possible to create an instance with an invalid value.</p>
</li>
<li>
<p>It is responsible for formatting its value to a string representation suitable for sinks such as UI, loggers, etc. Also consider cases like a Datatype representing a password where toString() should return something like "<strong><strong></strong></strong>**" instead of the actual password to prevent security accidents.</p>
</li>
<li>
<p>It is responsible for parsing the value from other representations such as a string (as needed).</p>
</li>
<li>
<p>It shall provide required logical operations on the value to prevent redundancies. Due to the immutable attribute all manipulative operations have to return a new Datatype instance (see e.g. BigDecimal.add(java.math.BigDecimal)).</p>
</li>
<li>
<p>It should implement Comparable if a natural order is defined.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Based on the Datatype a presentation layer can decide how to view and how to edit the value. Therefore a structured data model should make use of custom datatypes in order to be expressive.
Common generic datatypes are String, Boolean, Number and its subclasses, Currency, etc.
Please note that both Date and Calendar are mutable and have very confusing APIs. Therefore, use JSR-310 or jodatime instead.
Even if a datatype is technically nothing but a String or a Number but logically something special it is worth to define it as a dedicated datatype class already for the purpose of having a central javadoc to explain it. On the other side avoid to introduce technical datatypes like String32 for a String with a maximum length of 32 characters as this is not adding value in the sense of a real Datatype.
It is suitable and in most cases also recommended to use the class implementing the datatype as API omitting a dedicated interface.</p>
</div>
</blockquote>
<div class="attribution">
— mmm project<br>
<cite>datatype javadoc</cite>
</div>
</div>
<div class="paragraph">
<p>See <a href="http://m-m-m.sourceforge.net/apidocs/net/sf/mmm/util/lang/api/Datatype.html">mmm datatype javadoc</a>.</p>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-datatype.asciidoc_datatype-packaging">Datatype Packaging</h7>
<div class="paragraph">
<p>For the devonfw we use a common <a href="#devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_packages">packaging schema</a>.
The specifics for datatypes are as following:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Segment</strong></th>
<th class="tableblock halign-left valign-top"><strong>Value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Explanation</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;component&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Here we use the (business) component defining the datatype or general for generic datatypes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;layer&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">common</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Datatypes are used across all layers and are not assigned to a dedicated layer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;scope&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">api</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Datatypes are always used directly as API even tough they may contain (simple) implementation logic. Most datatypes are simple wrappers for generic Java types (e.g. String) but make these explicit and might add some validation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-datatype.asciidoc_technical-concerns">Technical Concerns</h7>
<div class="paragraph">
<p>Many technologies like Dozer and QueryDSL’s (alias API) are heavily based on reflection. For them to work properly with custom datatypes, the frameworks must be able to instantiate custom datatypes with no-argument constructors. It is therefore recommended to implement a no-argument constructor for each datatype of at least protected visibility.</p>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-datatype.asciidoc_datatypes-in-entities">Datatypes in Entities</h7>
<div class="paragraph">
<p>The usage of custom datatypes in entities is explained in the <a href="#devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entities-and-datatypes">persistence layer guide</a>.</p>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-datatype.asciidoc_datatypes-in-transfer-objects">Datatypes in Transfer-Objects</h7>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-datatype.asciidoc_xml">XML</h8>
<div class="paragraph">
<p>For mapping datatypes with JAXB see <a href="#devonfw-guide_devon4j.wiki_guide-xml.asciidoc">XML guide</a>.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-datatype.asciidoc_json">JSON</h8>
<div class="paragraph">
<p>For mapping datatypes from and to JSON see <a href="#devonfw-guide_devon4j.wiki_guide-json.asciidoc_json-custom-mapping">JSON custom mapping</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_spring_guide-cors-spring.asciidoc">CORS configuration in Spring</h6>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_spring_guide-cors-spring.asciidoc_dependency">Dependency</h7>
<div class="paragraph">
<p>To enable the CORS support from the server side for your devon4j-Spring application, add the below dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.devonfw.java.starters&lt;/groupId&gt;
  &lt;artifactId&gt;devon4j-starter-security-cors&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_spring_guide-cors-spring.asciidoc_configuration">Configuration</h7>
<div class="paragraph">
<p>Add the below properties in your application.properties file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>#CORS support
security.cors.spring.allowCredentials=true
security.cors.spring.allowedOriginPatterns=*
security.cors.spring.allowedHeaders=*
security.cors.spring.allowedMethods=OPTIONS,HEAD,GET,PUT,POST,DELETE,PATCH
security.cors.pathPattern=/**</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">HTTP Header</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">allowCredentials</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides the browser should include any cookies associated with the request (<code>true</code> if cookies should be included).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access-Control-Allow-Credentials</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">allowedOrigins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of allowed origins (use <code>*</code> to allow all orgins).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access-Control-Allow-Origin</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">allowedMethods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of allowed HTTP request methods (<code>OPTIONS</code>, <code>HEAD</code>, <code>GET</code>, <code>PUT</code>, <code>POST</code>, <code>DELETE</code>, <code>PATCH</code>, etc.).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">allowedHeaders</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of allowed headers that can be used during the request (use <code>*</code> to allow all headers requested by the client)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access-Control-Allow-Headers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pathPattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ant-style pattern for the URL paths where to apply CORS. Use "/**" to match all URL paths.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-microservice.asciidoc">Microservices in devonfw</h6>
<div class="paragraph">
<p>The Microservices architecture is an approach for application development based on a series of <em>small</em> services grouped under a business domain. Each individual service runs autonomously and communicating with each other through their APIs. That independence between the different services allows to manage (upgrade, fix, deploy, etc.) each one without affecting the rest of the system’s services. In addition to that the microservices architecture allows to scale specific services when facing an increment of the requests, so the applications based on microservices are more flexible and stable, and can be adapted quickly to demand changes.</p>
</div>
<div class="paragraph">
<p>However, this new approach, developing apps based on microservices, presents some downsides.</p>
</div>
<div class="paragraph">
<p>Let’s see the main challenges when working with microservices:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Having the applications divided in different services we will need a component (router) to redirect each request to the related microservice. These redirection rules must implement filters to guarantee a proper functionality.</p>
</li>
<li>
<p>In order to manage correctly the routing process, the application will also need a catalog with all the microservices and its details: IPs and ports of each of the deployed instances of each microservice, the state of each instance and some other related information. This catalog is called <em>Service Discovery</em>.</p>
</li>
<li>
<p>With all the information of the <em>Service Discovery</em> the application will need to calculate and select between all the available instances of a microservice which is the suitable one. This will be figured out by the library <em>Client Side Load Balancer</em>.</p>
</li>
<li>
<p>The different microservices will be likely interconnected with each other, that means that in case of failure of one of the microservices involved in a process, the application must implement a mechanism to avoid the error propagation through the rest of the services and provide an alternative as a process result. To solve this, the pattern <em>Circuit Breaker</em> can be implemented in the calls between microservices.</p>
</li>
<li>
<p>As we have mentioned, the microservices will exchange calls and information with each other so our applications will need to provide a secured context to avoid not allowed operations or intrusions. In addition, since microservices must be able to operate in an isolated way, it is not recommended to maintain a session. To meet this need without using Spring sessions, a token-based authentication is used that exchanges information using the <a href="https://jwt.io/">json web token (JWT)</a> protocol.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition to all of this we will find other issues related to this particular architecture that we will address fitting the requirements of each project.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Distributed data bases: each instance of a microservice should have only one data base.</p>
</li>
<li>
<p>Centralized logs: each instance of a microservice creates a log and a trace that should be centralized to allow an easier way to read all that information.</p>
</li>
<li>
<p>Centralized configuration: each microservice has its own configuration, so our applications should group all those configurations in only one place to ease the configuration management.</p>
</li>
<li>
<p>Automatized deployments: as we are managing several components (microservices, catalogs, balancers, etc.) the deployment should be automatized to avoid errors and ease this process.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To address the above, devonfw microservices has an alternative approach <a href="#devonfw-guide_devon4j.wiki_alternative-microservice-netflix.asciidoc">Microservices based on Netflix-Tools</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-caching.asciidoc">Caching</h6>
<div class="paragraph">
<p>Caching is a technical approach to improve performance. While it may appear easy on the first sight it is an advanced topic. In general, try to use caching only when required for performance reasons. If you come to the point that you need caching first think about:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What to cache?<br>
Be sure about what you want to cache. Is it static data? How often will it change? What will happen if the data changes but due to caching you might receive "old" values? Can this be tolerated? For how long? This is not a technical question but a business requirement.</p>
</li>
<li>
<p>Where to cache?<br>
Will you cache data on client or server? Where exactly?</p>
</li>
<li>
<p>How to cache?<br>
Is a local cache sufficient or do you need a shared cache?</p>
</li>
</ul>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-caching.asciidoc_local-cache">Local Cache</h7>

</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-caching.asciidoc_shared-cache">Shared Cache</h7>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-caching.asciidoc_distributed-cache">Distributed Cache</h8>

</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-caching.asciidoc_products">Products</h7>
<div class="ulist">
<ul>
<li>
<p><a href="http://ehcache.org/" class="bare">http://ehcache.org/</a></p>
</li>
<li>
<p><a href="http://hazelcast.org/" class="bare">http://hazelcast.org/</a></p>
</li>
<li>
<p><a href="http://terracotta.org/" class="bare">http://terracotta.org/</a></p>
</li>
<li>
<p><a href="http://memcached.org/" class="bare">http://memcached.org/</a></p>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-caching.asciidoc_caching-of-web-resources">Caching of Web-Resources</h7>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.mobify.com/blog/beginners-guide-to-http-cache-headers/" class="bare">http://www.mobify.com/blog/beginners-guide-to-http-cache-headers/</a></p>
</li>
<li>
<p><a href="http://en.wikipedia.org/wiki/Web_cache#Cache_control" class="bare">http://en.wikipedia.org/wiki/Web_cache#Cache_control</a></p>
</li>
<li>
<p><a href="http://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Avoiding_caching" class="bare">http://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Avoiding_caching</a></p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-feature-toggle.asciidoc">Feature-Toggles</h6>
<div class="paragraph">
<p>The most software developing teams use Feature-Branching to be able to work in parallel and maintain a stable main branch in the VCS. However Feature-Branching might not be the ideal tool in every case because of big merges and isolation between development groups. In many cases, Feature-Toggles can avoid some of these problems, so these should definitely be considered to be used in the collaborative software development.</p>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-feature-toggle.asciidoc_implementation-with-the-devonfw">Implementation with the devonfw</h7>
<div class="paragraph">
<p>To use Feature-Toggles with the devonfw, use the Framework <a href="http://www.togglz.org/">Togglz</a> because it has all the features generally needed and provides a great documentation.</p>
</div>
<div class="paragraph">
<p>For a pretty minimal working example, also see <a href="https://github.com/florianluediger/oasp4j">this fork</a>.</p>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-feature-toggle.asciidoc_preparation">Preparation</h8>
<div class="paragraph">
<p>The following example takes place in the <code>oasp-sample-core</code> project, so the necessary dependencies have to be added to the according <code>pom.xml</code> file. Required are the main Togglz project including Spring support, the Togglz console to graphically change the feature state and the Spring security package to handle authentication for the Togglz console.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;!-- Feature-Toggle-Framework togglz --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.togglz&lt;/groupId&gt;
  &lt;artifactId&gt;togglz-spring-boot-starter&lt;/artifactId&gt;
  &lt;version&gt;2.3.0.RC2&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
  &lt;groupId&gt;org.togglz&lt;/groupId&gt;
  &lt;artifactId&gt;togglz-console&lt;/artifactId&gt;
  &lt;version&gt;2.3.0.RC2&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
  &lt;groupId&gt;org.togglz&lt;/groupId&gt;
  &lt;artifactId&gt;togglz-spring-security&lt;/artifactId&gt;
  &lt;version&gt;2.3.0.RC2&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to that, the following lines have to be included in the spring configuration file <code>application.properties</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code># configuration for the togglz Feature-Toggle-Framework
togglz.enabled=true
togglz.console.secured=false</code></pre>
</div>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-feature-toggle.asciidoc_small-features">Small features</h8>
<div class="paragraph">
<p>For small features, a simple query of the toggle state is often enough to achieve the desired functionality. To illustrate this, a simple example follows, which implements a toggle to limit the page size returned by the staffmanagement. See <a href="https://github.com/florianluediger/oasp4j/commit/e55c3c7cfcb42efe4f279dc673cced730abd580a">here</a> for further details.</p>
</div>
<div class="paragraph">
<p>This is the current implementation to <em>toggle</em> the feature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// Uncomment next line in order to limit the maximum page size for the staff member search
// criteria.limitMaximumPageSize(MAXIMUM_HIT_LIMIT);</code></pre>
</div>
</div>
<div class="paragraph">
<p>To realise this more elegantly with Togglz, first an enum is required to configure the feature-toggle.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public enum StaffmanagementFeatures implements Feature {
  @Label("Limit the maximum page size for the staff members")
  LIMIT_STAFF_PAGE_SIZE;

  public boolean isActive() {
    return FeatureContext.getFeatureManager().isActive(this);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To familiarize the Spring framework with the enum, add the following entry to the <code>application.properties</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>togglz.feature-enums=io.oasp.gastronomy.restaurant.staffmanagement.featuremanager.StaffmanagementFeatures</code></pre>
</div>
</div>
<div class="paragraph">
<p>After that, the toggle can be used easily by calling the <code>isActive()</code> method of the enum.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">if (StaffmanagementFeatures.LIMIT_STAFF_PAGE_SIZE.isActive()) {
  criteria.limitMaximumPageSize(MAXIMUM_HIT_LIMIT);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This way, you can easily switch the feature on or off by using the administration console at <a href="http://localhost:8081/devon4j-sample-server/togglz-console" class="bare">http://localhost:8081/devon4j-sample-server/togglz-console</a>. If you are getting redirected to the login page, just sign in with any valid user (eg. admin).</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-feature-toggle.asciidoc_extensive-features">Extensive features</h8>
<div class="paragraph">
<p>When implementing extensive features, you might want to consider using the strategy design pattern to maintain the overview of your software. The following example is an implementation of a feature which adds a 25% discount to all products managed by the offermanagement.</p>
</div>
<div class="olist arabic">
<div class="title">Therefore there are two strategies needed:</div>
<ol class="arabic">
<li>
<p>Return the offers with the normal price</p>
</li>
<li>
<p>Return the offers with a 25% discount</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The implementation is pretty straight forward so use this as a reference. Compare <a href="https://github.com/florianluediger/oasp4j/commit/8f43f788d3a4a61b6b003c22a8b6c0d3f2254d14">this</a> for further details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Override
@RolesAllowed(PermissionConstants.FIND_OFFER)
public PaginatedListTo&lt;OfferEto&gt; findOfferEtos(OfferSearchCriteriaTo criteria) {
  criteria.limitMaximumPageSize(MAXIMUM_HIT_LIMIT);
  PaginatedListTo&lt;OfferEntity&gt; offers = getOfferDao().findOffers(criteria);


  if (OffermanagementFeatures.DISCOUNT.isActive()) {
    return getOfferEtosDiscount(offers);
  } else {
    return getOfferEtosNormalPrice(offers);
  }

}


// Strategy 1: Return the OfferEtos with the normal price
private PaginatedListTo&lt;OfferEto&gt; getOfferEtosNormalPrice(PaginatedListTo&lt;OfferEntity&gt; offers) {
  return mapPaginatedEntityList(offers, OfferEto.class);
}

// Strategy 2: Return the OfferEtos with the new, discounted price
private PaginatedListTo&lt;OfferEto&gt; getOfferEtosDiscount(PaginatedListTo&lt;OfferEntity&gt; offers) {
  offers = addDiscountToOffers(offers);
  return mapPaginatedEntityList(offers, OfferEto.class);
}

private PaginatedListTo&lt;OfferEntity&gt; addDiscountToOffers(PaginatedListTo&lt;OfferEntity&gt; offers) {
  for (OfferEntity oe : offers.getResult()) {
    Double oldPrice = oe.getPrice().getValue().doubleValue();

    // calculate the new price and round it to two decimal places
    BigDecimal newPrice = new BigDecimal(oldPrice * 0.75);
    newPrice = newPrice.setScale(2, RoundingMode.HALF_UP);

    oe.setPrice(new Money(newPrice));
  }

  return offers;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-feature-toggle.asciidoc_guidelines-for-a-successful-use-of-feature-toggles">Guidelines for a successful use of feature-toggles</h7>
<div class="paragraph">
<p>The use of feature-toggles requires a specified set of guidelines to maintain the overview on the software. The following is a collection of considerations and examples for conventions that are reasonable to use.</p>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-feature-toggle.asciidoc_minimize-the-number-of-toggles">Minimize the number of toggles</h8>
<div class="paragraph">
<p>When using too many toggles at the same time, it is hard to maintain a good overview of the system and things like finding bugs are getting much harder. Additionally, the management of toggles in the configuration interface gets more difficult due to the amount of toggles.</p>
</div>
<div class="paragraph">
<p>To prevent toggles from piling up during development, a toggle and the associated obsolete source code should be removed after the completion of the corresponding feature. In addition to that, the existing toggles should be revisited periodically to verify that these are still needed and therefore remove legacy toggles.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-feature-toggle.asciidoc_consistent-naming-scheme">Consistent naming scheme</h8>
<div class="paragraph">
<p>A consistent naming scheme is the key to a structured and easily maintainable set of features. This should include the naming of toggles in the source code and the appropriate naming of commit messages in the VCS. The following section contains an example for a useful naming scheme including a small example.</p>
</div>
<div class="paragraph">
<p>Every Feature-Toggle in the system has to get its own unique name without repeating any names of features, which were removed from the system. The chosen names should be descriptive names to simplify the association between toggles and their purpose. If the feature should be split into multiple sub-features, you might want to name the feature like the parent feature with a describing addition. If for example you want to split the <code>DISCOUNT</code> feature into the logic and the UI part, you might want to name the sub-features <code>DISCOUNT_LOGIC</code> and <code>DISCOUNT_UI</code>.</p>
</div>
<div class="paragraph">
<p>The entry in the togglz configuration enum should be named identically to the aforementioned feature name. The explicitness of feature names prevents a confusion between toggles due to using multiple enums.</p>
</div>
<div class="paragraph">
<p>Commit messages are very important for the use of feature-toggles and also should follow a predefined naming scheme. You might want to state the feature name at the beginning of the message, followed by the actual message, describing what the commit changes to the feature. An example commit message could look like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>DISCOUNT: Add the feature-toggle to the offermanagement implementation.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Mentioning the feature name in the commit message has the advantage, that you can search your git log for the feature name and get every commit belonging to the feature. An example for this using the tool <em>grep</em> could look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ git log | grep -C 4 DISCOUNT

commit 034669a48208cb946cc6ba8a258bdab586929dd9
Author: Florian Luediger &lt;florian.luediger@somemail.com&gt;
Date:   Thu Jul 7 13:04:37 2016 +0100

DISCOUNT: Add the feature-toggle to the offermanagement implementation.</code></pre>
</div>
</div>
<div class="paragraph">
<p>To keep track of all the features in your software system, a platform like GitHub offers issues. When creating an issue for every feature, you can retrace, who created the feature and who is assigned to completing its development. When referencing the issue from commits, you also have links to all the relevant commits from the issue view.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-feature-toggle.asciidoc_placement-of-toggle-points">Placement of toggle points</h8>
<div class="paragraph">
<p>To maintain a clean codebase, you definitely want to avoid using the same toggle in different places in the software. There should be one single query of the toggle which should be able to toggle the whole functionality of the feature. If one single toggle point is not enough to switch the whole feature on or off, you might want to think about splitting the feature into multiple ones.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-feature-toggle.asciidoc_use-of-fine-grained-features">Use of fine-grained features</h8>
<div class="paragraph">
<p>Bigger features in general should be split into multiple sub-features to maintain the overview on the codebase. These sub-features get their own feature-toggle and get implemented independently.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-accessibility.asciidoc">Accessibility</h6>
<div class="paragraph">
<p>TODO</p>
</div>
<div class="paragraph">
<p><a href="http://www.w3.org/TR/WCAG20/" class="bare">http://www.w3.org/TR/WCAG20/</a></p>
</div>
<div class="paragraph">
<p><a href="http://www.w3.org/WAI/intro/aria" class="bare">http://www.w3.org/WAI/intro/aria</a></p>
</div>
<div class="paragraph">
<p><a href="http://www.einfach-fuer-alle.de/artikel/bitv/" class="bare">http://www.einfach-fuer-alle.de/artikel/bitv/</a></p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
devon4j-kafka has been abandoned. Its main feature was the implementation of a retry pattern using multiple topics. This implementation has become an integral part of Spring Kafka. We recommend to use Spring Kafkas own implemenation for retries.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-kafka.asciidoc">Messaging Services</h6>
<div class="paragraph">
<p>Messaging Services provide an asynchronous communication mechanism between applications. Technically this is implemented using <a href="http://kafka.apache.org/documentation.html">Apache Kafka</a> .</p>
</div>
<div class="paragraph">
<p>For <a href="#devonfw-guide_devon4j.wiki_spring.asciidoc">spring</a>, devonfw uses <a href="#devonfw-guide/devon4j.wiki_https://spring.io/projects/spring-kafka">Spring-Kafka</a> as kafka framework.
For more details, check the <a href="#devonfw-guide_devon4j.wiki_spring_guide-kafka-spring.asciidoc">devon4j-kafka</a>.</p>
</div>
<div class="paragraph">
<p>For <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus.asciidoc">quarkus</a>, follow <a href="https://quarkus.io/guides/kafka">Quarkus - Kafka Reference Guide</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-jms.asciidoc">Messaging</h6>
<div class="paragraph">
<p>Messaging in Java is done using the <a href="https://en.wikipedia.org/wiki/Java_Message_Service">JMS</a> standard from JEE.</p>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-jms.asciidoc_products">Products</h7>
<div class="paragraph">
<p>For messaging you need to choose a JMS provider such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.rabbitmq.com/">RabbitMQ</a></p>
</li>
<li>
<p><a href="https://activemq.apache.org">ActiveMQ</a></p>
</li>
<li>
<p><a href="#devonfw-guide_devon4j.wiki_guide-oracle.asciidoc_messaging">Oracle Advanced Queuing</a> (esp. if you already use <a href="#devonfw-guide_devon4j.wiki_guide-oracle.asciidoc">Oracle RDBMS</a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-jms.asciidoc_receiver">Receiver</h7>
<div class="paragraph">
<p>As a receiver of messages is receiving data from other systems it is located in the <a href="#devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc">service-layer</a>.</p>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_guide-jms.asciidoc_jms-listener">JMS Listener</h8>
<div class="paragraph">
<p>A <code>JmsListener</code> is a class listening and consuming JMS messages. It should carry the suffix <code>JmsListener</code> and implement the <code>MessageListener</code> interface or have its listener method annotated with <code>@JmsListener</code>. This is illustrated by the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Named
@Transactional
public class BookingJmsListener /* implements MessageListener */ {

  @Inject
  private Bookingmanagement bookingmanagement;

  @Inject
  private MessageConverter messageConverter;

  @JmsListener(destination = "BOOKING_QUEUE", containerFactory = "jmsListenerContainerFactory")
  public void onMessage(Message message) {
    try {
      BookingTo bookingTo = (BookingTo) this.messageConverter.fromMessage(message);
      this.bookingmanagement.importBooking(bookingTo);
    } catch (MessageConversionException | JMSException e) {
      throw new InvalidMessageException(message);
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-jms.asciidoc_sender">Sender</h7>
<div class="paragraph">
<p>The sending of JMS messages is considered as any other sending of data like <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-kafka.asciidoc">kafka</a> messages or RPC calls via <a href="#devonfw-guide_devon4j.wiki_guide-rest.asciidoc">REST</a> using <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-service-client.asciidoc">service-client</a>, gRPC, etc.
This will typically happen directly from a <a href="#devonfw-guide_devon4j.wiki_guide-usecase.asciidoc">use-case</a> in the <a href="#devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc">logic-layer</a>.
However, the technical complexity of the communication and protocols itself shall be hidden from the use-case and not be part of the logic layer.
With spring we can simply use <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/jms/core/JmsTemplate.html">JmsTemplate</a> to do that.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-text-search.asciidoc">Full Text Search</h6>
<div class="paragraph">
<p>If you want to all your users fast and simple searches with just a single search field (like in google), you need full text indexing and search support.</p>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-text-search.asciidoc_solutions">Solutions</h7>
<div class="ulist">
<ul>
<li>
<p><a href="http://lucene.apache.org/">Lucene</a></p>
</li>
<li>
<p><a href="https://lucene.apache.org/core/4_4_0/analyzers-common/org/apache/lucene/analysis/ngram/NGramTokenizer.html">NGram</a></p>
</li>
<li>
<p><a href="http://lucene.apache.org/solr/">Solr</a></p>
</li>
<li>
<p><a href="https://www.elastic.co/products/elasticsearch">elastic-search</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Maybe you also want to use native features of your database</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://blogs.sap.com/2012/10/10/the-not-so-fuzzy-fuzzy-search/">SAP Hana Fuzzy Search</a></p>
</li>
<li>
<p><a href="https://www.oracle.com/technetwork/database/enterprise-edition/index-098492.html">Oracle Text</a></p>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-text-search.asciidoc_best-practices">Best Practices</h7>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4j.wiki_devon4j.asciidoc_tutorials">Tutorials</h5>
<!-- toc disabled -->
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_tutorial-newapp.asciidoc">Creating a new application</h6>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_tutorial-newapp.asciidoc_running-the-archetype">Running the archetype</h7>
<div class="paragraph">
<p>In order to create a new application you must use the archetype provided by devon4j which uses the maven archetype functionality.</p>
</div>
<div class="paragraph">
<p>To create a new application, you should have installed devonfw IDE. Follow the devon ide documentation to install
the same.
You can choose between 2 alternatives, create it from command line or, in more visual manner, within eclipse.</p>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_tutorial-newapp.asciidoc_from-command-line">From command Line</h8>
<div class="paragraph">
<p>To create a new devon4j application from command line, you can simply run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">devon java create com.example.application.sampleapp</code></pre>
</div>
</div>
<div class="paragraph">
<p>For low-level creation you can also manually call this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">mvn -DarchetypeVersion=${devon4j.version} -DarchetypeGroupId=com.devonfw.java.templates -DarchetypeArtifactId=devon4j-template-server archetype:generate -DgroupId=com.example.application -DartifactId=sampleapp -Dversion=1.0.0-SNAPSHOT -Dpackage=com.devonfw.application.sampleapp</code></pre>
</div>
</div>
<div class="paragraph">
<p>Attention: The <code>archetypeVersion</code> (first argument) should be set to the latest version of <code>devon4j</code>. You can easily determine the version from this badge:
<span class="image"><img src="https://javadoc.io/badge2/com.devonfw.java.modules/devon4j-basic/javadoc.svg" alt="latest devon4j version"></span></p>
</div>
<div class="paragraph">
<p>Further providing additional properties (using <code>-D</code> parameter) you can customize the generated app:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 31. Options for app template</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>property</strong></th>
<th class="tableblock halign-left valign-top"><strong>comment</strong></th>
<th class="tableblock halign-left valign-top"><strong>example</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dbType</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Choose the type of RDBMS to use (<code>hana</code>, <code>oracle</code>, <code>mssql</code>, <code>postgresql</code>, <code>mariadb</code>, <code>mysql</code>, etc.)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-DdbTpye=postgresql</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>batch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Option to add an <code>batch</code> module</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-Dbatch=batch</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_tutorial-newapp.asciidoc_from-eclipse">From Eclipse</h8>
<div class="literalblock">
<div class="content">
<pre>After that, you should follow this Eclipse steps to create your application:</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a new Maven Project.</p>
</li>
<li>
<p>Choose the devon4j-template-server archetype, just like the image.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/eclipse-m2e-create-devon4j-project.png" alt="Select archetype">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Fill the Group Id, Artifact Id, Version and Package for your project.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/eclipse-m2e-create-devon4j-project-parameters.png" alt="Configure archetype">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Finish the Eclipse assistant and you are ready to start your project.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_tutorial-newapp.asciidoc_what-is-generated">What is generated</h7>
<div class="paragraph">
<p>The application template (archetype) generates a Maven multi-module project. It has the following modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>api</code>: module with the API (REST service interfaces, transferobjects, datatypes, etc.) to be imported by other apps as a maven dependency in order to invoke and consume the offered (micro)services.</p>
</li>
<li>
<p><code>core</code>: maven module containing the core of the application.</p>
</li>
<li>
<p><code>batch</code>: optional module for <a href="#devonfw-guide_devon4j.wiki_guide-batch-layer.asciidoc">batch</a>(es)</p>
</li>
<li>
<p><code>server</code>: module that bundles the entire app (<code>core</code> with optional <code>batch</code>) as a WAR file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The toplevel <code>pom.xml</code> of the generated project has the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Properties definition: Spring-boot version, Java version, etc.</p>
</li>
<li>
<p>Modules definition for the modules (described above)</p>
</li>
<li>
<p>Dependency management: define versions for dependencies of the technology stack that are recommended and work together in a compatible way.</p>
</li>
<li>
<p>Maven plugins with desired versions and configuration</p>
</li>
<li>
<p>Profiles for <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-testing.asciidoc">test stages</a></p>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_tutorial-newapp.asciidoc_how-to-run-your-app">How to run your app</h7>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_tutorial-newapp.asciidoc_run-app-from-ide">Run app from IDE</h8>
<div class="paragraph">
<p>To run your application from your favourite IDE, simply launch <code>SpringBootApp</code> as java application.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_tutorial-newapp.asciidoc_run-app-as-bootified-jar-or-war">Run app as bootified jar or war</h8>
<div class="paragraph">
<p>More details are available <a href="#devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc_deployment">here</a>.</p>
</div>
<!-- toc disabled -->
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4j.wiki_quarkus.asciidoc">Quarkus</h4>
<div class="paragraph">
<p><a href="https://quarkus.io">Quarkus</a> is a Java framework for building cloud-native apps.
It is fully supported by <a href="https://devonfw.com">devonfw</a> as an option and alternative to <a href="#devonfw-guide_devon4j.wiki_spring.asciidoc">spring</a>.
Additional things like extensions will be available on the  <a href="https://github.com/devonfw/devon4quarkus">devon4quarkus</a> GitHub repository.</p>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4j.wiki_quarkus.asciidoc_guide-to-the-reader">Guide to the Reader</h5>
<div class="paragraph">
<p>Depending on your intention of reading this document, you might be more interested in the following chapters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you are completely new to Quarkus, you may be interested in the <a href="#devonfw-guide_devon4j.wiki_quarkus.asciidoc_pros">pros</a> and <a href="#devonfw-guide_devon4j.wiki_quarkus.asciidoc_cons">cons</a> of Quarkus. Also, take a look at the <a href="https://quarkus.io">official Quarkus website</a>. You might also be interested in the features that <a href="https://www.graalvm.org/">GraalVM</a> offers.</p>
</li>
<li>
<p>If you are new to devon4j, take a look at devon4j’s recommendations on general best practices. Check out the chapters on <a href="#devonfw-guide_devon4j.wiki_architecture.asciidoc">architecture design</a>, <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-structure-modern.asciidoc">project structuring</a>, and <a href="#devonfw-guide_devon4j.wiki_coding-conventions.asciidoc">coding conventions</a>. Follow the referenced links to explore a topic in more depth.</p>
</li>
<li>
<p>If you are an experienced Spring developer and want to get in touch with Quarkus, read our <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_getting-started-for-spring-developers.asciidoc">Getting started with Quarkus for Spring developers</a> guide.</p>
</li>
<li>
<p>If you’re looking to build your first Quarkus application, the Quarkus website offers some good <a href="https://quarkus.io/get-started/">getting started guides</a>. Also, check out our <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_quarkus-template.asciidoc">Quarkus template guide</a>, which gives you some recommendations on extensions and frameworks to use. It also provides some links to the <a href="https://code.quarkus.io/">Quarkus code generator</a> with preselected configurations you can use to create your application.</p>
</li>
<li>
<p>If you want to have a Quarkus sample application using devon4j recommendations, check out our <a href="https://github.com/devonfw-sample/devon4quarkus-reference">Quarkus reference application</a>.</p>
</li>
<li>
<p>If you have a Spring application and want to migrate it to Quarkus, take a look at our <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-migration-spring-quarkus.asciidoc">migration guide</a>.</p>
</li>
<li>
<p>If you already have some experience with devon4j and Quarkus and need more information on a specific topic, check out our <a href="#devonfw-guide_devon4j.wiki_devon4j.asciidoc_guides">Quarkus guides</a>. If you don’t find what you are looking for there, check out the <a href="#devonfw-guide_devon4j.wiki_devon4j.asciidoc_general">general section</a>. devon4j uses general solutions for Java, so solutions for both Quarkus and Spring are documented there.</p>
</li>
<li>
<p>If you want to learn how to build native images, check out <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_guide-native-image.asciidoc">this guide</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4j.wiki_quarkus.asciidoc_pros_2">Pros</h5>
<div class="paragraph">
<p>Quarkus offers the following benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>fast turn-around cycles for developers</strong><br>
Save changes in your Java code and immediately test the results without restarting or waiting</p>
</li>
<li>
<p><strong>faster start-up and less memory footprint</strong><br>
When building your app as <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_guide-native-image.asciidoc">native-images</a> via <a href="https://www.graalvm.org/">GraalVM</a>, it gets highly optimized. As a result, it starts up lightning fast and consumes much less memory. This is a great advantage for cloud deployment as well as for sustainability. You can find a performance comparison between Spring and Quarkus <a href="#devonfw-guide_devon4j.wiki_performance-comparision-spring-quarkus.asciidoc">here</a>.</p>
</li>
<li>
<p><strong>clean and lean</strong>
As quarkus was born as a cloud-native framework, it is very light-weight and does not carry much history and legacy.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4j.wiki_quarkus.asciidoc_cons_4">Cons</h5>
<div class="paragraph">
<p>Quarkus has the following drawbacks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>less flexible</strong><br>
Quarkus is less flexible compared to <a href="#devonfw-guide_devon4j.wiki_spring.asciidoc">spring</a>, or in other words, it is more biased and coupled to specific implementations. However, the implementations  work and you have less things to choose and worry about. However, in case you want to integrate a specific or custom library, you may hit limitations or lose support for <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_guide-native-image.asciidoc">native-images</a>, especially when that library is based on reflection. Therefore, check your requirements and technology stack early on when making your choice.</p>
</li>
<li>
<p><strong>less established</strong><br>
Since quarkus was born in 2019, it is modern but also less established. It will be easier to get developers for <a href="#devonfw-guide_devon4j.wiki_spring.asciidoc">spring</a>, but we already consider quarkus mature and established enough for building production-ready apps.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc">Quarkus Quickstart</h5>
<div class="paragraph">
<p>This guide serves as a quickstart on how to create a Quarkus app, briefly presenting the key functionalities that Quarkus provides, both for beginners and experienced developers.</p>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc_introduction-to-quarkus">Introduction to Quarkus</h6>
<div class="paragraph">
<p>To get a first introduction to Quarkus, you can read the <a href="#devonfw-guide/devon4j.wiki/quarkus_../quarkus">Quarkus introduction guide</a>. To get a brief overview of where you can find the important Quarkus related guides, follow the chapter <a href="#devonfw-guide/devon4j.wiki/quarkus_../quarkus.asciidoc_guide-to-the-reader">guide to the reader</a>.
Also, see the comparison of the <a href="#devonfw-guide/devon4j.wiki/quarkus_../quarkus.asciidoc_Pros">advantages</a> and <a href="#devonfw-guide/devon4j.wiki/quarkus_../quarkus.asciidoc_cons">disadvantages</a> of a Quarkus application compared to the alternative framework Spring.
This comparison will be supported by our <a href="#devonfw-guide/devon4j.wiki/quarkus_../performance-comparison-spring-quarkus">performance comparison between Spring and Quarkus</a>, which demonstrates the lower resource consumption and startup time of Quarkus applications.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc_installation-of-tools-and-dependencies">Installation of Tools and Dependencies</h6>
<div class="paragraph">
<p>First, we need to install some dependencies and tools before we can start programming. Our tool <a href="https://devonfw.com/website/pages/docs/devonfw-ide-introduction.asciidoc.html">devonfw-ide</a> comes with many development tools for you.
We need to install the following tools for this guide:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maven</p>
</li>
<li>
<p>Java</p>
</li>
<li>
<p>any IDE (devonfw-ide supports Eclipse, Intellij and VScode)</p>
</li>
<li>
<p>Docker</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We recommend installing the devonfw-ide with the tools, but if you already have your system configured and the tools above installed, you can skip to <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc_bootstrap-a-quarkus-project">Bootstrap a Quarkus Project</a>, otherwise we will show you how to set up and update your devonfw-ide.</p>
</div>
<div class="olist arabic">
<div class="title">devonfw-ide</div>
<ol class="arabic">
<li>
<p>Install devonfw-ide<br>
Follow the <a href="https://github.com/devonfw/ide/wiki/setup#setup">Setup</a> to install the devonfw-ide with Java, Maven, Eclipse and VScode.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Command to install Docker<br>
<code>devon docker setup</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Update devonfw-ide<br>
As we are still working on improving devonfw-ide, we recommend to update your already installed devonfw-ide and tools in order to include essential features for cloud development with Quarkus that you could be missing.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Use the commands <code>devon ide update</code>, <code>devon ide update software</code>, and <code>devon ide scripts</code> to update devonfw-ide and all installed software.</p>
</div>
<div class="paragraph">
<p>Go to the main folder under workspaces of the devonfw-ide installation.
We will create the project there.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc_bootstrap-a-quarkus-project">Bootstrap a Quarkus Project</h6>
<div class="paragraph">
<p>Quarkus provides multiple ways to bootstrap a project.
The option to bootstrap a project via the command-line is shown in the Quarkus getting started guide <a href="https://quarkus.io/guides/getting-started#bootstrapping-the-project">Bootstrap the project</a>.
Quarkus also provides a project builder where you can select some extensions, the build tool for your project, and if you want, some starter code.
This will deliver a project skeleton with the configured project dependencies and also contributes the information to compile the application natively. To get some recommendations on starter templates, follow the guide on: <a href="#devonfw-guide_devon4j.wiki_quarkus_guide-template.asciidoc">template recommendations</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By creating a Quarkus project from the command-line or with the project builder, you get a different project structure and have to adapt it to the devon4j conventions shown in the next Chapter.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc_project-structure">Project Structure</h7>
<div class="paragraph">
<p>We provide a recommendation and guideline for a <a href="#devonfw-guide/devon4j.wiki/quarkus_../guide-structure-modern">modern project structure</a> to help organize your project into logically related modules.
In order to comply with the requirements of modern cloud development and microservice architectures, follow the guide and apply the modern project structure to your project. You can also find similar modules in our example projects.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc_introduction-to-quarkus-functionality">Introduction to Quarkus Functionality</h6>
<div class="paragraph">
<p>Before we start programming, you should first have a look at the functionality of Quarkus.</p>
</div>
<div class="olist arabic">
<div class="title">Quarkus functionality guides</div>
<ol class="arabic">
<li>
<p><a href="https://quarkus.io/guides/getting-started">Getting started guide from Quarkus</a><br>
This guide presents a good overview of the functionality of Quarkus. The simple <strong>Greeting Service</strong> gives a brief introduction into concepts like CDI, testing, dev mode, packaging, and running the app.</p>
</li>
<li>
<p>From Spring to Quarkus<br>
For experienced Spring developers that have already followed devon4j guidelines, you can read our guide to <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_getting-started-for-spring-developers.asciidoc">getting started with Quarkus for Spring developer</a>, as it goes more into the differences that can give you a more detailed comparison to Spring.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Migrate a Spring app to Quarkus<br>
This guide shows how to <a href="#devonfw-guide/devon4j.wiki/quarkus_../guide-migration-spring-quarkus">migrate a Spring application to a Quarkus application with devon4j conventions</a>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc_create-a-rest-service">Create a REST service</h6>
<div class="paragraph">
<p>Now let’s create our first REST CRUD service with Quarkus.
We give you the options of using a guide to start to code the service yourself or to just download a service that’s ready to use.</p>
</div>
<div class="olist arabic">
<div class="title">Options</div>
<ol class="arabic">
<li>
<p>Create the service yourself<br>
There is a good Quarkus guide for a simple <a href="https://quarkus.io/guides/rest-json#creating-your-first-json-rest-service">JSON REST service</a> that will guide you through your first application and help you with implement the definition of endpoints with JAX-RS and an Entity that will be managed by the service, and also how to <a href="https://quarkus.io/guides/rest-json#json">configure the JSON support</a>.</p>
</li>
<li>
<p>Use an existing Quarkus project<br>
You don’t want to code a service and just want to test some Quarkus functionalities? Just load a Quarkus <a href="https://github.com/quarkusio/quarkus-quickstarts#quick-start-list">sample project</a> provided for every existing quickstart guide and the supported framework.
Our Team also provides some Quarkus applications that are working and can be loaded and tested.</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw-sample/devon4quarkus-reference">reference project</a> is a service that manages products. It contains the devon4j modern project structure, pagination, queries, a Postgres database, SwaggerUI, and support for Kubernetes deploy. To add OpenTelemetry support, see the following <a href="https://github.com/devonfw-sample/devon4quarkus-reference/blob/master/documentation/opentelemetry-deployment.asciidoc">guide</a>.
This project will be steadily improved and is used to showcase the abilities of Quarkus with devon4j.</p>
</li>
<li>
<p><a href="https://github.com/devonfw-sample/devon4quarkus-minimal">minimal Quarkus project</a> is just the Quarkus project from a <a href="https://quarkus.io/guides/getting-started">getting started with Quarkus</a> guide with a <strong>Greeting Services</strong> modified with the correct modern structure mentioned in the chapter <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc_project-structure">Project Structure</a></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc_openapi-generation">OpenAPI generation</h6>
<div class="paragraph">
<p>We provide a guide with a short introduction to the <a href="#devonfw-guide/devon4j.wiki/quarkus_../guide-openaoi">OpenAPI specification</a> with two plugins that are important in a Quarkus Context.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#devonfw-guide/devon4j.wiki/quarkus_../guide-openaoi.asciidoc_smallrye-openapi">Smallrye Openapi supported by quarkus</a></p>
</li>
<li>
<p><a href="#devonfw-guide/devon4j.wiki/quarkus_../guide-openaoi.asciidoc_servicedocgen-maven-plugin">servicedocgen Maven Plugin</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A more detailed usage guide to the Smallrye Plugin is provided by <a href="https://quarkus.io/guides/openapi-swaggerui">Quarkus OpenAPI and Swagger guide</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc_how-to-integrate-a-database">How to Integrate a Database</h6>
<div class="paragraph">
<p>The next step for our REST service would be to integrate a database to store the objects of the entity.</p>
</div>
<div class="paragraph">
<p>With Quarkus, adding a database can be easy, because Quarkus can take over the build-up and connection process.
First, you should understand our guides on the concepts of working with data. Then, we will show how to integrate a database with Quarkus.</p>
</div>
<div class="olist arabic">
<div class="title">Data Principles Guides</div>
<ol class="arabic">
<li>
<p>General devon4j JPA guide<br>
To get an insight into the general JPA usage, read the <a href="#devonfw-guide/devon4j.wiki/quarkus_../guide-jpa">JPA guide</a> containing a general explanation of the Java Persistence API.</p>
</li>
<li>
<p>Difference to SpringData<br>
If you have already worked with SpringData, this is also partially supported with Quarkus. This is explained in more detail in this <a href="#devonfw-guide/devon4j.wiki/quarkus_../guide-repository">SpringData Guide</a>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Database Integration</div>
<ol class="arabic">
<li>
<p>Quarkus zero config dev mode<br>
Starting with the database implementation in Quarkus, we recommend for beginners to use the <a href="https://quarkus.io/guides/datasource#dev-services">DEV mode Zero Config Setup (Dev Services)</a>. This is especially great for testing the code without a database set up.
Quarkus does all the work for you and configures a database and creates the database and tables (schemas) for you.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Configuration Properties<br>
A list of all database configuration properties for the <a href="https://quarkus.io/guides/datasource#configuring-dev-services">Dev services</a></p>
</li>
</ol>
</div>
</li>
<li>
<p>Integrate a simple Hibernate ORM database<br>
The zero config setup only works with the Dev mode, it’s comfortable in the first phases of the creation of your service but if the goal is to also get a deployable version, you have to create your own database and integrate it.
This Quarkus guide shows, how to integrate a <a href="https://quarkus.io/guides/hibernate-orm">Hibernate ORM database</a> with an example service.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Configuration list for JDBC<br>
A list of all configuration that is possible with a <a href="https://quarkus.io/guides/datasource#jdbc-configuration">JDBC configuration properties</a></p>
</li>
</ol>
</div>
</li>
<li>
<p>Reactive CRUD application with Panache<br>
Quarkus unifies reactive and imperative programming.
Reactive is an architectural principle to build robust, efficient, and concurrent applications.
For an introduction into reactive and how Quarkus enables it, follow this <a href="https://quarkus.io/guides/quarkus-reactive-architecture">Quarkus reactive architecture</a> article and also the <a href="https://quarkus.io/guides/getting-started-reactive">reactive quickstart</a>.
To get started with reactive and implement reactive methods, you can follow the <a href="https://quarkus.io/guides/hibernate-reactive-panache">Quarkus reactive guide</a>.
The reactive guide uses the Quarkus based implementation of a Hibernate ORM called Panache.
The implementation is not our first choice with devon4j and therefore not part of our recommendations, but to understand the reactive guide you can read the <a href="https://quarkus.io/guides/hibernate-orm-panache">Hibernate ORM with Panache guide</a> first to prevent possible problems following the guide.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You need an installed Docker version for the <a href="https://quarkus.io/guides/datasource#dev-services">zero config setup</a>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<div class="title">Database Migration</div>
<p>For schema-based databases, we recommend migrating databases with Flyway.
In that case, our <a href="#devonfw-guide/devon4j.wiki/quarkus_../guide-database-migration">general migration guide</a> can give you an overview if you are not familiar with migration.
.. Flyway guide for Quarkus
This Quarkus guide will show how to work with the <a href="https://quarkus.io/guides/flyway">Flyway extension in a Quarkus application</a>.
This should be used if you start your own database and do not leave the creation to quarkus.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc_testing-a-quarkus-application">Testing a Quarkus Application</h6>
<div class="paragraph">
<p>After we have built the service, we have to verify it with some tests.
We will give you some guidelines to implement some test cases.</p>
</div>
<div class="olist arabic">
<div class="title">Testing Guides</div>
<ol class="arabic">
<li>
<p>General testing guide<br>
For users that aren’t familiar with the devon4j testing principles, we created a general <a href="#devonfw-guide/devon4j.wiki/quarkus_../guide-testing">best practices and recommendations guide for testing</a>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Our guide for testing with Quarkus
In addition, we also provide a guide that specifically addresses the <a href="#devonfw-guide_devon4j.wiki_quarkus_guide-for-testing.asciidoc">testing of a Quarkus application</a>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Most of the Quarkus applications are already equipped with a basic test and our <a href="https://github.com/devonfw-sample/devon4quarkus-reference">reference project</a> provides some further test cases. If you want to improve and extend the tests, you can also follow the large <a href="https://quarkus.io/guides/getting-started-testing">Quarkus guide for testing</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc_packaging-of-a-quarkus-application-and-creation-of-a-native-executable">Packaging of a Quarkus application and creation of a native executable</h6>
<div class="paragraph">
<p>Quarkus applications can be packaged into different file types. The following link will show you how to build them and give you a short explanation of the characteristics of these files.</p>
</div>
<div class="olist arabic">
<div class="title">Package types</div>
<ol class="arabic">
<li>
<p><a href="https://quarkus.io/guides/maven-tooling#fast-jar">fast-jar</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/maven-tooling#remote-development-mode">mutable-jar</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/maven-tooling#uber-jar-maven">uber-jar</a></p>
</li>
<li>
<p><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_guide-native-image.asciidoc">native executable</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To package an application, use the command <code>mvn package</code> and Quarkus will generate the output in the <strong>/target</strong> folder. For the native executables, the command needs more parameters, which is explained in the link above.</p>
</div>
<div class="paragraph">
<p>Configure the Output with these <a href="https://quarkus.io/guides/maven-tooling#configuration-reference">configuration properties</a></p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc_create-and-build-a-docker-image">Create and build a Docker Image</h6>
<div class="paragraph">
<p>Quarkus supports Jib, S2I and <a href="https://www.docker.com/">Docker</a> for building images. We focus on building a Quarkus App with Docker.
You get a generated Dockerfile from Quarkus in the src/main/docker folder of any project generated from Quarkus. There are multiple Dockerfiles.</p>
</div>
<div class="olist arabic">
<div class="title">Dockerfiles</div>
<ol class="arabic">
<li>
<p>Dockerfile.jvm<br>
Dockerfile for Quarkus application in the JVM mode. running in <strong>Red Hat Universal Base Image 8 Minimal Container</strong></p>
</li>
<li>
<p>Dockerfile.legacy-jar<br>
DockerFile for Quarkus application in JVM mode with the legacy jar <strong>running in Red Hat Universal Base Image 8 Minimal Container</strong>.</p>
</li>
<li>
<p>Dockerfile.native<br>
Dockerfile using the native executable running in <strong>Red Hat Universal Base Image 8 Minimal container</strong>.</p>
</li>
<li>
<p>Dockerfile.native-distroless
The native file will run in a <strong>Distroless container</strong>. Distroless images are very small containers with just the application and runtime dependencies and without the other programs that come with a Linux distribution.</p>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>For more information to the different executables go back to the chapter <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_getting-started-quarkus.asciidoc_packaging-of-a-quarkus-application-and-creation-of-a-native-executable">Packaging of a Quarkus application and creation of a native executable</a></p>
</div>
</div>
</div>
<div class="paragraph">
<p>To simply build and run a Docker image, you can follow the instructions Quarkus provides for every Dockerfile in the comments block.</p>
</div>
<div class="paragraph">
<p>Docker commands example for the JVM Dockerfile from our <a href="https://github.com/devonfw-sample/devon4quarkus-reference">reference project</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre>####
# This Dockerfile is used in order to build a container that runs the Quarkus application in JVM mode
#
# Before building the container image run:
#
# ./mvnw package
#
# Then, build the image with:
#
# docker build -f src/main/docker/Dockerfile.jvm -t quarkus/quarkus-basics-jvm .
#
# Then run the container using:
#
# docker run -i --rm -p 8080:8080 quarkus/quarkus-basics-jvm
#
# If you want to include the debug port into your docker image
# you will have to expose the debug port (default 5005) like this :  EXPOSE 8080 5050
#
# Then run the container using :
#
# docker run -i --rm -p 8080:8080 -p 5005:5005 -e JAVA_ENABLE_DEBUG="true" quarkus/quarkus-basics-jvm
#
###</pre>
</div>
</div>
<div class="paragraph">
<p>Quarkus is also able to build the image while packaging the application, so you don’t have to execute the command from above.
To perform Docker builds with the generated Dockerfiles from above, you need to add the following extension to your project with the command <code>mvn quarkus:add-extension -Dextensions="container-image-docker"</code>.</p>
</div>
<div class="paragraph">
<p>You also have to set the <strong>quarkus.container-image.build=true</strong>. You can add this to your <strong>application.properties</strong> or just append it to the packaging command like this: <code>./mvn package -Dquarkus.container-image.build=true</code>.</p>
</div>
<div class="paragraph">
<p>If your needs exceed the instructions given by the file, we recommend to follow the Docker <a href="https://docs.docker.com/get-started/">getting started guide</a> to get familiar with Docker and customize the Dockerfiles according to your needs.
To specify your container build, you can use the <a href="https://quarkus.io/guides/container-image#container-image-options">general container image configurations properties</a> and the <a href="https://quarkus.io/guides/container-image#docker-options">Docker image configurations properties</a> when building and runnig Docker images.</p>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4j.wiki_guide-migration-spring-quarkus.asciidoc">Migrate from Spring to Quarkus</h5>
<div class="paragraph">
<p>This guide will cover the migration process of a Spring application to a Quarkus application. There are already articles about migrating from Spring to Quarkus (e.g. <a href="https://developers.redhat.com/blog/2020/04/10/migrating-a-spring-boot-microservices-application-to-quarkus" class="bare">https://developers.redhat.com/blog/2020/04/10/migrating-a-spring-boot-microservices-application-to-quarkus</a>, <a href="https://dzone.com/articles/migrating-a-spring-boot-application-to-quarkus-cha" class="bare">https://dzone.com/articles/migrating-a-spring-boot-application-to-quarkus-cha</a>).
This guide will focus more on the devon4j specific aspects. We assume that a working Spring application exists, built in the <a href="#devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc">classic devon4j specific way</a> (e.g. <a href="https://github.com/devonfw/jump-the-queue/tree/master/java/jtqj">Jump The Queue</a> or <a href="https://github.com/devonfw/my-thai-star">My Thai Star</a>).</p>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-migration-spring-quarkus.asciidoc_create-the-quarkus-application">Create the Quarkus application</h6>
<div class="paragraph">
<p>We start with an empty Quarkus project. You can create the project with Maven on the command line or use the <a href="https://code.quarkus.io/">online generator</a>. The advantage of the online generator is that you have a pre-selection of dependencies to use in your project.
For starters, let’s select the basic dependencies required to develop a REST service with database connectivity (you can use one of the links in the <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_quarkus-template.asciidoc">Quarkus template guide</a>): <em>RESTEasy JAX-RS, RESTEasy Jackson, Hibernate ORM, Spring Data JPA API, JDBC Driver (choose the type of database you need), Flyway (if you have database migration schemas), SmallRye Health (optional for Health Monitoring)</em></p>
</div>
<div class="paragraph">
<p>The list does not include all required dependencies. We will add more dependencies to the project later. For now, generate the application with these dependencies.</p>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_guide-migration-spring-quarkus.asciidoc_migration-toolkit-from-red-hat">Migration Toolkit from Red Hat</h7>
<div class="paragraph">
<p>Red Hat provides a migration toolkit (<a href="https://developers.redhat.com/products/mta/overview">MTA, Migration Toolkit for Applications</a>), that supports migration of a Spring to a Quarkus application. There are several versions of this toolkit (e.g., a web console, a Maven plugin, or an IDE plugin).
The MTA analyzes your existing application and generates a report with hints and instructions for migrating from Spring to Quarkus. For example, it gives you an indication of which dependencies are not supported in your project for a Quarkus application and which dependencies you need to swap them with. The analysis is rule-based, and you can also add your own rules that will be checked during analysis.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-migration-spring-quarkus.asciidoc_entities">Entities</h6>
<div class="paragraph">
<p>There is nothing special to consider when creating the entities. In most cases, you can simply take the code from your Spring application and use it for your Quarkus application. Usually, the entities extend a superclass <code>ApplicationPersistenceEntity</code> containing, for example, the <code>id</code> property. You can also take this class from your Spring application and reuse it.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-migration-spring-quarkus.asciidoc_transfer-objects">Transfer objects</h6>
<div class="paragraph">
<p>The next step is to create the appropriate transfer objects for the entities. In a devon4j Spring application, we would use CobiGen to create these classes. Since CobiGen is not usable for this purpose in Quarkus applications yet, we have to create the classes manually.</p>
</div>
<div class="paragraph">
<p>First, we create some abstract base classes for the search criteria and DTO classes. Normally, these would also be created by CobiGen.</p>
</div>
<div class="listingblock">
<div class="title">Listing 10. <strong>AbstractSearchCriteriaTo</strong></div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public abstract class AbstractSearchCriteriaTo extends AbstractTo {

  private static final long serialVersionUID = 1L;

  private Pageable pageable;

  //getter + setter for pageable
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 11. <strong>AbstractDto</strong></div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public abstract class AbstractDto extends AbstractTo {

  private static final long serialVersionUID = 1L;

  private Long id;

  private int modificationCounter;

  public AbstractDto() {

    super();
  }

  //getter + setter

  @Override
  protected void toString(StringBuilder buffer) {
    ...
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The class <code>AbstractTo</code>, extended by other classes, would be provided by the <a href="https://github.com/devonfw/devon4j/tree/master/modules/basic"><code>devon4j-basic</code></a> module in a devon4j Spring application. You can take the code from <a href="#devonfw-guide/devon4j.wiki_https://github.com/devonfw/devon4j/blob/master/modules/basic/src/main/java/com/devonfw/module/basic/common/api/to/AbstractTo.java">here</a> and reuse it in your Quarkus project.</p>
</div>
<div class="paragraph">
<p>Now you can create your transfer objects. Most of the code of the transfer objects of your Spring application should be reusable. For Quarkus, we recommend (as mentioned <a href="#devonfw-guide_devon4j.wiki_guide-dto.asciidoc">here</a>) to use <code>*Dto</code> instead of <code>*Eto</code> classes. Be sure to change the names of the classes accordingly.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-migration-spring-quarkus.asciidoc_data-access-layer">Data Access Layer</h6>
<div class="paragraph">
<p>In devon4j, we propose to use <a href="#devonfw-guide_devon4j.wiki_guide-repository.asciidoc">Spring Data JPA</a> to build the data access layer using repositories and Querydsl to build <a href="#devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_dynamic-queries">dynamic queries</a>. We will also use this approach for Quarkus applications, but we need to change the implementation because the devon4j modules are based on reflection, which is not suitable for Quarkus.
In Quarkus we will use Querydsl using code generation. So for this layer, more changes are required and we can’t just take the existing code.</p>
</div>
<div class="paragraph">
<p>First, create a repository interface for your entity class that extends <code>JpaRepository</code> (see <a href="#devonfw-guide_devon4j.wiki_guide-repository.asciidoc_repository">here</a>).</p>
</div>
<div class="paragraph">
<p>To add QueryDSL support to your project, add the following dependencies to your pom.xml file:</p>
</div>
<div class="listingblock">
<div class="title">Listing 12. <strong>pom.xml</strong></div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.querydsl&lt;/groupId&gt;
  &lt;artifactId&gt;querydsl-jpa&lt;/artifactId&gt;
  &lt;version&gt;4.3.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.querydsl&lt;/groupId&gt;
  &lt;artifactId&gt;querydsl-apt&lt;/artifactId&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
  &lt;version&gt;4.3.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>As mentioned above, we will use QueryDSL with code generation. For this, add the QueryDSL annotation processor to your plugins:</p>
</div>
<div class="listingblock">
<div class="title">Listing 13. <strong>pom.xml</strong></div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugins&gt;
...
  &lt;plugin&gt;
    &lt;groupId&gt;com.mysema.maven&lt;/groupId&gt;
    &lt;artifactId&gt;apt-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.1.3&lt;/version&gt;
    &lt;executions&gt;
      &lt;execution&gt;
        &lt;phase&gt;generate-sources&lt;/phase&gt;
        &lt;goals&gt;
          &lt;goal&gt;process&lt;/goal&gt;
        &lt;/goals&gt;
        &lt;configuration&gt;
          &lt;outputDirectory&gt;target/generated-sources/annotations&lt;/outputDirectory&gt;
          &lt;processor&gt;com.querydsl.apt.jpa.JPAAnnotationProcessor&lt;/processor&gt;
        &lt;/configuration&gt;
      &lt;/execution&gt;
    &lt;/executions&gt;
  &lt;/plugin&gt;
&lt;/plugins&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To implement the queries, follow the <a href="#devonfw-guide_devon4j.wiki_guide-jpa-query.asciidoc_dynamic-queries">corresponding guide</a>.</p>
</div>
<div class="paragraph">
<p>Set the following properties in the application.properties file to configure the connection to your database (see also <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc_database-configuration">here</a>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">quarkus.datasource.db-kind=...
quarkus.datasource.jdbc.url=...
quarkus.datasource.username=...
quarkus.datasource.password=...</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-migration-spring-quarkus.asciidoc_logic-layer">Logic Layer</h6>
<div class="paragraph">
<p>For the logic layer, devon4j uses a <a href="#devonfw-guide_devon4j.wiki_guide-usecase.asciidoc">use-case approach</a>. You can reuse the use case interfaces from the api module of the Spring application. Again, make sure to rename the transfer objects.</p>
</div>
<div class="paragraph">
<p>Create the appropriate class that implements the interface. Follow the <a href="#devonfw-guide_devon4j.wiki_guide-usecase.asciidoc_implementation">implementation section</a> of the use-case guide to implement the methods. For mapping the entities to the corresponding transfer objects, see the next section.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-migration-spring-quarkus.asciidoc_mapping">Mapping</h6>
<div class="paragraph">
<p>For bean mapping, we need to use a completely different approach in the Quarkus application than in the Spring application. For Quarkus, we use MapStruct, which creates the mapper at build time rather than at runtime using reflection. Add the following dependencies to your pom.xml.</p>
</div>
<div class="listingblock">
<div class="title">Listing 14. <strong>pom.xml</strong></div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.mapstruct&lt;/groupId&gt;
  &lt;artifactId&gt;mapstruct-processor&lt;/artifactId&gt;
  &lt;version&gt;1.4.2.Final&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.mapstruct&lt;/groupId&gt;
  &lt;artifactId&gt;mapstruct&lt;/artifactId&gt;
  &lt;version&gt;1.4.2.Final&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you can create the mapper as follows:</p>
</div>
<div class="listingblock">
<div class="title">Listing 15. <strong>Mapper</strong></div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Mapper(componentModel = "cdi")
public interface YourEntityMapper {
  YourEntityDto map(YourEntity entity);

  YourEntity map(YourEntityDto dto);

  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Inject the mapper into your use-case implementation and simply use the methods. The method implementations of the mapper are created when the application is built.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-migration-spring-quarkus.asciidoc_service-layer">Service Layer</h6>
<div class="paragraph">
<p>For the implementation of the service layer, we use the <a href="#devonfw-guide_devon4j.wiki_guide-rest.asciidoc_jax-rs">JAX-RS</a> for both Quarkus and Spring applications to create the REST services. Classic devon4j Spring applications rely on Apache CFX as the implemention of JAX-RS.
For Quarkus, we use RESTEasy. Since both are implementations of JAX-RS, much of the Spring application code can be reused.</p>
</div>
<div class="paragraph">
<p>Take the definition of the REST endpoints from the api module of the Spring application (make sure to rename the transfer objects), inject the use-cases from the logic layer and use them in the REST service methods as follows:</p>
</div>
<div class="listingblock">
<div class="title">Listing 16. <strong>REST service</strong></div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Path("/path/v1")
public class YourComponentRestService {

  @Inject
  UcFindYourEntity ucFindYourEntity;

  @Inject
  UcManageYourEntity ucManageYourEntity;

  @GET
  @Path("/yourEntity/{id}/")
  public YourEntityDto getYourEntity(@PathParam("id") long id);

    return this.ucFindYourEntity.findYourEntity(id);
  }

  ...
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-migration-spring-quarkus.asciidoc_summary">Summary</h6>
<div class="paragraph">
<p>As you have seen, some parts hardly differ when migrating a Spring application to a Quarkus application, while other parts differ more. The above sections describe the parts needed for simple applications that provide REST services with a data access layer.
If you add more functionality, more customization and other frameworks, dependencies may be required. If that is the case, take a look at the corresponding guide on the topic in the devon4j documentation or check if there is a tutorial on the official <a href="https://quarkus.io/guides/">Quarkus website</a>.</p>
</div>
<div class="paragraph">
<p>Furthermore, we can summarize that migrating from a Spring application to a Quarkus representative is not complex. Although Quarkus is a very young framework (release 1.0 was in 2019), it brings a lot of proven standards and libraries that you can integrate into your application.
This makes it easy to migrate and reuse code from existing (Spring) applications. Also, Quarkus comes with Spring API compatibility for many Spring modules (<a href="https://quarkus.io/guides/spring-data-jpa">Spring Data JPA</a>, <a href="https://quarkus.io/guides/spring-di">Spring DI</a>, <a href="https://github.com/quarkusio/quarkus/tree/main/extensions">etc.</a>), which makes it easier for developers to reuse their knowledge.</p>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4j.wiki_Spring-native-vs-Quarkus.asciidoc">Spring Native vs Quarkus</h5>
<div class="paragraph">
<p>Nowadays, it is very common to write an application and deploy it to a cloud.
Serverless computing and Function-as-a-Service (FaaS) have become
very popular.
While many challenges arise when deploying a Java application into the latest cloud environment, the biggest challenges facing developers are memory footprint and the startup time required
for the Java application, as more of these keeps the host’s costs high in public clouds and Kubernetes clusters. With the introduction of frameworks like micronaut and microprofile, Java processes are getting faster and more lightweight. In a similar context, Spring has introduced
<a href="https://docs.spring.io/spring-native/docs/current/reference/htmlsingle/#overview">Spring Native</a> which aims to solve the big memory footprint of Spring and its slow startup time to potentially rival the new framework called <a href="https://quarkus.io">Quarkus</a>, by Red Hat. This document briefly discusses both of these two frameworks and their potential suitability with devonfw.</p>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_spring-native-vs-quarkus.asciidoc_quarkus">Quarkus</h6>
<div class="paragraph">
<p>Quarkus is a full-stack, Kubernetes-native Java framework made for JVMs. With its container-first-philosophy and its native compilation with GraalVM, Quarkus optimizes Java for containers with low memory usage and fast startup times.</p>
</div>
<div class="paragraph">
<p>Quarkus achieves this in the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>First Class Support for GraalVM</strong></p>
</li>
<li>
<p><strong>Build Time Metadata Processing:</strong> As much processing as possible is
done at build time, so your application will only contain the classes
that are actually needed at runtime. This results in less memory usage,
and also faster startup time, as all metadata processing has already been
done.</p>
</li>
<li>
<p><strong>Reduction in Reflection Usage:</strong> Quarkus tries to avoid reflection as much as possible in order to reduce startup time and memory usage.</p>
</li>
<li>
<p><strong>Native Image Pre Boot:</strong> When running in a native image, Quarkus
pre-boots as much of the framework as possible during the native image
build process. This means that the resulting native image has already
run most of the startup code and serialized the result into the
executable, resulting in an even faster startup-time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This gives Quarkus the potential for a great platform for serverless cloud and Kubernetes environments. For more information about Quarkus and its support for devonfw please refer to the <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus.asciidoc">Quarkus introduction guide</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_spring-native-vs-quarkus.asciidoc_spring-native">Spring Native</h6>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>The current version of Spring Native 0.10.5 is designed to be used with Spring Boot 2.5.6</strong></p>
</div>
</div>
</div>
<div class="paragraph">
<p>Like Quarkus, Spring Native provides support for compiling Spring applications to native executables using the GraalVM native-image compiler deisgned to be packaged in lightweight containers.</p>
</div>
<div class="paragraph">
<p>Spring Native is composed of the following modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>spring-native:</strong> runtime dependency required for running Spring Native, provides also Native hints API.</p>
</li>
<li>
<p><strong>spring-native-configuration:</strong> configuration hints for Spring classes used by Spring AOT plugins, including various Spring Boot auto-configurations.</p>
</li>
<li>
<p><strong>spring-native-docs:</strong> reference guide, in asciidoc format.</p>
</li>
<li>
<p><strong>spring-native-tools:</strong> tools used for reviewing image building configuration and output.</p>
</li>
<li>
<p><strong>spring-aot:</strong> AOT transformation infrastructure common to Maven and Gradle plugins.</p>
</li>
<li>
<p><strong>spring-aot-test:</strong> Test-specific AOT transformation infrastructure.</p>
</li>
<li>
<p><strong>spring-aot-gradle-plugin:</strong> Gradle plugin that invokes AOT transformations.</p>
</li>
<li>
<p><strong>spring-aot-maven-plugin:</strong> Maven plugin that invokes AOT transformations.</p>
</li>
<li>
<p><strong>samples:</strong> contains various samples that demonstrate features usage and are used as integration tests.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_spring-native-vs-quarkus.asciidoc_native-compilation-with-graalvm">Native compilation with GraalVM</h6>
<div class="paragraph">
<p>Quarkus and Spring Native both use GraalVM for native compilation. Using a native image provides some key advantages, such as instant startup, instant peak performance, and reduced memory consumption. However, there are also some drawbacks: Creating a native image is a heavy process that is slower than a regular application. A native image also has fewer runtime optimizations after its warmup. Furthermore, it is less mature than the JVM and comes with some different behaviors.</p>
</div>
<div class="paragraph">
<p><strong>Key characteristics:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Static analysis of the application from the main entry point is
performed at build time.</p>
</li>
<li>
<p>Unused parts are removed at build time.</p>
</li>
<li>
<p>Configuration required for reflection, resources, and dynamic proxies.</p>
</li>
<li>
<p>Classpath is fixed at build time.</p>
</li>
<li>
<p>No class lazy loading: everything shipped in the executables will be loaded in memory on startup.</p>
</li>
<li>
<p>Some code will run at build time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are <a href="https://github.com/oracle/graal/blob/master/docs/reference-manual/native-image/Limitations.md">limitations</a> around some aspects of Java applications that are not fully supported</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_spring-native-vs-quarkus.asciidoc_build-time-and-start-time-for-apps">Build time and start time for apps</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Framework</th>
<th class="tableblock halign-left valign-top">build time</th>
<th class="tableblock halign-left valign-top">start time</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Native</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">19.615s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.913s</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quarkus Native executable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">52.818s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.802s</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_spring-native-vs-quarkus.asciidoc_memory-footprints">Memory footprints</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Framework</th>
<th class="tableblock halign-left valign-top">memory footprint</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Native</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">109 MB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quarkus Native executable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">75 MB</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_spring-native-vs-quarkus.asciidoc_considering-devonfw-best-practices">Considering devonfw best practices</h6>
<div class="paragraph">
<p>As of now, devonfw actively supports Spring but not Spring Native.
Although Quarkus has been released to a stable release in early 2021, it has been already used in multiple big projects successfully showing its potential to implement cloud native services with low resource consumption matching the needs of scalability and resilience in cloud native environments.
With major stakeholders behind the open source community like Red Hat, its development and growth from its kickoff to the current state is very impressive and really shows the market needs and focus.
Another big advantage of Quarkus is that it started on a green field and therefore did not need to circumvent main pillars of the spring framework like reflection, being able to take clean and up-to-date design decisions not needing to cope with legacy issues.
Nonetheless, there is a experimental support also for some spring libraries already available in Quarkus, which make switching from spring to Quarkus much more easier if needed.
We also provide a <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_getting-started-for-spring-developers.asciidoc">guide
for Spring developers</a> who want to adopt or try Quarkus for their
(next) projects as it really has some gamechanging advantages over
Spring.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_spring-native-vs-quarkus.asciidoc_general-recommendations-and-conclusion">General recommendations and conclusion</h6>
<div class="paragraph">
<p>Quarkus and Spring Native both have their own use cases. Under the consideration of the limitations of GraalVM to be used for native images built by Quarkus and Spring Native, there is a strong recommendation towards Quarkus from devonfw.
One essential differentiation has to be made on the decision for native or against native applications - the foreseen performance optimization of the JIT compiler of the JVM, which is not available anymore in a native image deployment.
For sure, both component frameworks will also run on a JVM getting advantage again from JIT compilation, but depending on the overall landscape then, it is recommended to stay with the knowledge of the available teams, e.g. continue making use of devon4j based on spring or even if already in that state also here make use of Quarkus on JVM.</p>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4j.wiki_guide-structure-modern.asciidoc">Modern project structure</h5>
<div class="paragraph">
<p>With trends such as cloud, microservices, lean, and agile, we decided for a more modern project structure that fits better to recent market trends.
When starting new projects with devonfw, and especially in the context of cloud-native development, we strongly recommend this modern approach over the <a href="#devonfw-guide_devon4j.wiki_guide-structure-classic.asciidoc">classic structure</a>.</p>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-structure-modern.asciidoc_modules">Modules</h6>
<div class="paragraph">
<p>Due to trends such as microservices, we are building smaller apps compared to moduliths.
For simplicity, we therefore do not split our app into different modules and keep everything top-level and easy.</p>
</div>
<div class="paragraph">
<p>In addition to <code>java</code> and <code>resources</code>, we also add <code>helm</code> for helm templates and <code>docker</code> for docker scripts (e.g. <code>Dockerfile</code>) in <code>src/main</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>├──/src
|  ├──/main
|  |  ├──/docker
|  |  ├──/helm
|  |  ├──/java
|  |  └──/resources
|  └──/test
|     ├──/java
|     └──/resources
└──/pom.xml</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-structure-modern.asciidoc_deployment">Deployment</h6>
<div class="paragraph">
<p>For modern projects, we strongly recommend that your build process generates the final deliverable as an OCI compliant container.
Further, to go fully cloud-native, you should build your app as a native image via <a href="https://www.graalvm.org/">GraalVM</a> AOT compiler.
Therefore, we recommed to use <a href="https://quarkus.io/">quarkus</a> as your main framework.
In case you want to go with spring, you may consider using <a href="https://github.com/spring-projects-experimental/spring-native">spring-native</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-structure-modern.asciidoc_layers">Layers</h6>
<div class="paragraph">
<p>The package structure of your code inside <code>src/main/java</code> (and <code>src/test/java</code>) of your app is described in our coding conventions in the sections <a href="#devonfw-guide_devon4j.wiki_coding-conventions.asciidoc_packages">packages</a>.
For the modern project structure, the layers are defined by the following table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Layer</strong></th>
<th class="tableblock halign-left valign-top"><strong>«layer»</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc">service</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>service</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The service layer exposing functionality via its remote API. Typical protocol is <a href="#devonfw-guide_devon4j.wiki_guide-rest.asciidoc">REST</a>. May also be any other protocol you are using such as <a href="https://grpc.io/">gRPC</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-domain-layer.asciidoc">domain</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>domain</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The domain with the data-model and DB access. Use sub-package (in <code>«detail»</code>) <code>repository</code> for <a href="#devonfw-guide_devon4j.wiki_guide-repository.asciidoc">repository</a> and <code>dao</code> for <a href="#devonfw-guide_devon4j.wiki_guide-dao.asciidoc">DAOs</a>. Also we recommend to put <a href="#devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entity">entities</a> in <code>model</code> sub-package.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc">logic</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The logic layer with the functionallity providing the business value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#devonfw-guide_devon4j.wiki_guide-common.asciidoc">common</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>common</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cross-cutting code not assigned to a technical layer.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_guide-structure-modern.asciidoc_architecture-mapping">Architecture Mapping</h6>
<div class="paragraph">
<p>In order to help you to map the architecture, packaging, layering, etc. to the code and see where different code elements should be placed,
we provide this architecture mapping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>«root»
├──.<a href="#devonfw-guide_devon4j.wiki_guide-component.asciidoc_business-component">«component»</a>
|  ├──.<a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-domain-layer.asciidoc">domain</a>
|  |  ├──.<a href="#devonfw-guide_devon4j.wiki_guide-repository.asciidoc">repo</a>
|  |  |  ├──.<a href="#devonfw-guide_devon4j.wiki_guide-repository.asciidoc_repository">«BusinessObject»Repository</a>
|  |  |  ├──.<a href="#devonfw-guide_devon4j.wiki_guide-repository.asciidoc_fragment">«BusinessObject»Fragment</a>
|  |  |  └──.<a href="#devonfw-guide_devon4j.wiki_guide-repository.asciidoc_fragment">«BusinessObject»FragmentImpl</a>
|  |  ├──.<a href="#devonfw-guide_devon4j.wiki_guide-dao.asciidoc">dao</a> [alternative to repo]
|  |  |  ├──.<a href="#devonfw-guide_devon4j.wiki_guide-dao.asciidoc_data-access-object">«BusinessObject»Dao</a>
|  |  |  └──.<a href="#devonfw-guide_devon4j.wiki_guide-dao.asciidoc_data-access-object">«BusinessObject»DaoImpl</a>
|  |  └──.model
|  |     └──.<a href="#devonfw-guide_devon4j.wiki_guide-jpa.asciidoc_entity">«BusinessObject»Entity</a>
|  ├──.<a href="#devonfw-guide_devon4j.wiki_guide-logic-layer.asciidoc">logic</a>
|  |  ├──«BusinessObject»Validator
|  |  └──«BusinessObject»EventsEmitter
|   |  └──.<a href="#devonfw-guide_devon4j.wiki_guide-usecase.asciidoc">Uc«Operation»«BusinessObject»[Impl</a>]
|  └──.<a href="#devonfw-guide_devon4j.wiki_guide-service-layer.asciidoc">rest</a>
|     └──.<a href="#devonfw-guide_devon4j.wiki_guide-service-versioning.asciidoc_jax-rs">v1</a>
|        ├──.<a href="#devonfw-guide_devon4j.wiki_guide-rest.asciidoc_jax-rs">«Component»RestService</a>
|        ├──.mapper
|        |     └──.«BusinessObject»Mapper
|        └──.model
|           └──.«BusinessObject»Dto
└──.<a href="#devonfw-guide_devon4j.wiki_guide-component.asciidoc_general-component">general</a>
   └──.domain
      └──.model
         └──.ApplicationPersistenceEntity</pre>
</div>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4j.wiki_guide-domain-layer.asciidoc">Domain Layer</h5>
<div class="paragraph">
<p>The domain layer is responsible for the data-model and mapping it to a <a href="https://github.com/devonfw/devonfw-guide/blob/master/general/db/guide-database.asciidoc">database</a>.
The most common approach is to use a Relational Database Management System (RDMS). In such a case, we strongly recommend to follow our <a href="#devonfw-guide_devon4j.wiki_guide-jpa.asciidoc">JPA Guide</a>. Some NoSQL databases are supported by <a href="https://spring.io/projects/spring-data">spring-data</a>, so you can consider the <a href="#devonfw-guide_devon4j.wiki_guide-repository.asciidoc">repository guide</a>.</p>
</div>
<div class="paragraph">
<p>Note: The domain layer is the replacement for the <a href="#devonfw-guide_devon4j.wiki_guide-dataaccess-layer.asciidoc">data-access layer</a> in the <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_guide-structure-modern.asciidoc">modern project structure</a>.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4j.wiki_devon4j.asciidoc_guides_2">Guides</h5>
<!-- toc disabled -->
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_getting-started-for-spring-developers.asciidoc">Getting started with Quarkus for Spring developers</h6>
<div class="paragraph">
<p>As a Spring developer, you have heard more and more about Quarkus: its pros and cons, its fast growth etc. So, you decided to adopt/try Quarkus for your (next) project(s) and are wondering where to go next and what you need to pay attention to when moving from Spring to Quarkus.</p>
</div>
<div class="paragraph">
<p>This guide tries to address this exact concern. In the following, we will present you some main points you should be aware of when starting to develop with Quarkus, along with some useful sources.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Quarkus is a fairly new Java toolkit. Thus, it is very well documented. It also provides a set of well-written technical guides that are a good starting point to get in touch and make the first steps with Quarkus. See <a href="https://quarkus.io/get-started/">here</a>. It is an Open Source project licensed under the Apache License version 2.0. The source code is hosted in <a href="https://github.com/quarkusio/quarkus">GitHub</a>. If you have any questions or concerns, don’t hesitate to reach out to the <a href="https://quarkus.io/community/">Quarkus community</a>.</p>
</li>
<li>
<p>Same as <a href="https://start.spring.io/">Spring Initializr</a>, you can go to <a href="https://code.quarkus.io/">code.quarkus.io</a> to create a new application. Also, check out our <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_quarkus-template.asciidoc">Template Quarkus Guide</a> to see our recommendations on certain topics.</p>
</li>
<li>
<p>In Spring stack, we recommend structuring your application into multiple modules, known as our <a href="#devonfw-guide/devon4j.wiki/quarkus_../guide-structure-classic">classic structure</a>. Moving to Quarkus and the world of cloud-native microservices, where we build smaller applications compared to monoliths, we recommend keeping everything top-level and simple. Therefore, we propose the <a href="#devonfw-guide/devon4j.wiki/quarkus_../guide-structure-modern">modern structure</a> as a better fit.</p>
</li>
<li>
<p>Quarkus focuses not only on delivering top features, but also on the developer experience. The <strong>Quarkus’s Live Coding</strong> feature automatically detects changes made to Java files, application configuration, static resources, or even classpath dependency changes and recompiles and redeploys the changes. As that, it solves the problem of traditional Java development workflow, hence improves productivity.</p>
<div class="listingblock">
<div class="content">
<pre>    Write Code → Compile → Deploy → Test Changes/ Refresh Browser/ etc → Repeat (traditional)
    Write Code → Test Changes/ Refresh Browser/ etc → Repeat (Quarkus)</pre>
</div>
</div>
<div class="paragraph">
<p>You can use this feature out of the box without any extra setup by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>    mvn compile quarkus:dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another highlight feature to speed up developing is the Quarkus’s Dev Mode with <strong>Dev Services</strong>, which can automatically provision unconfigured services in development and test mode. This means that if you include an extension and don’t configure it, Quarkus will automatically start the relevant service and wire up your application to use it, therefore saving you a lot of time setting up those services manually. In production mode, where the real configuration is provided, Dev Services will be disabled automatically.</p>
</div>
<div class="paragraph">
<p>Additionally, you can access the <strong>Dev UI</strong> at <code>\q\dev</code> in Dev Mode to browse endpoints offered by various extensions, conceptually similar to what a Spring Boot actuator might provide.</p>
</div>
</li>
<li>
<p>Quarkus is made of a small core on which hundreds of extensions rely. In fact, the power of Quarkus is its extension mechanism. Think of these extensions as your project dependencies. You can add it per dependency manager such as maven or gradle.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mvn quarkus:list-extensions
mvn quarkus:add-extension -Dextensions="groupId:artifactId"
(or add it manually to pom.xml)
# or
gradle list-extensions
(add dependency to build.gradle)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Like Spring Boot, Quarkus also has a vast ecosystem of extensions with commonly-used technologies.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 32. Example of common Quarkus extensions and the Spring Boot Starters with similar functionality (<a href="https://developers.redhat.com/e-books/quarkus-spring-developers">book: Quarkus for Spring Developer</a>)</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Quarkus extension</th>
<th class="tableblock halign-left valign-top">Spring Boot Starter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-resteasy-jackson</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-web</p>
<p class="tableblock">spring-boot-starter-webflux</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-resteasy-reactive-jackson</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-web</p>
<p class="tableblock">spring-boot-starter-webflux</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-hibernate-orm-panache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-data-jpa</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-hibernate-orm-rest-datapanache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-data-rest</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-hibernate-reactive-panache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-data-r2dbc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-mongodb-panache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-data-mongodb</p>
<p class="tableblock">spring-boot-starter-data-mongodb-reactive</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-hibernate-validator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-validation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-qpid-jms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-activemq</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-artemis-jms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-artemis</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-cache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-cache</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-redis-client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-data-redis</p>
<p class="tableblock">spring-boot-starter-data-redis-reactive</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-mailer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-mail</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-quartz</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-quartz</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-oidc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-oauth2-resource-server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-oidc-client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-oauth2-client</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-smallrye-jwt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-security</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A full list of all Quarkus extensions can be found <a href="https://quarkus.pro/extensions/">here</a>. Furthermore, you can check out the community extensions hosted by <a href="https://github.com/quarkiverse/quarkiverse/wiki">Quarkiverse Hub</a>. Quarkus has some extensions for Spring API as well, which is helpful when migrating from Spring to Quarkus.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://quarkus.io/guides/spring-di">Quarkus Extension for Spring Dependency Injection</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-web">Quarkus Extension for Spring Web</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-data-jpa">Quarkus Extension for Spring Data JPA</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-security">Quarkus Extension for Spring Security</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-boot-properties">Quarkus Extension for Spring Boot Properties</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-cache">Quarkus Extension for Spring Cache</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-cloud-config-client">Quarkus Extension for Spring Cloud Config Client</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-data-rest">Quarkus Extension for Spring Data REST</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-scheduled">Quarkus Extension for Spring Scheduled</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Besides extensions, which are officially maintained by Quarkus team, Quarkus allows adding external libraries too. While extensions can be integrated seamlessly into Quarkus, as they can be processed at build time and be built in native mode with GraalVM, external dependencies might not work out of the box with native compilation. If that is the case, you have to recompile them with the right GraalVM configuration to make them work.</p>
</div>
</li>
<li>
<p>Quarkus' design accounted for native compilation by default. A Quarkus native executable starts much faster and utilizes far less memory than a traditional JVM (see our <a href="#devonfw-guide/devon4j.wiki/quarkus_../performance-comparision-spring-quarkus">performace comparision between Spring and Quarkus</a>). To get familiar with building native executable, configuring and running it, please check out our <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_guide-native-image.asciidoc">Native Image Guide</a>. Be sure to test your code in both JVM and native mode.</p>
</li>
<li>
<p>Both Quarkus and Spring include testing frameworks based on <a href="https://junit.org/junit5/">JUnit</a> and <a href="https://site.mockito.org/">Mockito</a>. Thus, by design, Quarkus enables test-driven development by detecting affected tests as changes are made and automatically reruns them in background. As that, it gives developer instant feedback, hence improves productivity. To use continuous testing, execute the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mvn quarkus:dev</code></pre>
</div>
</div>
</li>
<li>
<p>For the sake of performance optimization, Quarkus avoids reflection as much as possible, favoring static class binding instead. When building a native executable, it analyzes the call tree and removes all the classes/methods/fields that are not used directly. As a consequence, the elements used via reflection are not part of the call tree so they are dead code eliminated (if not called directly in other cases).</p>
<div class="paragraph">
<p>A common example is the JSON library, which typically use reflection to serialize the objects to JSON. If you use them out of the box, you might encounter some errors in native mode. So, be sure to register the elements for reflection explicitly. A How-to is provided by <a href="https://quarkus.io/guides/writing-native-applications-tips#registering-for-reflection">Quarkus Registering For Reflection</a> with practical program snippets.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>A very good read on the topic is the e-book <a href="https://developers.redhat.com/e-books/quarkus-spring-developers">Quarkus for Spring Developers</a> by Red Hat. Another good source for direct hands-on coding tutorial is <a href="https://www.katacoda.com/openshift/courses/developing-with-quarkus/spring">Katacoda Quarkus for Spring Boot Developers</a></p>
</div>
<!-- toc disabled -->
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc">Configuration</h6>
<div class="paragraph">
<p><a href="#devonfw-guide_devon4j.wiki_quarkus_quarkus.asciidoc">Quarkus</a> provides a comprehensive guide on configuration <a href="https://quarkus.io/guides/config-reference">here</a>.</p>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc_external-application-configuration">External Application Configuration</h7>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc_database-configuration">Database Configuration</h8>
<div class="paragraph">
<p>In Quarkus, Hibernate is provided by the <code>quarkus-hibernate-orm</code> extension. Ensure the extension is added to your <code>pom.xml</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-hibernate-orm&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, you have to add the respective JDBC driver extension to your <code>pom.xml</code>. There are different drivers for different database types. See <a href="https://quarkus.io/guides/hibernate-orm#setting-up-and-configuring-hibernate-orm">Quarkus Hibernate guide</a>.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc_database-system-and-access">Database System and Access</h8>
<div class="paragraph">
<p>You need to configure which database type you want to use, as well as the location and credentials to access it. The defaults are configured in <code>application.properties</code>. The file should therefore contain the properties as in the given example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">quarkus.datasource.jdbc.url=jdbc:postgresql://database.enterprise.com/app
quarkus.datasource.username=appuser01
quarkus.datasource.password=************
quarkus.datasource.db-kind=postgresql

# drop and create the database at startup (use only for local development)
quarkus.hibernate-orm.database.generation=drop-and-create</code></pre>
</div>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc_database-logging">Database Logging</h8>
<div class="paragraph">
<p>Add the following properties to <code>application.properties</code> to enable logging of database queries for debugging purposes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">quarkus.hibernate-orm.log.sql=true
quarkus.hibernate-orm.log.format-sql=true

#Logs SQL bind parameters. Setting it to true is obviously not recommended in production.
quarkus.hibernate-orm.log.bind-parameters=true</code></pre>
</div>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc_secrets-and-environment-specific-configurations">Secrets and environment specific configurations</h7>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc_environment-variables">Environment variables</h8>
<div class="paragraph">
<p>There are also some libraries to make Jasypt work with Quarkus, such as <a href="https://camel.apache.org/camel-quarkus/latest/reference/extensions/jasypt.html">Camel Quarkus Jasypt</a>. Unfortunately, this feature only works in JVM mode and not in native mode.</p>
</div>
<div class="paragraph">
<p>Quarkus supports many credential providers with official extensions, such as HashiCorp Vault.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-vault&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Quarkus reads configuration values from several locations, ordered by a certain priority. An overview of these can be found at the official  <a href="#devonfw-guide/devon4j.wiki/quarkus_https://quarkus.io/guides/config-extending-support">Quarkus config guide</a>.</p>
</div>
<div class="paragraph">
<p>Environment variables have a higher ordinal number and are therefore higher prioritized than e.g. the <code>application.properties</code> file.
So instead of storing secrets in plain text in the configuration files, it is better to use environment variables for critical values to configure the application.</p>
</div>
<div class="paragraph">
<p>Environment variables also have the advantage that they can be easily integrated into a containerized environment.
When using Kubernetes, the secrets can be stored as <em>Kubernetes secret</em> and then passed to the containers as an environment variable.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc_custom-config-sources">Custom config sources</h8>
<div class="paragraph">
<p>Quarkus provides the possability to add custom config sources, which can be used to retrieve configuration values from custom locations.
For a description of this feature, see the <a href="devonfw-guide/devon4j.wiki/quarkus_https://quarkus.io/guides/config-extending-support.html#custom-config-source">corresponding Quarkus guide</a>.</p>
</div>
<div class="sect8">
<h9 id="devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc_config-interceptors">Config interceptors</h9>
<div class="paragraph">
<p>Quarkus also allows with the concept of interceptors to hook into the resolution of configuration values. This can be useful when configuration values are encrypted or need to be extracted.
To do this, you have to implement a <code>ConfigSourceInterceptor</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-Java" data-lang="Java">public class CustomConfigInterceptor implements ConfigSourceInterceptor {

  @Override
  public ConfigValue getValue(ConfigSourceInterceptorContext context, String name) {

    ConfigValue configValue = context.proceed(name);
    if (name.equals("config-value-to-resolve")) {
      configValue = new ConfigValue.ConfigValueBuilder()
          .withName(name)
          .withValue(resolveConfigurationValue(name))
          .build();
    }

    return configValue;
  }

  private String resolveConfigurationValue(String name) {
    ...
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use the Interceptor, you must register it. To do this, create a file  <code>io.smallrye.config.ConfigSourceInterceptor</code> in the folder <code>src/main/resources/META-INF/services</code> and register the interceptor register the interceptor by writing the fully qualified class name to this file.</p>
</div>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc_credential-encryption">Credential encryption</h8>
<div class="paragraph">
<p>As for <a href="#devonfw-guide/devon4j.wiki/quarkus_../spring/guide-spring-configuration.asciidoc_security">Spring</a>, there are also some libraries that let Jasypt work with Quarkus such as <a href="https://camel.apache.org/camel-quarkus/latest/reference/extensions/jasypt.html">Camel Quarkus Jasypt</a>. Unfortunately, this feature only works in JVM mode and not in native mode, so it is not a suitable approach.</p>
</div>
<div class="paragraph">
<p>If you want to store usernames or passwords in encrypted form or retrieve them from a custom store, you can use a custom <code>CredentialsProvider</code> for this purpose.
Consider the use case where you want to store your database credentials in encrypted form rather than in plain text. Then you can implement a credentials provider as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-Java" data-lang="Java">@ApplicationScoped
@Unremovable
public class DatabaseCredentialsProvider implements CredentialsProvider {

  @Override
  public Map&lt;String, String&gt; getCredentials(String credentialsProviderName) {

    Map&lt;String, String&gt; properties = new HashMap&lt;&gt;();
    properties.put(USER_PROPERTY_NAME, decryptUsername());
    properties.put(PASSWORD_PROPERTY_NAME, decryptPassword());
    return properties;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the <code>application.properties</code> file you need to set <code>quarkus.datasource.credentials-provider=custom</code>.
For more information about the credentials provider, see the official <a href="#devonfw-guide/devon4j.wiki/quarkus_https://quarkus.io/guides/credentials-provider">Quarkus guide</a>.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_quarkus_guide-quarkus-configuration.asciidoc_hashicorp-vault">HashiCorp Vault</h8>
<div class="paragraph">
<p>For centralized management of secrets and other critical configuration values, you can use <a href="#devonfw-guide/devon4j.wiki/quarkus_https://www.vaultproject.io/">HashiCorp Vault</a> as external management tool.</p>
</div>
<div class="paragraph">
<p>For detailed instructions on how to integrate Vault into your Quarkus application, see the official <a href="#devonfw-guide/devon4j.wiki/quarkus_https://quarkus.io/guides/vault">Quarkus guide</a>.</p>
</div>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_quarkus-template.asciidoc">Quarkus template</h6>
<div class="paragraph">
<p><a href="https://code.quarkus.io/?g=org.devonfw&amp;e=resteasy&amp;e=resteasy-jackson&amp;e=hibernate-validator&amp;e=hibernate-orm&amp;e=micrometer">Quarkus Code Generator</a> is provides many alternative technologies and libraries that can be integrated into a project. Detailed guides on multiple topics can be found <a href="https://quarkus.io/guides/">here</a>.</p>
</div>
<div class="paragraph">
<p>Due to the large selection, getting started can be difficult for developers.
In this guide we aim to provide a general suggestion on basic frameworks, libraries, and technologies to make it easy for developers to begin with.</p>
</div>
<div class="paragraph">
<p>With that said, please take this as a recommendation and not as a compulsion. Depending on your project requirements, you might have to use another stack compared to what is listed below.</p>
</div>
<div class="paragraph">
<p>If you are new to Quarkus, consider checking out their <a href="https://quarkus.io/guides/getting-started">getting started guide</a> to get an overview of how to create, run, test, as well as package a Quarkus application. Another recommended source to get started is <a href="https://www.katacoda.com/openshift/courses/developing-with-quarkus/getting-started">the Katacoda tutorials</a>.</p>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_quarkus_quarkus-template.asciidoc_basic-templates">Basic templates</h8>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>simple REST API (<a href="https://code.quarkus.io/?g=com.devonfw&amp;e=resteasy&amp;e=resteasy-jackson&amp;e=hibernate-validator&amp;e=hibernate-orm">go to code.quarkus.io</a>)</p>
</li>
<li>
<p>simple REST API with monitoring (<a href="https://code.quarkus.io/?g=com.devonfw&amp;e=resteasy&amp;e=resteasy-jackson&amp;e=hibernate-validator&amp;e=hibernate-orm&amp;e=micrometer&amp;e=smallrye-health">go to code.quarkus.io</a>)</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 33. Topic-based suggested implementation</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 42.8572%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Topic</th>
<th class="tableblock halign-left valign-top">Detail</th>
<th class="tableblock halign-left valign-top">Suggested implementation</th>
<th class="tableblock halign-left valign-top">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">runtime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">servlet-container</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undertow</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">component management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dependency injection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ArC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ArC is based on JSR 365. It also provides interceptors that can be used to implement the same functionality as AOP provides</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configuration</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/config">SmallRye Config</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SmallRye Config is an implementation of Eclipse MicroProfile Config. It also supports YAML configuration files</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">persistence</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OR-mapper</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/hibernate-orm">Hibernate ORM</a>, <a href="https://quarkus.io/guides/spring-data-jpa">Spring Data JPA</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hibernate ORM is the de facto standard JPA implementation and works perfectly in Quarkus. Quarkus also provides a compatibility layer for Spring Data JPA repositories in the form of the <code>spring-data-jpa</code> extension.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">batch</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quarkus JBeret Extension is a non-official extension, which is hosted in the <a href="https://github.com/quarkiverse/">Quarkiverse Hub</a>. It is an implementation of JSR 352.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST services</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/rest-json">RESTEasy</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTEasy is an portable implementation of the new JCP specification JAX-RS JSR-311. It can be documented via Swagger OpenAPI.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">async messaging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/kafka">SmallRye Reactive Messaging</a>, Vert.x EventBus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SmallRye Reactive Messaging is an implementation of the Eclipse MicroProfile Reactive Messaging specification 1.0. You can also utilize SmallRye Reactive Messaging in your Quarkus application to interact with Apache Kafka.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">marshalling</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTEasy Jackson, RESTEasy JSON-B, RESTEasy JAXB, RESTEasy Multipart</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">cloud</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kubernetes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deployment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minikube, k3d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minikube is quite popular when a Kubernetes cluster is needed for development purposes. Quarkus supports this with the <code>quarkus-minikube</code> extension.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">logging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/logging">JBoss Log Manager and the JBoss Logging facade</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internally, Quarkus uses JBoss Log Manager and the JBoss Logging facade. Logs from other supported Logging API (JBoss Logging, SLF4J, Apache Commons Logging) will be merged.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">validation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/validation">Hibernate Validator</a>/Bean Validation (JSR 380)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">security</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">authentication &amp; authorization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JWT authentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quarkus supports <a href="https://quarkus.io/guides/security">various security mechanisms</a>. Depending on your protocol, identity provider you can choose the necessary extensions such as <code>quarkus-oidc</code> <code>quarkus-smallrye-jwt</code> <code>quarkus-elytron-security-oauth2</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">monitoring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/micrometer">Micrometer Metrics</a>, <a href="https://quarkus.io/guides/smallrye-metrics">SmallRye Metrics</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SmallRye Metrics is an implementation of the MicroProfile Metrics specification. Quarkus also offers various extensions to customize the metrics.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">health</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/smallrye-health">SmallRye Health</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SmallRye Health is an implementation of the MicroProfile Health specification.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fault tolerance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/smallrye-fault-tolerance">SmallRye Fault Tolerance</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SmallRye Fault Tolerance is an implementation of the MicroProfile Fault Tolerance specification.</p></td>
</tr>
</tbody>
</table>
<!-- toc disabled -->
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_guide-native-image.asciidoc">Building a native image</h6>
<div class="paragraph">
<p>Quarkus provides the ability to create a native executable of the application called <em><a href="https://quarkus.io/guides/building-native-image">native image</a></em>.
Unlike other Java based deployments, a native image will only run on the architecture and operating system it is compiled for.
Also, no JVM is needed to run the native-image.
This improves the startup time, performance, and efficiency.
A distribution of <a href="https://www.graalvm.org/">GraalVM</a> is needed.
You can find the differences between the available distributions <a href="https://quarkus.io/guides/building-native-image#graalvm">here</a>.</p>
</div>
<div class="paragraph">
<p>To build your quarkus app as a native-image, you have two options that are described in the following sections.</p>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_quarkus_guide-native-image.asciidoc_build-a-native-executable-with-graalvm">Build a native executable with GraalVM</h7>
<div class="paragraph">
<p>To build a Quarkus application, you can install GraalVM locally on your machine, as described below.
Therefore, read the <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_quarkus-template.asciidoc_basic-templates">basic Quarkus application chapter</a>, or clone the <a href="https://github.com/devonfw-sample/devon4quarkus-reference">example project</a> provided by devonfw.
Follow this <a href="https://quarkus.io/guides/building-native-image#producing-a-native-executable">chapter</a> from the Quarkus Guide for building a native executable.</p>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_quarkus_guide-native-image.asciidoc_installing-graalvm">Installing GraalVM</h8>
<div class="paragraph">
<p>A native image can be created locally or through a container environment.
To create a native image locally, an installed and configured version of GraalVM is needed. You can follow the <a href="https://quarkus.io/guides/building-native-image#prerequisites-for-oracle-graalvm-ceee">installation guide from Quarkus</a> or the <a href="https://www.graalvm.org/docs/getting-started/#install-graalvm">guide provided by GraalVM</a> for this.</p>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_quarkus_guide-native-image.asciidoc_build-a-native-executable-with-graalvm-through-container-environment">Build a native executable with GraalVM through container environment</h7>
<div class="paragraph">
<p>In order to make the build of native images more portable, you can also use your container environment and run the GraalVM inside a container (typically Docker).
You can simply install Docker with your devonfw-ide distribution, just follow this description <a href="#devonfw-guide/devon4j.wiki/quarkus_https://github.com/devonfw/ide/blob/master/documentation/docker">Docker with devonfw-ide</a>.
Follow this <a href="https://quarkus.io/guides/building-native-image#container-runtime">chapter</a> to build a native Linux image through container runtime.</p>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_quarkus_guide-native-image.asciidoc_configuring-the-native-executable">Configuring the native executable</h7>
<div class="paragraph">
<p>A list of all configuration properties for a native image can be found <a href="https://quarkus.io/guides/building-native-image#configuration-reference">here</a>.</p>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4j.wiki_quarkus_guide-beanmapping-quarkus.asciidoc">Bean mapping with Quarkus</h6>
<div class="paragraph">
<p>This guide will show bean-mapping, in particular for a Quarkus application. We recommend using <a href="https://mapstruct.org/">MapStruct</a> with a Quarkus application because the other bean-mapper frameworks use Java reflections. They are not supported in GraalVm right now and cause problems when building native applications. MapStruct is a code generator that greatly simplifies the implementation of mappings between Java bean types based on a convention over configuration approach. The mapping code will be generated at compile-time and uses plain method invocations and is thus fast, type-safe, and easy to understand. MapStruct has to be configured to not use Java reflections, which will be shown in this guide.</p>
</div>
<div class="paragraph">
<p>You can find the official
<a href="https://mapstruct.org/documentation/stable/reference/pdf/mapstruct-reference-guide.pdf">MapStruct reference guide</a> and a general introduction to MapStruct from <a href="https://www.baeldung.com/mapstruct">Baeldung</a>.</p>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_quarkus_guide-beanmapping-quarkus.asciidoc_mapstruct-dependency">MapStruct Dependency</h7>
<div class="paragraph">
<p>To get access to MapStruct, we have to add the dependency to our POM.xml:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.mapstruct&lt;/groupId&gt;
  &lt;artifactId&gt;mapstruct&lt;/artifactId&gt;
  &lt;version&gt;1.4.2.Final&lt;/version&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>MapStruct provides an annotation processor that also has to be added to the POM.xml</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
	&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
	&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
	&lt;version&gt;3.8.1&lt;/version&gt;
	&lt;configuration&gt;
		&lt;source&gt;1.8&lt;/source&gt;
		&lt;target&gt;1.8&lt;/target&gt;
		&lt;annotationProcessorPaths&gt;
			&lt;path&gt;
				&lt;groupId&gt;org.mapstruct&lt;/groupId&gt;
				&lt;artifactId&gt;mapstruct-processor&lt;/artifactId&gt;
				&lt;version&gt;1.4.2.Final&lt;/version&gt;
			&lt;/path&gt;
		&lt;/path&gt;
		&lt;/annotationProcessorPaths&gt;
	&lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>MapStruct takes advantage of generated getters, setters, and constructors from the <a href="https://projectlombok.org/">Lombok</a> library, follow this <a href="#devonfw-guide/devon4j.wiki/quarkus_../guide-lombok.asciidoc.asciidoc_lombok-with-mapstruct">Lombok with Mapstruct guide</a> to get Lombok with Mapstruct working.</p>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_quarkus_guide-beanmapping-quarkus.asciidoc_mapstruct-configuration">MapStruct Configuration</h7>
<div class="paragraph">
<p>We already discussed the benefits of <a href="https://github.com/devonfw/devon4j/blob/master/documentation/guide-dependency-injection.asciidoc#dependency-injection">dependency injection</a>. MapStruct supports CDI with EJB, spring, and jsr330. The default retrieving method for a mapper is a factory that uses reflections, which should be avoided. The component model should be set to CDI, as this will allow us to easily inject the generated mapper implementation. The component model can be configured in multiple ways.</p>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_quarkus_guide-beanmapping-quarkus.asciidoc_simple-configuration">Simple Configuration</h8>
<div class="paragraph">
<p>Add the attribute <strong>componentModel</strong> to the <strong>@Mapper</strong> annotation in the mapper interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Mapper(compnentModel = "cdi")
public interface ProductMapper{
  ...
}</code></pre>
</div>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_quarkus_guide-beanmapping-quarkus.asciidoc_mapperconfig-configuration">MapperConfig Configuration</h8>
<div class="paragraph">
<p>Create a shared configuration that can be used for multiple mappers. Implement an interface and use the annotation <strong>@MapperConfig</strong> for the class. You can define all configurations in this interface and pass the generated <code>MapperConfig.class</code> with the <strong>config</strong> attribute to the mapper. The <code>MapperConfig</code> also defines the <strong>InjectionStrategy</strong> and <strong>MappingInheritaceStrategy</strong>, both of which will be explained later.
A list of all configurations can be found <a href="https://mapstruct.org/documentation/stable/api/org/mapstruct/MapperConfig.html">here</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@MapperConfig(
  compnentModel = "cdi",
  mappingInheritanceStrategy = MappingInheritanceStrategy.AUTO_INHERIT_FROM_CONFIG
  injectionStrategy =InjectionStrategy.CONSTRUCTOR
)
public interface MapperConfig{
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Mapper( config = MapperConfig.class )
public interface ProductMapper{
  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any attributes not given via <strong>@Mapper</strong> will be inherited from the shared configuration <code>MapperConfig.class</code>.</p>
</div>
</div>
<div class="sect7">
<h8 id="devonfw-guide_devon4j.wiki_quarkus_guide-beanmapping-quarkus.asciidoc_configuration-via-annotation-processor-options">Configuration via annotation processor options</h8>
<div class="paragraph">
<p>The MapStruct code generator can be configured using annotation processor options.
You can pass the options to the compiler while invoking javac directly, or add the parameters to the maven configuration in the POM.xml</p>
</div>
<div class="paragraph">
<p>We also use the constructor injection strategy to avoid field injections and potential reflections. This will also simplify our tests.</p>
</div>
<div class="paragraph">
<p>The option to pass the parameter to the annotation processor in the POM.xml is used and can be inspected in our <a href="https://github.com/devonfw-sample/devon4quarkus-reference/blob/master/pom.xml#L220-L228">quarkus reference project</a>.</p>
</div>
<div class="paragraph">
<p>A list of all annotation processor options can be found <a href="https://mapstruct.org/documentation/dev/reference/html/#configuration-options">here</a>.</p>
</div>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_quarkus_guide-beanmapping-quarkus.asciidoc_basic-bean-mapper-usage">Basic Bean-Mapper Usage</h7>
<div class="paragraph">
<p>To use the mapper, we have to implement the mapper interface and the function prototypes with a <strong>@Mapper</strong> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Mapper
public interface ProductMapper {

  ProductDto map(ProductEntity model);

  ProductEntity create(NewProductDto dto);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The MapStruct annotation processor will generate the implementation for us under <code>/target/generated-sources/</code>, we just need to tell it that we would like to have a method that accepts a <code>ProductEntity</code> entity and returns a new <code>ProductDto</code> DTO.</p>
</div>
<div class="paragraph">
<p>The generated mapper implementation will be marked with the <strong>@ApplicationScoped</strong> annotation and can thus be injected into fields, constructor arguments, etc. using the <strong>@Inject</strong> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class ProductRestService{

  @Inject
  ProductMapper mapper;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>That is the basic usage of a Mapstruct mapper. In the next chapter, we’ll go into a bit more detail and show some more configurations.</p>
</div>
</div>
<div class="sect6">
<h7 id="devonfw-guide_devon4j.wiki_quarkus_guide-beanmapping-quarkus.asciidoc_advanced-bean-mapper-usage">Advanced Bean-Mapper Usage</h7>
<div class="paragraph">
<p>Let´s assume that our <code>Product</code> entity and the <code>ProductDto</code> have some differently named properties that should be mapped. Add a mapping annotation to map the property <strong>type</strong> from <code>Product</code> to <strong>kind</strong> from <code>ProductDto</code>. We define the source name of the property and the target name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Mapper
public interface ProductMapper {
  @Mapping(target = "kind", source = "type")
  ProductDto map(ProductEntity entity);

  @InheritInverseConfiguration(name = "map" )
  ProductEntity create(ProductDto dto);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For bi-directional mappings, we can indicate that a method shall inherit the inverse configuration of the corresponding method with the <strong>@InheritInverseConfiguration</strong>. You can omit the name parameter if the result type of method A is the same as the
single-source type of method B and if the single-source type of A is the same as the result type of B. If multiple apply, the attribute name is needed. Specific mappings from the inverse method can (optionally) be overridden, ignored, or set to constants or expressions.</p>
</div>
<div class="paragraph">
<p>The mappingInheritanceStrategy can be defined as showed in <a href="devonfw-guide_ide.wiki_LICENSE.asciidoc.html#devonfw-guide_devon4j.wiki_quarkus_guide-beanmapping-quarkus.asciidoc_mapstruct-configuration">MapStruct Configuration</a>. The existing options can be found <a href="https://mapstruct.org/documentation/dev/reference/html/#shared-configurations">here</a>.</p>
</div>
<div class="paragraph">
<p>A mapped attribute does not always have the same type in the source and target objects. For instance, an attribute may be of type <code>int</code> in the source bean but of type <code>Long</code> in the target bean.</p>
</div>
<div class="paragraph">
<p>Another example are references to other objects which should be mapped to the corresponding types in the target model. E.g. the class <code>ShoppingCart</code> might have a property <strong>content</strong> of the type <code>Product</code> which needs to be converted into a <code>ProductDto</code> object when mapping a <code>ShoppingCart</code> object to <code>ShoppingCartDto</code>. For these cases, it’s useful to understand how Mapstruct <a href="https://mapstruct.org/documentation/dev/reference/html/#datatype-conversions">converts the data types</a> and the <a href="https://mapstruct.org/documentation/dev/reference/html/#mapping-object-references">object references</a>.</p>
</div>
<div class="paragraph">
<p>Also, the Chapter for <a href="https://mapstruct.org/documentation/dev/reference/html/#controlling-nested-bean-mappings">nested bean mappings</a> will help to configure MapStruct to map arbitrarily deep object graphs.</p>
</div>
<div class="paragraph">
<p>You can study running MapStruct implementation examples given by <a href="https://github.com/mapstruct/mapstruct-examples">MapStruct</a> or in our <a href="https://github.com/devonfw-sample/devon4quarkus-reference">Quarkus reference project</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>←&nbsp;Previous:&nbsp;<a href="devonfw-guide_ide.wiki_migration-from-devonfw-3.0.0-or-lower.asciidoc.html">Migration from oasp4j-ide</a>&nbsp;| ↑&nbsp;Up:&nbsp;<a href="devonfw-guide_ide.wiki_devonfw-ide-support.asciidoc.html">Support</a>&nbsp;| ⌂&nbsp;Home:&nbsp;<a href="master.html">devonfw guide</a>&nbsp;| Next:&nbsp;<a href="devonfw-guide_devon4ng.wiki_master-devon4ng.asciidoc.html">Angular</a>&nbsp;→</p>
</div>
</div>
<div id="footer" class="footer">
<div class="openblock footerLinks">
<div class="content">
<div class="dlist linklist">
<dl>
<dt class="hdlist1">About</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/devonfw-guide_getting-started.wiki_getting-started.asciidoc_introduction.html">About devonfw</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_getting-started.wiki_introduction-why-should-i-use-devonfw.asciidoc.html">Features</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_getting-started.wiki_getting-started.asciidoc_further-information.html">Technology Stack</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Explore</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/devonfw-guide_getting-started.wiki_getting-started.asciidoc.html">Getting started</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_devon4j.wiki_architecture.asciidoc.html">Architecture</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Docs</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/devonfw-guide_ide.wiki_devonfw-ide-introduction.asciidoc.html">User guide</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_general_master-release-notes.asciidoc.html">Releases information</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master.html">Wiki</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Community</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/orgs/devonfw/people">Contributors</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw.github.io/blob/develop/README.asciidoc">Website Contribution</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="ulist footerFooter">
<ul>
<li>
<p><a href="https://devonfw.com/website/pages/docs/devonfw-guide_ide.wiki_LICENSE.asciidoc.html">Terms of Use</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw">Support</a></p>
</li>
</ul>
</div>
</div>
    <script>
      let bb = document.getElementById('menu-button');
      bb.addEventListener('click', function() {
        document.querySelector('.website-navbar ul').classList.toggle('visible');
        console.log(document.querySelector('.website-navbar ul'))
      })
    </script>
    <script type="module">
      import { EditLinksModule } from '/website/shared/editlinks.js';

      let alwaysVisible = true;
      if(document.location.pathname.endsWith("pages/welcome/welcome.html")) {
        alwaysVisible = false;
      }
      EditLinksModule.addEditLinks(alwaysVisible);
    </script>
    <script src="/website/assets/scripts/popper.min.js"></script>
    <script src="/website/assets/scripts/bootstrap.min.js"></script>
<div class="footnote"><sub>

Last updated 2022-03-30 01:20:51 UTC
</sub></div>


<link rel="stylesheet" type="text/css" href="https://cginternal.devonfw.com/websitesnippets/main.css">
<script async="" src="https://cginternal.devonfw.com/websitesnippets/main.js"></script>
<script>
  if(!document.location.pathname.endsWith("pages/welcome/welcome.html")) {
    anchors.options.visible = 'always';
  }
  anchors.add();
</script>
<script>
  var internalUrls = ["https://cginternal.devonfw.com/websitesnippets/"];
  $(".internal").each(function(){
    internalUrls.forEach((internalUrl, index) => {
      $.ajax({url: internalUrl + $(this).text() + "/index.html" })
      .then(r => {
        var leftDiv = $('<div class="info"><span class="infoText">Internal</span><img class="infoImage" src="' + internalUrl + 'logo.png"/></div>');
        var rightFirstDiv = $('<div class="message">This is only visible inside of the corporate network.</div>');
        var rightLastDiv = $('<div class="content"></div>');
        rightLastDiv.html(r);
        var rightDiv = $('<div class="right"></div>');
        rightDiv.append(rightFirstDiv);
        rightDiv.append(rightLastDiv);
        $(this).html(leftDiv);
        $(this).append(rightDiv);
        $(this).addClass("internal-active");
        $(this).removeClass("internal");
      })
    });
	});
</script>
<script>
      let cookieName = 'cookie_consent';
      let expiryTime = new Date(2037, 11, 21);
      let today = new Date();
      let cookieConsentDeclinedDate = localStorage.getItem("cookie_consent_declined");
      let dateDiffHours = 0;
      let cookieConsentHtml = `
      <div id="cookie-consent">
        <p>
          We use cookies to perform analytics and enhance user experience. Do you accept to the use of cookies?
        </p>
        <p class="cookie-consent-buttons">
          <a id="decline-cookie-btn" class="btn white-button" href="javascript:void(0)">Decline</a>
          <a id="accept-cookie-btn" class="btn blue-button" href="javascript:void(0)">Accept</a>
        </p>
      </div>
      `;
      dateDiffHours = cookieConsentDeclinedDate ? Math.abs(cookieConsentDeclinedDate - today) / 36e5 : 0;
      if (document.cookie.indexOf(cookieName) < 0) {
        if (cookieConsentDeclinedDate) {
          if (dateDiffHours > 24) {
            $("body").append(cookieConsentHtml);
          }
        } else {
          $("body").append(cookieConsentHtml);
        }
      }
      $("#accept-cookie-btn").click(function() {
        document.cookie = `${cookieName}=accept;expires=${expiryTime};path=/`;
        localStorage.removeItem("cookie_consent_declined");
        consentGranted();
        $("#cookie-consent").hide();
      });
      $("#decline-cookie-btn").click(function() {
        localStorage.setItem("cookie_consent_declined", today);
        $("#cookie-consent").hide();
      });
</script>

</body></html>